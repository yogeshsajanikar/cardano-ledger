<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Orphan Arbitrary instance for OrderInfo</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Tests</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Group</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">intercalate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">isPrefixOf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">subtract</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Ast</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Classes.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Classes</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Combinators.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Combinators</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Env</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Monad.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Monad</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Rewrite.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Rewrite</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Size.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Size.html#OrdCond"><span class="hs-identifier">OrdCond</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Size.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Size.html#SzRng"><span class="hs-identifier">SzRng</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Size.html#runOrdCond"><span class="hs-identifier">runOrdCond</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Solver.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Solver</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.TypeRep</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Standard"><span class="hs-identifier">Standard</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getSize</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">total</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">{-

One property that we'd like to test is the soundness property for the constraint solver: if it
successfully generates a solution to a set of constraints, this solution *actually* satisfies the
constraints.

In order to test this we need to generate random satisfiable constraints. The approach we take is to
generate constraints in a given fixed environment, and take care to only generate ones that hold in
this particular environment.

To ensure we generate constraints that have a linear dependency graph we keep track of which
variables in the environment are solved by an already generated constraint and the &quot;depth&quot; at which
it was solved. When generating constraints between solved variables we require the depth to respect
the dependency order. For instance, a constraints S &#8838; T (assuming we solve supersets before subsets)
must have `depthOf T &lt; depthOf S`.

This doesn't always work, because the solver substitutes equalities in a way that does not respect
our dependencies (`Rewrite.removeEqual`)

The soundness property discards cases where we fail to find a solution to the constraints, but it's
still interesting to know when this happens, since we try our best to generate solvable constraints.
There is a strict version of the property (`prop_soundness' True`) that fails instead. Currently it
fails in these cases:
  - When the existence of a solution to a later variable depends on the value picked for an earlier
    variable. For instance, [Sized 3 A, B &#8838; A, C &#8838; B, Sized 1 C]. Here B needs to be solved with a
    non-empty set for C to have a solution.

Current limitations of the tests
  - Only CoinR and SetR CoinR types (and Word64R for size constraints)
  - Only generates Sized, Subset, Disjoint, and SumsTo(SumSet) constraints

Known limitations of the code that the tests avoid
  - Can't solve `Sized n (Rng X)` (see TODO/sizedRng)
  - Random X, N &lt; &#931; sum X can pick X = {} (N :: Coin) and then crash on the sum constraint
    (TODO/negativeCoin)

-}</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- Generators ---</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="GenEnv"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-var">GenEnv</span></a></span></span><span> </span><span id="local-6989586621680167699"><span class="annot"><a href="#local-6989586621680167699"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenEnv"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-var">GenEnv</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gOrder"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gOrder"><span class="hs-identifier hs-var hs-var">gOrder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#OrderInfo"><span class="hs-identifier hs-type">OrderInfo</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gEnv"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var hs-var">gEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167699"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gSolved"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Map (Name era) Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gSolved"><span class="hs-identifier hs-var hs-var">gSolved</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167699"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- ^ Which variables in the environment have we &quot;solved&quot;, i.e. generated</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">--   a constraint that allows solving them. Also track the &quot;depth&quot; of</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">--   the variable in the dependency order (depth = 1 + depth of</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">--   dependencies).</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680167147"><span id="local-6989586621680167149"><span id="local-6989586621680167158"><span class="annot"><span class="annottext">Depth -&gt; GenEnv era -&gt; ShowS
forall era. Depth -&gt; GenEnv era -&gt; ShowS
forall era. [GenEnv era] -&gt; ShowS
forall era. GenEnv era -&gt; String
forall a.
(Depth -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GenEnv era] -&gt; ShowS
$cshowList :: forall era. [GenEnv era] -&gt; ShowS
show :: GenEnv era -&gt; String
$cshow :: forall era. GenEnv era -&gt; String
showsPrec :: Depth -&gt; GenEnv era -&gt; ShowS
$cshowsPrec :: forall era. Depth -&gt; GenEnv era -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span id="Depth"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-var">Depth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#OrderInfo"><span class="hs-identifier hs-type">OrderInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621680167133"><span class="annot"><span class="annottext">arbitrary :: Gen OrderInfo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool -&gt; OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#OrderInfo"><span class="hs-identifier hs-var">OrderInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621680167127"><span class="annot"><span class="annottext">shrink :: OrderInfo -&gt; [OrderInfo]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">shrink</span></span></span><span> </span><span id="local-6989586621680167125"><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680167125"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#standardOrderInfo"><span class="hs-identifier hs-var">standardOrderInfo</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680167125"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#standardOrderInfo"><span class="hs-identifier hs-var">standardOrderInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621680167679"><span id="local-6989586621680167680"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#addVar"><span class="hs-identifier hs-type">addVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167680"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167679"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167679"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167680"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167680"><span class="hs-identifier hs-type">era</span></a></span></span></span><span>
</span><span id="line-106"></span><span id="addVar"><span class="annot"><span class="annottext">addVar :: forall era t. V era t -&gt; t -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#addVar"><span class="hs-identifier hs-var hs-var">addVar</span></a></span></span><span> </span><span id="local-6989586621680167121"><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680167121"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680167120"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680167120"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680167119"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167119"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167119"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gEnv :: Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; t -&gt; Env era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#storeVar"><span class="hs-identifier hs-var">storeVar</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680167121"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680167120"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167119"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621680167670"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-type">markSolved</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167670"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167670"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167670"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-109"></span><span id="markSolved"><span class="annot"><span class="annottext">markSolved :: forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var hs-var">markSolved</span></a></span></span><span> </span><span id="local-6989586621680167114"><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680167114"><span class="hs-identifier hs-var">solved</span></a></span></span><span> </span><span id="local-6989586621680167113"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680167113"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680167112"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167112"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167112"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gSolved :: Map (Name era) Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gSolved"><span class="hs-identifier hs-var">gSolved</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name era) Depth
</span><a href="#local-6989586621680167109"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Map (Name era) Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gSolved"><span class="hs-identifier hs-var">gSolved</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167112"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621680167109"><span class="annot"><span class="annottext">new :: Map (Name era) Depth
</span><a href="#local-6989586621680167109"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680167113"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680167114"><span class="hs-identifier hs-var">solved</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621680167660"><span id="local-6989586621680167661"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#addSolvedVar"><span class="hs-identifier hs-type">addSolvedVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167661"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167661"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167661"><span class="hs-identifier hs-type">era</span></a></span></span></span><span>
</span><span id="line-114"></span><span id="addSolvedVar"><span class="annot"><span class="annottext">addSolvedVar :: forall era t. V era t -&gt; t -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#addSolvedVar"><span class="hs-identifier hs-var hs-var">addSolvedVar</span></a></span></span><span> </span><span id="local-6989586621680167105"><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680167105"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680167104"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680167104"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680167103"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680167103"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Name era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680167105"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680167103"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; t -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#addVar"><span class="hs-identifier hs-var">addVar</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680167105"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680167104"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621680167651"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfName"><span class="hs-identifier hs-type">depthOfName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167651"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167651"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span></span><span>
</span><span id="line-117"></span><span id="depthOfName"><span class="annot"><span class="annottext">depthOfName :: forall era. GenEnv era -&gt; Name era -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfName"><span class="hs-identifier hs-var hs-var">depthOfName</span></a></span></span><span> </span><span id="local-6989586621680167096"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167096"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680167095"><span class="annot"><span class="annottext">Name era
</span><a href="#local-6989586621680167095"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">Map.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Name era
</span><a href="#local-6989586621680167095"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Map (Name era) Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gSolved"><span class="hs-identifier hs-var">gSolved</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167096"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621680167646"><span id="local-6989586621680167647"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-type">depthOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167647"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167647"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167646"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span></span></span><span>
</span><span id="line-120"></span><span id="depthOf"><span class="annot"><span class="annottext">depthOf :: forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var hs-var">depthOf</span></a></span></span><span> </span><span id="local-6989586621680167089"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167089"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680167088"><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680167088"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Name era -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfName"><span class="hs-identifier hs-var">depthOfName</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167089"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680167088"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621680167633"><span id="local-6989586621680167634"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfSum"><span class="hs-identifier hs-type">depthOfSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167634"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167634"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167633"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span></span></span><span>
</span><span id="line-123"></span><span id="depthOfSum"><span class="annot"><span class="annottext">depthOfSum :: forall era c. GenEnv era -&gt; Sum era c -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfSum"><span class="hs-identifier hs-var hs-var">depthOfSum</span></a></span></span><span> </span><span id="local-6989586621680167083"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167083"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumMap"><span class="hs-identifier hs-type">SumMap</span></a></span><span> </span><span id="local-6989586621680167080"><span class="annot"><span class="annottext">Term era (Map a c)
</span><a href="#local-6989586621680167080"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167083"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map a c)
</span><a href="#local-6989586621680167080"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumList"><span class="hs-identifier hs-type">SumList</span></a></span><span> </span><span id="local-6989586621680167077"><span class="annot"><span class="annottext">Term era [c]
</span><a href="#local-6989586621680167077"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167083"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term era [c]
</span><a href="#local-6989586621680167077"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621680167075"><span class="annot"><span class="annottext">Term era c
</span><a href="#local-6989586621680167075"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167083"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term era c
</span><a href="#local-6989586621680167075"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era c
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680167072"><span class="annot"><span class="annottext">Term era (Map a x)
</span><a href="#local-6989586621680167072"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167083"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map a x)
</span><a href="#local-6989586621680167072"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genLiteral"><span class="hs-identifier hs-type">genLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167623"><span class="annot"><a href="#local-6989586621680167623"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621680167622"><span class="annot"><a href="#local-6989586621680167622"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167623"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167623"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167623"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167622"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621680167622"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-130"></span><span id="genLiteral"><span class="annot"><span class="annottext">genLiteral :: forall era t. Era era =&gt; GenEnv era -&gt; Rep era t -&gt; Gen t
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genLiteral"><span class="hs-identifier hs-var hs-var">genLiteral</span></a></span></span><span> </span><span id="local-6989586621680167069"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167069"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680167068"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167068"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167068"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-type">SetR</span></a></span><span> </span><span id="local-6989586621680167063"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167063"><span class="hs-identifier hs-var">erep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Rep era a -&gt; Gen (Set a)
</span><a href="#local-6989586621680167062"><span class="hs-identifier hs-var">setLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167063"><span class="hs-identifier hs-var">erep</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-type">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Rep era b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Rep era a -&gt; Gen a
</span><a href="#local-6989586621680167058"><span class="hs-identifier hs-var">unconstrained</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167068"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-comment">-- TODO: more clever generation for maps</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="annottext">Rep era t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Rep era a -&gt; Gen a
</span><a href="#local-6989586621680167058"><span class="hs-identifier hs-var">unconstrained</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167068"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="#local-6989586621680167058"><span class="hs-identifier hs-type">unconstrained</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167615"><span class="annot"><a href="#local-6989586621680167615"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167623"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621680167615"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621680167058"><span class="annot"><span class="annottext">unconstrained :: forall a. Rep era a -&gt; Gen a
</span><a href="#local-6989586621680167058"><span class="hs-identifier hs-var hs-var">unconstrained</span></a></span></span><span> </span><span id="local-6989586621680167056"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167056"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era b. Era era =&gt; Rep era b -&gt; Gen b
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#genRep"><span class="hs-identifier hs-var">genRep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167056"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621680167062"><span class="hs-identifier hs-type">setLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167618"><span class="annot"><a href="#local-6989586621680167618"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167623"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680167618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621680167062"><span class="annot"><span class="annottext">setLiteral :: forall a. Ord a =&gt; Rep era a -&gt; Gen (Set a)
</span><a href="#local-6989586621680167062"><span class="hs-identifier hs-var hs-var">setLiteral</span></a></span></span><span> </span><span id="local-6989586621680167041"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167041"><span class="hs-identifier hs-var">erep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680167040"><span class="annot"><span class="annottext">knownSets :: [Set a]
</span><a href="#local-6989586621680167040"><span class="hs-identifier hs-var hs-var">knownSets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680167039"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V era (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680167039"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680167039"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era t. Env era -&gt; Rep era t -&gt; [(V era t, t)]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#envVarsOfType"><span class="hs-identifier hs-var">envVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167069"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167041"><span class="hs-identifier hs-var">erep</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>          </span><span id="local-6989586621680167037"><span class="annot"><span class="annottext">gen :: Gen (Set a)
</span><a href="#local-6989586621680167037"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era b. Era era =&gt; Rep era b -&gt; Gen b
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#genRep"><span class="hs-identifier hs-var">genRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680167041"><span class="hs-identifier hs-var">erep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[Set a]
</span><a href="#local-6989586621680167040"><span class="hs-identifier hs-var">knownSets</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span id="local-6989586621680167035"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680167035"><span class="hs-identifier hs-var">set1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Set a)
</span><a href="#local-6989586621680167037"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span id="local-6989586621680167034"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680167034"><span class="hs-identifier hs-var">set2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Set a)
</span><a href="#local-6989586621680167037"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span id="local-6989586621680167033"><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621680167033"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.intersection</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.difference</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.difference</span></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
</span><a href="#local-6989586621680167033"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680167035"><span class="hs-identifier hs-var">set1</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680167034"><span class="hs-identifier hs-var">set2</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621680167599"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFreshVarName"><span class="hs-identifier hs-type">genFreshVarName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167599"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span><span>
</span><span id="line-149"></span><span id="genFreshVarName"><span class="annot"><span class="annottext">genFreshVarName :: forall era. GenEnv era -&gt; Gen String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFreshVarName"><span class="hs-identifier hs-var hs-var">genFreshVarName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {era}. GenEnv era -&gt; [String]
</span><a href="#local-6989586621680167025"><span class="hs-identifier hs-var">varNames</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621680167020"><span class="annot"><span class="annottext">allTheNames :: [String]
</span><a href="#local-6989586621680167020"><span class="hs-identifier hs-var hs-var">allTheNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680167019"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680167018"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680167019"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680167019"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680167020"><span class="hs-identifier hs-var">allTheNames</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680167018"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680167018"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621680167025"><span class="annot"><span class="annottext">varNames :: GenEnv era -&gt; [String]
</span><a href="#local-6989586621680167025"><span class="hs-identifier hs-var hs-var">varNames</span></a></span></span><span> </span><span id="local-6989586621680167015"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167015"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Depth -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680167012"><span class="hs-identifier hs-var">vmap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680167020"><span class="hs-identifier hs-var">allTheNames</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span id="local-6989586621680167012"><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680167012"><span class="hs-identifier hs-var">vmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680167015"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621680167609"><span id="local-6989586621680167610"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#envVarsOfType"><span class="hs-identifier hs-type">envVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167610"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167610"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167609"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167610"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167609"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680167609"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-157"></span><span id="envVarsOfType"><span class="annot"><span class="annottext">envVarsOfType :: forall era t. Env era -&gt; Rep era t -&gt; [(V era t, t)]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#envVarsOfType"><span class="hs-identifier hs-var hs-var">envVarsOfType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span id="local-6989586621680167009"><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680167009"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680167008"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167008"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(String, Payload era) -&gt; [(V era t, t)]
</span><a href="#local-6989586621680167006"><span class="hs-identifier hs-var">wellTyped</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680167009"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621680167006"><span class="annot"><span class="annottext">wellTyped :: (String, Payload era) -&gt; [(V era t, t)]
</span><a href="#local-6989586621680167006"><span class="hs-identifier hs-var hs-var">wellTyped</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680167004"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680167004"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Payload"><span class="hs-identifier hs-type">Payload</span></a></span><span> </span><span id="local-6989586621680167000"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167000"><span class="hs-identifier hs-var">rep'</span></a></span></span><span> </span><span id="local-6989586621680166999"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166999"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166998"><span class="annot"><span class="annottext">Access era s t
</span><a href="#local-6989586621680166998"><span class="hs-identifier hs-var">access</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (i :: k) (j :: k).
Singleton t =&gt;
t i -&gt; t j -&gt; Maybe (i :~: j)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">testEql</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167008"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167000"><span class="hs-identifier hs-var">rep'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">t :~: t
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t t. String -&gt; Rep era t -&gt; Access era t t -&gt; V era t
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680167004"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680167008"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Access era s t
</span><a href="#local-6989586621680166998"><span class="hs-identifier hs-var">access</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166999"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">Maybe (t :~: t)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">data</span><span> </span><span id="VarSpec"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarSpec"><span class="hs-identifier hs-var">VarSpec</span></a></span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Must contain a variable (either unsolved, or solved at least the given depth).</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">--   Requiring a minimum depth let's us avoid introducing cycles in</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">--   already solved variables.</span><span>
</span><span id="line-168"></span><span>    </span><span id="VarTerm"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Can only use solved variables</span><span>
</span><span id="line-170"></span><span>    </span><span id="KnownTerm"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166987"><span id="local-6989586621680166990"><span class="annot"><span class="annottext">VarSpec -&gt; VarSpec -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: VarSpec -&gt; VarSpec -&gt; Bool
$c/= :: VarSpec -&gt; VarSpec -&gt; Bool
== :: VarSpec -&gt; VarSpec -&gt; Bool
$c== :: VarSpec -&gt; VarSpec -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166978"><span id="local-6989586621680166980"><span id="local-6989586621680166984"><span class="annot"><span class="annottext">Depth -&gt; VarSpec -&gt; ShowS
[VarSpec] -&gt; ShowS
VarSpec -&gt; String
forall a.
(Depth -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [VarSpec] -&gt; ShowS
$cshowList :: [VarSpec] -&gt; ShowS
show :: VarSpec -&gt; String
$cshow :: VarSpec -&gt; String
showsPrec :: Depth -&gt; VarSpec -&gt; ShowS
$cshowsPrec :: Depth -&gt; VarSpec -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span id="local-6989586621680167570"><span id="local-6989586621680167571"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-type">genTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167571"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167571"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167571"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167570"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarSpec"><span class="hs-identifier hs-type">VarSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167571"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167570"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167571"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-174"></span><span id="genTerm"><span class="annot"><span class="annottext">genTerm :: forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var hs-var">genTerm</span></a></span></span><span> </span><span id="local-6989586621680166973"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166973"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680166972"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166972"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621680166971"><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166971"><span class="hs-identifier hs-var">vspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166973"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166972"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Era era =&gt; GenEnv era -&gt; Rep era t -&gt; Gen t
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genLiteral"><span class="hs-identifier hs-var">genLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166973"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166972"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166971"><span class="hs-identifier hs-var">vspec</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-type">genTerm'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167567"><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621680167566"><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarSpec"><span class="hs-identifier hs-type">VarSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="genTerm%27"><span class="annot"><span class="annottext">genTerm' :: forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var hs-var">genTerm'</span></a></span></span><span> </span><span id="local-6989586621680166959"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680166958"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166958"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621680166957"><span class="annot"><span class="annottext">t -&gt; Bool
</span><a href="#local-6989586621680166957"><span class="hs-identifier hs-var">valid</span></a></span></span><span> </span><span id="local-6989586621680166956"><span class="annot"><span class="annottext">Gen t
</span><a href="#local-6989586621680166956"><span class="hs-identifier hs-var">genLit</span></a></span></span><span> </span><span id="local-6989586621680166955"><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166955"><span class="hs-identifier hs-var">vspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="annottext">forall a. [(Depth, Gen a)] -&gt; Gen a
</span><span class="hs-identifier hs-var">frequency</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166953"><span class="hs-identifier hs-var">genFixed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166955"><span class="hs-identifier hs-var">vspec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166952"><span class="hs-identifier hs-var">genExistingVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[V era t]
</span><a href="#local-6989586621680166949"><span class="hs-identifier hs-var">allowedVars</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166948"><span class="hs-identifier hs-var">genFreshVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-type">VarTerm</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166955"><span class="hs-identifier hs-var">vspec</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k.
(t ~ Set k, Ord k) =&gt;
Rep era k -&gt; Gen (Term era (Set k), GenEnv era)
</span><a href="#local-6989586621680166947"><span class="hs-identifier hs-var">genDom</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166944"><span class="hs-identifier hs-var">krep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-type">SetR</span></a></span><span> </span><span id="local-6989586621680166944"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166944"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166958"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k.
(t ~ Set k, Ord k) =&gt;
Rep era k -&gt; Gen (Term era (Set k), GenEnv era)
</span><a href="#local-6989586621680166940"><span class="hs-identifier hs-var">genRng</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166937"><span class="hs-identifier hs-var">vrep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-type">SetR</span></a></span><span> </span><span id="local-6989586621680166937"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166937"><span class="hs-identifier hs-var">vrep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166958"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621680166933"><span class="annot"><span class="annottext">isValid :: (V era t, t) -&gt; Bool
</span><a href="#local-6989586621680166933"><span class="hs-identifier hs-var hs-var">isValid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V era t
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166932"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166932"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Bool
</span><a href="#local-6989586621680166957"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166932"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621680166931"><span class="annot"><span class="annottext">existingVars :: [V era t]
</span><a href="#local-6989586621680166931"><span class="hs-identifier hs-var hs-var">existingVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">(V era t, t) -&gt; Bool
</span><a href="#local-6989586621680166933"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Env era -&gt; Rep era t -&gt; [(V era t, t)]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#envVarsOfType"><span class="hs-identifier hs-var">envVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166958"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621680166949"><span class="annot"><span class="annottext">allowedVars :: [V era t]
</span><a href="#local-6989586621680166949"><span class="hs-identifier hs-var hs-var">allowedVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166955"><span class="hs-identifier hs-var">vspec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-type">VarTerm</span></a></span><span> </span><span id="local-6989586621680166930"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166930"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166930"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Name era -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfName"><span class="hs-identifier hs-var">depthOfName</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Name era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[V era t]
</span><a href="#local-6989586621680166931"><span class="hs-identifier hs-var">existingVars</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Map (Name era) Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gSolved"><span class="hs-identifier hs-var">gSolved</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Name era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[V era t]
</span><a href="#local-6989586621680166931"><span class="hs-identifier hs-var">existingVars</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621680166953"><span class="annot"><span class="annottext">genFixed :: Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166953"><span class="hs-identifier hs-var hs-var">genFixed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166958"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen t
</span><a href="#local-6989586621680166956"><span class="hs-identifier hs-var">genLit</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621680166952"><span class="annot"><span class="annottext">genExistingVar :: Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166952"><span class="hs-identifier hs-var hs-var">genExistingVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">[V era t]
</span><a href="#local-6989586621680166949"><span class="hs-identifier hs-var">allowedVars</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621680166948"><span class="annot"><span class="annottext">genFreshVar :: Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166948"><span class="hs-identifier hs-var hs-var">genFreshVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>      </span><span id="local-6989586621680166926"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166926"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Gen String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFreshVarName"><span class="hs-identifier hs-var">genFreshVarName</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span id="local-6989586621680166925"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166925"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen t
</span><a href="#local-6989586621680166956"><span class="hs-identifier hs-var">genLit</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166924"><span class="annot"><span class="annottext">var :: V era t
</span><a href="#local-6989586621680166924"><span class="hs-identifier hs-var hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t t. String -&gt; Rep era t -&gt; Access era t t -&gt; V era t
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166926"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166958"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">forall era s t. Access era s t
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680166924"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; t -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#addVar"><span class="hs-identifier hs-var">addVar</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680166924"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166925"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="#local-6989586621680166947"><span class="hs-identifier hs-type">genDom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167561"><span class="annot"><a href="#local-6989586621680167561"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680167561"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167561"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167561"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680167561"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621680166947"><span class="annot"><span class="annottext">genDom :: forall k.
(t ~ Set k, Ord k) =&gt;
Rep era k -&gt; Gen (Term era (Set k), GenEnv era)
</span><a href="#local-6989586621680166947"><span class="hs-identifier hs-var hs-var">genDom</span></a></span></span><span> </span><span id="local-6989586621680166918"><span class="annot"><span class="annottext">Rep era k
</span><a href="#local-6989586621680166918"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166907"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166907"><span class="hs-identifier hs-var">vrep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680166905"><span class="annot"><span class="annottext">Term era (Map k t)
</span><a href="#local-6989586621680166905"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166904"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166904"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era k
</span><a href="#local-6989586621680166918"><span class="hs-identifier hs-var">krep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166907"><span class="hs-identifier hs-var">vrep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Bool
</span><a href="#local-6989586621680166957"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen t
</span><a href="#local-6989586621680166956"><span class="hs-identifier hs-var">genLit</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall era v k.
Era era =&gt;
GenEnv era -&gt; Rep era v -&gt; Set k -&gt; Gen (Map k v)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithDom"><span class="hs-identifier hs-var">genMapLiteralWithDom</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166907"><span class="hs-identifier hs-var">vrep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>          </span><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166955"><span class="hs-identifier hs-var">vspec</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s. Ord t =&gt; Term era (Map t s) -&gt; Term era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map k t)
</span><a href="#local-6989586621680166905"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166904"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="#local-6989586621680166940"><span class="hs-identifier hs-type">genRng</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680166900"><span class="annot"><a href="#local-6989586621680166900"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680167566"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680166900"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166900"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166900"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680166900"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167567"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621680166940"><span class="annot"><span class="annottext">genRng :: forall k.
(t ~ Set k, Ord k) =&gt;
Rep era k -&gt; Gen (Term era (Set k), GenEnv era)
</span><a href="#local-6989586621680166940"><span class="hs-identifier hs-var hs-var">genRng</span></a></span></span><span> </span><span id="local-6989586621680166895"><span class="annot"><span class="annottext">Rep era v
</span><a href="#local-6989586621680166895"><span class="hs-identifier hs-var">vrep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166882"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166882"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var">genKeyType</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680166880"><span class="annot"><span class="annottext">Term era (Map t v)
</span><a href="#local-6989586621680166880"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166879"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166879"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-217"></span><span>          </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-218"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166882"><span class="hs-identifier hs-var">krep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era v
</span><a href="#local-6989586621680166895"><span class="hs-identifier hs-var">vrep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Bool
</span><a href="#local-6989586621680166957"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen t
</span><a href="#local-6989586621680166956"><span class="hs-identifier hs-var">genLit</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall era k v.
(Era era, Ord k) =&gt;
GenEnv era -&gt; Rep era k -&gt; Set v -&gt; Gen (Map k v)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithRng"><span class="hs-identifier hs-var">genMapLiteralWithRng</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166959"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166882"><span class="hs-identifier hs-var">krep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>          </span><span class="annot"><span class="annottext">VarSpec
</span><a href="#local-6989586621680166955"><span class="hs-identifier hs-var">vspec</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t s era.
(Ord t, Ord s) =&gt;
Term era (Map t s) -&gt; Term era (Set s)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Rng"><span class="hs-identifier hs-var">Rng</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map t v)
</span><a href="#local-6989586621680166880"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166879"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="local-6989586621680167536"><span id="local-6989586621680167537"><span id="local-6989586621680167538"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithDom"><span class="hs-identifier hs-type">genMapLiteralWithDom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167538"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167538"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167538"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167537"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680167536"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680167536"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167537"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-225"></span><span id="genMapLiteralWithDom"><span class="annot"><span class="annottext">genMapLiteralWithDom :: forall era v k.
Era era =&gt;
GenEnv era -&gt; Rep era v -&gt; Set k -&gt; Gen (Map k v)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithDom"><span class="hs-identifier hs-var hs-var">genMapLiteralWithDom</span></a></span></span><span> </span><span id="local-6989586621680166869"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166869"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680166868"><span class="annot"><span class="annottext">Rep era v
</span><a href="#local-6989586621680166868"><span class="hs-identifier hs-var">vrep</span></a></span></span><span> </span><span id="local-6989586621680166867"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621680166867"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166866"><span class="annot"><span class="annottext">genVal :: Gen v
</span><a href="#local-6989586621680166866"><span class="hs-identifier hs-var hs-var">genVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. Era era =&gt; GenEnv era -&gt; Rep era t -&gt; Gen t
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genLiteral"><span class="hs-identifier hs-var">genLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166869"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era v
</span><a href="#local-6989586621680166868"><span class="hs-identifier hs-var">vrep</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen v
</span><a href="#local-6989586621680166866"><span class="hs-identifier hs-var">genVal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621680166867"><span class="hs-identifier hs-var">keys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621680167527"><span id="local-6989586621680167528"><span id="local-6989586621680167529"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithRng"><span class="hs-identifier hs-type">genMapLiteralWithRng</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167529"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167528"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167529"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167529"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680167527"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680167528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167527"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-230"></span><span id="genMapLiteralWithRng"><span class="annot"><span class="annottext">genMapLiteralWithRng :: forall era k v.
(Era era, Ord k) =&gt;
GenEnv era -&gt; Rep era k -&gt; Set v -&gt; Gen (Map k v)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithRng"><span class="hs-identifier hs-var hs-var">genMapLiteralWithRng</span></a></span></span><span> </span><span id="local-6989586621680166856"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166856"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680166855"><span class="annot"><span class="annottext">Rep era k
</span><a href="#local-6989586621680166855"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span id="local-6989586621680166854"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680166854"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621680166853"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621680166853"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [String] -&gt; Depth -&gt; Gen a -&gt; Gen (Set a)
</span><a href="Test.Cardano.Ledger.Constrained.Combinators.html#setSized"><span class="hs-identifier hs-var">setSized</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; Depth
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680166854"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Era era =&gt; GenEnv era -&gt; Rep era t -&gt; Gen t
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genLiteral"><span class="hs-identifier hs-var">genLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166856"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era k
</span><a href="#local-6989586621680166855"><span class="hs-identifier hs-var">krep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621680166850"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680166850"><span class="hs-identifier hs-var">valsList</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><span class="hs-identifier hs-var">shuffle</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680166854"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621680166853"><span class="hs-identifier hs-var">keys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680166850"><span class="hs-identifier hs-var">valsList</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-keyword">data</span><span> </span><span id="TypeInEra"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span></span><span> </span><span id="local-6989586621680166847"><span class="annot"><a href="#local-6989586621680166847"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621680166846"><span id="local-6989586621680167506"><span id="TypeInEra"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166846"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166846"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167506"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166846"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167506"><span class="hs-identifier hs-type">era</span></a></span></span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621680166845"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-type">genKeyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166845"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span id="genKeyType"><span class="annot"><span class="annottext">genKeyType :: forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var hs-var">genKeyType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall t era. (Show t, Ord t) =&gt; Rep era t -&gt; TypeInEra era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Depth
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#IntR"><span class="hs-identifier hs-var">IntR</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span id="local-6989586621680167546"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-type">genValType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-242"></span><span id="genValType"><span class="annot"><span class="annottext">genValType :: forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var hs-var">genValType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall t era. (Show t, Ord t) =&gt; Rep era t -&gt; TypeInEra era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Coin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall t era. (Show t, Ord t) =&gt; Rep era t -&gt; TypeInEra era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era DeltaCoin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#DeltaCoinR"><span class="hs-identifier hs-var">DeltaCoinR</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Possible future use , TypeInEra (PairR CoinR CoinR)]</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621680166832"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genBaseType"><span class="hs-identifier hs-type">genBaseType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166832"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-245"></span><span id="genBaseType"><span class="annot"><span class="annottext">genBaseType :: forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genBaseType"><span class="hs-identifier hs-var hs-var">genBaseType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var">genKeyType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span id="local-6989586621680166830"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genType"><span class="hs-identifier hs-type">genType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166830"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-248"></span><span id="genType"><span class="annot"><span class="annottext">genType :: forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genType"><span class="hs-identifier hs-var hs-var">genType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genBaseType"><span class="hs-identifier hs-var">genBaseType</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {era}. TypeInEra era -&gt; TypeInEra era
</span><a href="#local-6989586621680166824"><span class="hs-identifier hs-var">setR</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {era}. TypeInEra era -&gt; TypeInEra era
</span><a href="#local-6989586621680166823"><span class="hs-identifier hs-var">listR</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {era}. TypeInEra era -&gt; TypeInEra era -&gt; TypeInEra era
</span><a href="#local-6989586621680166822"><span class="hs-identifier hs-var">mapR</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var">genKeyType</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621680166824"><span class="annot"><span class="annottext">setR :: TypeInEra era -&gt; TypeInEra era
</span><a href="#local-6989586621680166824"><span class="hs-identifier hs-var hs-var">setR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166814"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166814"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t era. (Show t, Ord t) =&gt; Rep era t -&gt; TypeInEra era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166814"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621680166823"><span class="annot"><span class="annottext">listR :: TypeInEra era -&gt; TypeInEra era
</span><a href="#local-6989586621680166823"><span class="hs-identifier hs-var hs-var">listR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166809"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166809"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t era. (Show t, Ord t) =&gt; Rep era t -&gt; TypeInEra era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; Rep era [t]
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166809"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621680166822"><span class="annot"><span class="annottext">mapR :: TypeInEra era -&gt; TypeInEra era -&gt; TypeInEra era
</span><a href="#local-6989586621680166822"><span class="hs-identifier hs-var hs-var">mapR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166805"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166805"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166798"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166798"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t era. (Show t, Ord t) =&gt; Rep era t -&gt; TypeInEra era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-var">TypeInEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166805"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166798"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Unsatisfiable constraint returned if we fail during constraint generation.</span><span>
</span><span id="line-261"></span><span id="local-6989586621680167486"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#errPred"><span class="hs-identifier hs-type">errPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167486"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-262"></span><span id="errPred"><span class="annot"><span class="annottext">errPred :: forall era. [String] -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#errPred"><span class="hs-identifier hs-var hs-var">errPred</span></a></span></span><span> </span><span id="local-6989586621680166790"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166790"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; Rep era [t]
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era String
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#StringR"><span class="hs-identifier hs-var">StringR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Errors:&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall t era. Eq t =&gt; Term era t -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; Rep era [t]
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era String
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#StringR"><span class="hs-identifier hs-var">StringR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166790"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- This is very ad hoc</span><span>
</span><span id="line-265"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#setWithSum"><span class="hs-identifier hs-type">setWithSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span id="setWithSum"><span class="annot"><span class="annottext">setWithSum :: Depth -&gt; Gen (Set Depth)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#setWithSum"><span class="hs-identifier hs-var hs-var">setWithSum</span></a></span></span><span> </span><span id="local-6989586621680166786"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166786"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Depth -&gt; Set Depth
</span><a href="#local-6989586621680166785"><span class="hs-identifier hs-var">fixUp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621680166785"><span class="annot"><span class="annottext">fixUp :: Set Depth -&gt; Set Depth
</span><a href="#local-6989586621680166785"><span class="hs-identifier hs-var hs-var">fixUp</span></a></span></span><span> </span><span id="local-6989586621680166784"><span class="annot"><span class="annottext">Set Depth
</span><a href="#local-6989586621680166784"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166783"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Depth
</span><a href="#local-6989586621680166784"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.notMember</span></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166783"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="annot"><span class="annottext">Set Depth
</span><a href="#local-6989586621680166784"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166783"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="annot"><span class="annottext">Set Depth
</span><a href="#local-6989586621680166784"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166786"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621680166783"><span class="annot"><span class="annottext">missing :: Depth
</span><a href="#local-6989586621680166783"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166786"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">Set Depth
</span><a href="#local-6989586621680166784"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#listWithSum"><span class="hs-identifier hs-type">listWithSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span id="listWithSum"><span class="annot"><span class="annottext">listWithSum :: Coin -&gt; Gen [Coin]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#listWithSum"><span class="hs-identifier hs-var hs-var">listWithSum</span></a></span></span><span> </span><span id="local-6989586621680166778"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166778"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coin] -&gt; [Coin]
</span><a href="#local-6989586621680166777"><span class="hs-identifier hs-var">fixUp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621680166777"><span class="annot"><span class="annottext">fixUp :: [Coin] -&gt; [Coin]
</span><a href="#local-6989586621680166777"><span class="hs-identifier hs-var hs-var">fixUp</span></a></span></span><span> </span><span id="local-6989586621680166776"><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166776"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166775"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166776"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166775"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166776"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621680166775"><span class="annot"><span class="annottext">missing :: Coin
</span><a href="#local-6989586621680166775"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166778"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall m. Group m =&gt; m -&gt; m -&gt; m
</span><span class="hs-operator hs-var">~~</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166776"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#mapWithSum"><span class="hs-identifier hs-type">mapWithSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span id="mapWithSum"><span class="annot"><span class="annottext">mapWithSum :: Coin -&gt; Gen (Map Coin Coin)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#mapWithSum"><span class="hs-identifier hs-var hs-var">mapWithSum</span></a></span></span><span> </span><span id="local-6989586621680166771"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166771"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621680166770"><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166770"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Gen [Coin]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#listWithSum"><span class="hs-identifier hs-var">listWithSum</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166771"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621680166769"><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166769"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [String] -&gt; Depth -&gt; Gen a -&gt; Gen (Set a)
</span><a href="Test.Cardano.Ledger.Constrained.Combinators.html#setSized"><span class="hs-identifier hs-var">setSized</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Depth
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166770"><span class="hs-identifier hs-var">rng</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166769"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166770"><span class="hs-identifier hs-var">rng</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span id="local-6989586621680167474"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFromOrdCond"><span class="hs-identifier hs-type">genFromOrdCond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621680167474"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Classes.html#Adds"><span class="hs-identifier hs-type">Adds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167474"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Size.html#OrdCond"><span class="hs-identifier hs-type">OrdCond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167474"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621680167474"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-293"></span><span id="genFromOrdCond"><span class="annot"><span class="annottext">genFromOrdCond :: forall c. (Arbitrary c, Adds c) =&gt; OrdCond -&gt; Bool -&gt; c -&gt; Gen c
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFromOrdCond"><span class="hs-identifier hs-var hs-var">genFromOrdCond</span></a></span></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#EQL"><span class="hs-identifier hs-var">EQL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680166742"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166742"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166742"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFromOrdCond"><span class="hs-identifier hs-var">genFromOrdCond</span></a></span><span> </span><span id="local-6989586621680166741"><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166741"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621680166740"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166740"><span class="hs-identifier hs-var">canBeNegative</span></a></span></span><span> </span><span id="local-6989586621680166739"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><span class="annottext">forall a. [String] -&gt; Gen a -&gt; (a -&gt; Bool) -&gt; Gen a
</span><a href="Test.Cardano.Ledger.Constrained.Combinators.html#suchThatErr"><span class="hs-identifier hs-var">suchThatErr</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genFromOrdCond &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166741"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall a. [(Depth, Gen a)] -&gt; Gen a
</span><span class="hs-identifier hs-var">frequency</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; [String] -&gt; x -&gt; x -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#minus"><span class="hs-identifier hs-var">minus</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genFromOrdCond&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Adds x =&gt; [String] -&gt; Depth -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#fromI"><span class="hs-identifier hs-var">fromI</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166740"><span class="hs-identifier hs-var">canBeNegative</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>          </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; x -&gt; x -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Adds x =&gt; [String] -&gt; Depth -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#fromI"><span class="hs-identifier hs-var">fromI</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Ord c =&gt; OrdCond -&gt; c -&gt; c -&gt; Bool
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#runOrdCond"><span class="hs-identifier hs-var">runOrdCond</span></a></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166741"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166739"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genPredicate"><span class="hs-identifier hs-type">genPredicate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167468"><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span id="genPredicate"><span class="annot"><span class="annottext">genPredicate :: forall era. Era era =&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genPredicate"><span class="hs-identifier hs-var hs-var">genPredicate</span></a></span></span><span> </span><span id="local-6989586621680166679"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">forall a. [(Depth, Gen a)] -&gt; Gen a
</span><span class="hs-identifier hs-var">frequency</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166678"><span class="hs-identifier hs-var">fixedSizedC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166677"><span class="hs-identifier hs-var">varSizedC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166676"><span class="hs-identifier hs-var">eqC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166675"><span class="hs-identifier hs-var">subsetC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166674"><span class="hs-identifier hs-var">disjointC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166673"><span class="hs-identifier hs-var">sumsToC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166672"><span class="hs-identifier hs-var">hasDomC</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="#local-6989586621680166671"><span class="hs-identifier hs-type">withValue</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167463"><span class="annot"><a href="#local-6989586621680167463"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167463"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167463"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167463"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621680166671"><span class="annot"><span class="annottext">withValue :: forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var hs-var">withValue</span></a></span></span><span> </span><span id="local-6989586621680166668"><span class="annot"><span class="annottext">Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166668"><span class="hs-identifier hs-var">genTm</span></a></span></span><span> </span><span id="local-6989586621680166667"><span class="annot"><span class="annottext">Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166667"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680166666"><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166666"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166665"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166665"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Term era t, GenEnv era)
</span><a href="#local-6989586621680166668"><span class="hs-identifier hs-var">genTm</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall x. Typed x -&gt; Either [String] x
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#runTyped"><span class="hs-identifier hs-var">runTyped</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Env era -&gt; Term era t -&gt; Typed t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166665"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166666"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680166662"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166662"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. [String] -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#errPred"><span class="hs-identifier hs-var">errPred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166662"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166665"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680166661"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166661"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166667"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166666"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166661"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166665"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621680166660"><span class="annot"><span class="annottext">goodSized :: (Pred era, b) -&gt; Bool
</span><a href="#local-6989586621680166660"><span class="hs-identifier hs-var hs-var">goodSized</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="annot"><span class="annottext">Term era Size
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-comment">-- TODO/sizedRng</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="#local-6989586621680166660"><span class="hs-identifier hs-var">goodSized</span></a></span><span> </span><span class="annot"><span class="annottext">(Pred era, b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-comment">-- Fixed size</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621680166678"><span class="annot"><span class="annottext">fixedSizedC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166678"><span class="hs-identifier hs-var hs-var">fixedSizedC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; (a -&gt; Bool) -&gt; Gen a
</span><span class="hs-identifier hs-var">suchThat</span></span><span> </span><span class="annot"><span class="annottext">forall {era} {b}. (Pred era, b) -&gt; Bool
</span><a href="#local-6989586621680166660"><span class="hs-identifier hs-var">goodSized</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166645"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166645"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166645"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166644"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166644"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621680166643"><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166643"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166642"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166642"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166641"><span class="annot"><span class="annottext">n :: Term era Size
</span><a href="#local-6989586621680166641"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Depth -&gt; Term era Size
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#ExactSize"><span class="hs-identifier hs-var">ExactSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Sizeable t =&gt; t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#getSize"><span class="hs-identifier hs-var">getSize</span></a></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166643"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Sizeable t =&gt; Term era Size -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Sized"><span class="hs-identifier hs-var">Sized</span></a></span><span> </span><span class="annot"><span class="annottext">Term era Size
</span><a href="#local-6989586621680166641"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166644"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166644"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166642"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- Fresh variable for size.</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621680166677"><span class="annot"><span class="annottext">varSizedC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166677"><span class="hs-identifier hs-var hs-var">varSizedC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166628"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166628"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166628"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166627"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166627"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621680166626"><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166626"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166625"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166625"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>        </span><span id="local-6989586621680166624"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166624"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Gen String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFreshVarName"><span class="hs-identifier hs-var">genFreshVarName</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166625"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166623"><span class="annot"><span class="annottext">var :: V era Size
</span><a href="#local-6989586621680166623"><span class="hs-identifier hs-var hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t t. String -&gt; Rep era t -&gt; Access era t t -&gt; V era t
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166624"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Size
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SizeR"><span class="hs-identifier hs-var">SizeR</span></a></span><span> </span><span class="annot"><span class="annottext">forall era s t. Access era s t
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>
</span><span id="line-344"></span><span>            </span><span id="local-6989586621680166621"><span class="annot"><span class="annottext">intn :: Depth
</span><a href="#local-6989586621680166621"><span class="hs-identifier hs-var hs-var">intn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Sizeable t =&gt; t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#getSize"><span class="hs-identifier hs-var">getSize</span></a></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166626"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Sizeable t =&gt; Term era Size -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Sized"><span class="hs-identifier hs-var">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">V era Size
</span><a href="#local-6989586621680166623"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166627"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; t -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#addSolvedVar"><span class="hs-identifier hs-var">addSolvedVar</span></a></span><span> </span><span class="annot"><span class="annottext">V era Size
</span><a href="#local-6989586621680166623"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; Depth -&gt; Size
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#SzRng"><span class="hs-identifier hs-var">SzRng</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166621"><span class="hs-identifier hs-var">intn</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166621"><span class="hs-identifier hs-var">intn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166625"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166627"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166625"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621680166676"><span class="annot"><span class="annottext">eqC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166676"><span class="hs-identifier hs-var hs-var">eqC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166606"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166606"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genType"><span class="hs-identifier hs-var">genType</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166606"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166605"><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166605"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680166604"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166604"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166603"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166603"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166602"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166602"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166603"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166605"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680166601"><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166601"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166600"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166600"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166603"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166606"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166604"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166604"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166602"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166605"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era. Eq t =&gt; Term era t -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166601"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166601"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166602"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166600"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621680166675"><span class="annot"><span class="annottext">subsetC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166675"><span class="hs-identifier hs-var hs-var">subsetC</span></a></span></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OrderInfo -&gt; Bool
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#setBeforeSubset"><span class="hs-identifier hs-var">setBeforeSubset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gOrder"><span class="hs-identifier hs-var">gOrder</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-356"></span><span>          </span><span class="hs-comment">-- Known superset</span><span>
</span><span id="line-357"></span><span>          </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166585"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166585"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-358"></span><span>          </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166585"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166584"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166584"><span class="hs-identifier hs-var">sup</span></a></span></span><span> </span><span id="local-6989586621680166583"><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166583"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166582"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166582"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-359"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166581"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166581"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166582"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166584"><span class="hs-identifier hs-var">sup</span></a></span><span>
</span><span id="line-360"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680166580"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166580"><span class="hs-identifier hs-var">sub</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166579"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166579"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-361"></span><span>              </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-362"></span><span>                </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166582"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-363"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166585"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166583"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [String] -&gt; Set a -&gt; Gen (Set a)
</span><a href="Test.Cardano.Ledger.Constrained.Combinators.html#subsetFromSet"><span class="hs-identifier hs-var">subsetFromSet</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;From genPredicate subsetC&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166583"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166581"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166580"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era.
Ord t =&gt;
Term era (Set t) -&gt; Term era (Set t) -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Subset"><span class="hs-operator hs-var">`Subset`</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166584"><span class="hs-identifier hs-var">sup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166580"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166581"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166579"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>          </span><span class="hs-comment">-- Known subset</span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166559"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166559"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-371"></span><span>          </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166559"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166558"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166558"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621680166557"><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166557"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166556"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166556"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166555"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166555"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166556"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166558"><span class="hs-identifier hs-var">sub</span></a></span><span>
</span><span id="line-373"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680166554"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166554"><span class="hs-identifier hs-var">sup</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166553"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166553"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-374"></span><span>              </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-375"></span><span>                </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166556"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166559"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.isSubsetOf</span></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166557"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166557"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era b. Era era =&gt; Rep era b -&gt; Gen b
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#genRep"><span class="hs-identifier hs-var">genRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166559"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166555"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166558"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era.
Ord t =&gt;
Term era (Set t) -&gt; Term era (Set t) -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Subset"><span class="hs-operator hs-var">`Subset`</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166554"><span class="hs-identifier hs-var">sup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166554"><span class="hs-identifier hs-var">sup</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166555"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166553"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-comment">-- Disjoint, left KnownTerm and right VarTerm</span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621680166674"><span class="annot"><span class="annottext">disjointC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166674"><span class="hs-identifier hs-var hs-var">disjointC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166536"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166536"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166536"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166535"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166535"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680166534"><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166534"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166533"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166533"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166532"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166532"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166533"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166535"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680166531"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166531"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166530"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166530"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-388"></span><span>          </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166533"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166536"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.disjoint</span></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166534"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.difference`</span></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166534"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era b. Era era =&gt; Rep era b -&gt; Gen b
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#genRep"><span class="hs-identifier hs-var">genRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166536"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166532"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era.
Ord t =&gt;
Term era (Set t) -&gt; Term era (Set t) -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Disjoint"><span class="hs-identifier hs-var">Disjoint</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166535"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166531"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166531"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166532"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166530"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-comment">-- SumsTo constraint, only Map Int Int at the moment.</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621680166673"><span class="annot"><span class="annottext">sumsToC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166673"><span class="hs-identifier hs-var hs-var">sumsToC</span></a></span></span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OrderInfo -&gt; Bool
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#sumBeforeParts"><span class="hs-identifier hs-var">sumBeforeParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gOrder"><span class="hs-identifier hs-var">gOrder</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>          </span><span class="hs-comment">-- Known sum</span><span>
</span><span id="line-400"></span><span>          </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Coin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166526"><span class="annot"><span class="annottext">Term era Coin
</span><a href="#local-6989586621680166526"><span class="hs-identifier hs-var">sumTm</span></a></span></span><span> </span><span id="local-6989586621680166525"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166525"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166524"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166524"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166523"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166523"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166524"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era Coin
</span><a href="#local-6989586621680166526"><span class="hs-identifier hs-var">sumTm</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>                </span><span id="local-6989586621680166522"><span class="annot"><span class="annottext">genParts :: [Coin] -&gt; GenEnv era -&gt; Gen ([Sum era Coin], GenEnv era)
</span><a href="#local-6989586621680166522"><span class="hs-identifier hs-var hs-var">genParts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680166521"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166521"><span class="hs-identifier hs-var">env0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166521"><span class="hs-identifier hs-var">env0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>                </span><span class="annot"><a href="#local-6989586621680166522"><span class="hs-identifier hs-var">genParts</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166520"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166520"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680166519"><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166519"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166518"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166518"><span class="hs-identifier hs-var">env0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621680166517"><span class="annot"><span class="annottext">Term era (Map Coin Coin)
</span><a href="#local-6989586621680166517"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166516"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166516"><span class="hs-identifier hs-var">env1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-406"></span><span>                    </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-407"></span><span>                      </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166518"><span class="hs-identifier hs-var">env0</span></a></span><span>
</span><span id="line-408"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Coin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Coin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166520"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Gen (Map Coin Coin)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#mapWithSum"><span class="hs-identifier hs-var">mapWithSum</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166520"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166523"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                  </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c era t. Adds c =&gt; Term era (Map t c) -&gt; Sum era c
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map Coin Coin)
</span><a href="#local-6989586621680166517"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin] -&gt; GenEnv era -&gt; Gen ([Sum era Coin], GenEnv era)
</span><a href="#local-6989586621680166522"><span class="hs-identifier hs-var">genParts</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166519"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166516"><span class="hs-identifier hs-var">env1</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="hs-comment">-- TODO: It's unclear what the requirements are on the parts when solving sumBeforeParts.</span><span>
</span><span id="line-414"></span><span>            </span><span class="hs-comment">-- The solver fails if you have multiple unknown variables. Generating only a single part</span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-comment">-- for now, since sumBeforeParts is anyway disabled due to TODO/SumSet.</span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-comment">-- count &lt;- choose (1, min 3 val)</span><span>
</span><span id="line-417"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166514"><span class="annot"><span class="annottext">count :: Depth
</span><a href="#local-6989586621680166514"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span>
</span><span id="line-418"></span><span>            </span><span id="local-6989586621680166513"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166513"><span class="hs-identifier hs-var">small</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; Gen Depth
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#genSmall"><span class="hs-identifier hs-var">genSmall</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-419"></span><span>            </span><span id="local-6989586621680166511"><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166511"><span class="hs-identifier hs-var">partSums</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; x -&gt; [String] -&gt; Depth -&gt; x -&gt; Gen [x]
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Adds x =&gt; [String] -&gt; Depth -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#fromI"><span class="hs-identifier hs-var">fromI</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166513"><span class="hs-identifier hs-var">small</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sumdToC in Tests.hs&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166514"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680166525"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-420"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680166509"><span class="annot"><span class="annottext">[Sum era Coin]
</span><a href="#local-6989586621680166509"><span class="hs-identifier hs-var">parts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166508"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166508"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Coin] -&gt; GenEnv era -&gt; Gen ([Sum era Coin], GenEnv era)
</span><a href="#local-6989586621680166522"><span class="hs-identifier hs-var">genParts</span></a></span><span> </span><span class="annot"><span class="annottext">[Coin]
</span><a href="#local-6989586621680166511"><span class="hs-identifier hs-var">partSums</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166524"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-421"></span><span>            </span><span class="hs-comment">-- At some point we should generate a random TestCond other than EQL</span><span>
</span><span id="line-422"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era.
Adds t =&gt;
t -&gt; Term era t -&gt; OrdCond -&gt; [Sum era t] -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumsTo"><span class="hs-identifier hs-var">SumsTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Adds x =&gt; [String] -&gt; Depth -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#fromI"><span class="hs-identifier hs-var">fromI</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166513"><span class="hs-identifier hs-var">small</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term era Coin
</span><a href="#local-6989586621680166526"><span class="hs-identifier hs-var">sumTm</span></a></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#EQL"><span class="hs-identifier hs-var">EQL</span></a></span><span> </span><span class="annot"><span class="annottext">[Sum era Coin]
</span><a href="#local-6989586621680166509"><span class="hs-identifier hs-var">parts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era r. Set (Name era) -&gt; Sum era r -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#varsOfSum"><span class="hs-identifier hs-var">varsOfSum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Sum era Coin]
</span><a href="#local-6989586621680166509"><span class="hs-identifier hs-var">parts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166523"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166508"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span>          </span><span class="annot"><span class="annottext">forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-425"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall c.
(Adds c, Arbitrary c) =&gt;
Rep era c -&gt; Bool -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166504"><span class="hs-identifier hs-var">sumCKnownSets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Coin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-426"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall c.
(Adds c, Arbitrary c) =&gt;
Rep era c -&gt; Bool -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166504"><span class="hs-identifier hs-var">sumCKnownSets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era DeltaCoin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#DeltaCoinR"><span class="hs-identifier hs-var">DeltaCoinR</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-427"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-comment">-- Avoid constraints where the same variable appears in multiple parts, since we can't solve</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-comment">-- these when the variable is unknown.</span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621680166503"><span class="annot"><span class="annottext">uniqueVars :: Pred era -&gt; Bool
</span><a href="#local-6989586621680166503"><span class="hs-identifier hs-var hs-var">uniqueVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumsTo"><span class="hs-identifier hs-type">SumsTo</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term era c
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680166497"><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166497"><span class="hs-identifier hs-var">parts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.disjoint</span></span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166495"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166494"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-434"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680166495"><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166495"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680166493"><span class="annot"><span class="annottext">[Set (Name era)]
</span><a href="#local-6989586621680166493"><span class="hs-identifier hs-var">vss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.tails</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era r. Set (Name era) -&gt; Sum era r -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#varsOfSum"><span class="hs-identifier hs-var">varsOfSum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166497"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166494"><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166494"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Set (Name era)]
</span><a href="#local-6989586621680166493"><span class="hs-identifier hs-var">vss</span></a></span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><a href="#local-6989586621680166503"><span class="hs-identifier hs-var">uniqueVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="#local-6989586621680166504"><span class="hs-identifier hs-type">sumCKnownSets</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167422"><span class="annot"><a href="#local-6989586621680167422"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Classes.html#Adds"><span class="hs-identifier hs-type">Adds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167422"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621680167422"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167422"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-443"></span><span>      </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167468"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621680166504"><span class="annot"><span class="annottext">sumCKnownSets :: forall c.
(Adds c, Arbitrary c) =&gt;
Rep era c -&gt; Bool -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166504"><span class="hs-identifier hs-var hs-var">sumCKnownSets</span></a></span></span><span> </span><span id="local-6989586621680166464"><span class="annot"><span class="annottext">Rep era c
</span><a href="#local-6989586621680166464"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621680166463"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166463"><span class="hs-identifier hs-var">canBeNegative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; (a -&gt; Bool) -&gt; Gen a
</span><span class="hs-identifier hs-var">suchThat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {era}. Pred era -&gt; Bool
</span><a href="#local-6989586621680166503"><span class="hs-identifier hs-var">uniqueVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166462"><span class="annot"><span class="annottext">genParts :: Depth
-&gt; GenEnv era
-&gt; ([Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166462"><span class="hs-identifier hs-var hs-var">genParts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621680166461"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166461"><span class="hs-identifier hs-var">env0</span></a></span></span><span> </span><span id="local-6989586621680166460"><span class="annot"><span class="annottext">[Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166460"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166460"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166461"><span class="hs-identifier hs-var">env0</span></a></span><span>
</span><span id="line-447"></span><span>          </span><span class="annot"><a href="#local-6989586621680166462"><span class="hs-identifier hs-var">genParts</span></a></span><span> </span><span id="local-6989586621680166459"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166459"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680166458"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166458"><span class="hs-identifier hs-var">env0</span></a></span></span><span> </span><span id="local-6989586621680166457"><span class="annot"><span class="annottext">[Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166457"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>            </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166446"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166446"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var">genKeyType</span></a></span><span>
</span><span id="line-449"></span><span>            </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166458"><span class="hs-identifier hs-var">env0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166446"><span class="hs-identifier hs-var">krep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era c
</span><a href="#local-6989586621680166464"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166445"><span class="annot"><span class="annottext">Term era (Map t c)
</span><a href="#local-6989586621680166445"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621680166444"><span class="annot"><span class="annottext">Map t c
</span><a href="#local-6989586621680166444"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166443"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166443"><span class="hs-identifier hs-var">env1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>              </span><span class="annot"><span class="annottext">Depth
-&gt; GenEnv era
-&gt; ([Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166462"><span class="hs-identifier hs-var">genParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166459"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166443"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166442"><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166442"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span id="local-6989586621680166441"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166441"><span class="hs-identifier hs-var">tot</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>                </span><span class="annot"><span class="annottext">[Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166457"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c era t. Adds c =&gt; Term era (Map t c) -&gt; Sum era c
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map t c)
</span><a href="#local-6989586621680166445"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166442"><span class="hs-identifier hs-var">parts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Adds x =&gt; x -&gt; x -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) c. (Foldable t, Adds c) =&gt; t c -&gt; c
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#sumAdds"><span class="hs-identifier hs-var">sumAdds</span></a></span><span> </span><span class="annot"><span class="annottext">Map t c
</span><a href="#local-6989586621680166444"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166441"><span class="hs-identifier hs-var">tot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>      </span><span id="local-6989586621680166439"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166439"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><span class="annottext">Depth
-&gt; GenEnv era
-&gt; ([Sum era c] -&gt; c -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166462"><span class="hs-identifier hs-var">genParts</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166439"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166437"><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166437"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span id="local-6989586621680166436"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166436"><span class="hs-identifier hs-var">tot</span></a></span></span><span> </span><span id="local-6989586621680166435"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166435"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-454"></span><span>        </span><span id="local-6989586621680166434"><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166434"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#EQL"><span class="hs-identifier hs-var">EQL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#LTE"><span class="hs-identifier hs-var">LTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#GTH"><span class="hs-identifier hs-var">GTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#GTE"><span class="hs-identifier hs-var">GTE</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OrdCond
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#LTH"><span class="hs-identifier hs-var">LTH</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166463"><span class="hs-identifier hs-var">canBeNegative</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- TODO/negativeCoin</span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166429"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166429"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era c. GenEnv era -&gt; Sum era c -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOfSum"><span class="hs-identifier hs-var">depthOfSum</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166435"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166437"><span class="hs-identifier hs-var">parts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680166428"><span class="annot"><span class="annottext">Term era c
</span><a href="#local-6989586621680166428"><span class="hs-identifier hs-var">sumTm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166427"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166427"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-457"></span><span>          </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-458"></span><span>            </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166435"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-459"></span><span>            </span><span class="annot"><span class="annottext">Rep era c
</span><a href="#local-6989586621680166464"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-460"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Ord c =&gt; OrdCond -&gt; c -&gt; c -&gt; Bool
</span><a href="Test.Cardano.Ledger.Constrained.Size.html#runOrdCond"><span class="hs-identifier hs-var">runOrdCond</span></a></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166434"><span class="hs-identifier hs-var">cmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166436"><span class="hs-identifier hs-var">tot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. (Arbitrary c, Adds c) =&gt; OrdCond -&gt; Bool -&gt; c -&gt; Gen c
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genFromOrdCond"><span class="hs-identifier hs-var">genFromOrdCond</span></a></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166434"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166463"><span class="hs-identifier hs-var">canBeNegative</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680166436"><span class="hs-identifier hs-var">tot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166429"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621680166426"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166426"><span class="hs-identifier hs-var">small</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall x. Adds x =&gt; Gen Depth
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#genSmall"><span class="hs-identifier hs-var">genSmall</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680167422"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-464"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era.
Adds t =&gt;
t -&gt; Term era t -&gt; OrdCond -&gt; [Sum era t] -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumsTo"><span class="hs-identifier hs-var">SumsTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x. Adds x =&gt; [String] -&gt; Depth -&gt; x
</span><a href="Test.Cardano.Ledger.Constrained.Classes.html#fromI"><span class="hs-identifier hs-var">fromI</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166426"><span class="hs-identifier hs-var">small</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term era c
</span><a href="#local-6989586621680166428"><span class="hs-identifier hs-var">sumTm</span></a></span><span> </span><span class="annot"><span class="annottext">OrdCond
</span><a href="#local-6989586621680166434"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">[Sum era c]
</span><a href="#local-6989586621680166437"><span class="hs-identifier hs-var">parts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (Name era) -&gt; Depth -&gt; GenEnv era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#markSolved"><span class="hs-identifier hs-var">markSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Set (Name era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#vars"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Term era c
</span><a href="#local-6989586621680166428"><span class="hs-identifier hs-var">sumTm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166429"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166427"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621680166672"><span class="annot"><span class="annottext">hasDomC :: Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166672"><span class="hs-identifier hs-var hs-var">hasDomC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><span class="annottext">forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-comment">-- Known map</span><span>
</span><span id="line-470"></span><span>            </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166421"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166421"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var">genKeyType</span></a></span><span>
</span><span id="line-471"></span><span>            </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166405"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166405"><span class="hs-identifier hs-var">vrep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-472"></span><span>            </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166421"><span class="hs-identifier hs-var">krep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166405"><span class="hs-identifier hs-var">vrep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166404"><span class="annot"><span class="annottext">Term era (Map t t)
</span><a href="#local-6989586621680166404"><span class="hs-identifier hs-var">mapTm</span></a></span></span><span> </span><span id="local-6989586621680166403"><span class="annot"><span class="annottext">Map t t
</span><a href="#local-6989586621680166403"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166402"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166402"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-473"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166401"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166401"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166402"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map t t)
</span><a href="#local-6989586621680166404"><span class="hs-identifier hs-var">mapTm</span></a></span><span>
</span><span id="line-474"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680166400"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166400"><span class="hs-identifier hs-var">domTm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166399"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166399"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-475"></span><span>                </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-476"></span><span>                  </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166402"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-477"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166421"><span class="hs-identifier hs-var">krep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map t t
</span><a href="#local-6989586621680166403"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map t t
</span><a href="#local-6989586621680166403"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166401"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s. Ord t =&gt; Term era (Map t s) -&gt; Term era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map t t)
</span><a href="#local-6989586621680166404"><span class="hs-identifier hs-var">mapTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era. Eq t =&gt; Term era t -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166400"><span class="hs-identifier hs-var">domTm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166399"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-483"></span><span>            </span><span class="hs-comment">-- Known domain</span><span>
</span><span id="line-484"></span><span>            </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166394"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166394"><span class="hs-identifier hs-var">krep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genKeyType"><span class="hs-identifier hs-var">genKeyType</span></a></span><span>
</span><span id="line-485"></span><span>            </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TypeInEra"><span class="hs-identifier hs-type">TypeInEra</span></a></span><span> </span><span id="local-6989586621680166379"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166379"><span class="hs-identifier hs-var">vrep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Gen (TypeInEra era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genValType"><span class="hs-identifier hs-var">genValType</span></a></span><span>
</span><span id="line-486"></span><span>            </span><span class="annot"><span class="annottext">forall t.
Gen (Term era t, GenEnv era)
-&gt; (Term era t -&gt; t -&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era))
-&gt; Gen (Pred era, GenEnv era)
</span><a href="#local-6989586621680166671"><span class="hs-identifier hs-var">withValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era -&gt; Rep era t -&gt; VarSpec -&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era. Ord t =&gt; Rep era t -&gt; Rep era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166394"><span class="hs-identifier hs-var">krep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#KnownTerm"><span class="hs-identifier hs-var">KnownTerm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166378"><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166378"><span class="hs-identifier hs-var">domTm</span></a></span></span><span> </span><span id="local-6989586621680166377"><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166377"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680166376"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166376"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-487"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166375"><span class="annot"><span class="annottext">d :: Depth
</span><a href="#local-6989586621680166375"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. GenEnv era -&gt; Term era t -&gt; Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#depthOf"><span class="hs-identifier hs-var">depthOf</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166376"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166378"><span class="hs-identifier hs-var">domTm</span></a></span><span>
</span><span id="line-488"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680166374"><span class="annot"><span class="annottext">Term era (Map t t)
</span><a href="#local-6989586621680166374"><span class="hs-identifier hs-var">mapTm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166373"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166373"><span class="hs-identifier hs-var">env''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-489"></span><span>                </span><span class="annot"><span class="annottext">forall era t.
Era era =&gt;
GenEnv era
-&gt; Rep era t
-&gt; (t -&gt; Bool)
-&gt; Gen t
-&gt; VarSpec
-&gt; Gen (Term era t, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genTerm%27"><span class="hs-identifier hs-var">genTerm'</span></a></span><span>
</span><span id="line-490"></span><span>                  </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166376"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-491"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t era s.
Ord t =&gt;
Rep era t -&gt; Rep era s -&gt; Rep era (Map t s)
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166394"><span class="hs-identifier hs-var">krep</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166379"><span class="hs-identifier hs-var">vrep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166377"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era v k.
Era era =&gt;
GenEnv era -&gt; Rep era v -&gt; Set k -&gt; Gen (Map k v)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genMapLiteralWithDom"><span class="hs-identifier hs-var">genMapLiteralWithDom</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166679"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166379"><span class="hs-identifier hs-var">vrep</span></a></span><span> </span><span class="annot"><span class="annottext">Set t
</span><a href="#local-6989586621680166377"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth -&gt; VarSpec
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#VarTerm"><span class="hs-identifier hs-var">VarTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166375"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term era (Set t)
</span><a href="#local-6989586621680166378"><span class="hs-identifier hs-var">domTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era. Eq t =&gt; Term era t -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era s. Ord t =&gt; Term era (Map t s) -&gt; Term era (Set t)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Dom"><span class="hs-identifier hs-var">Dom</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map t t)
</span><a href="#local-6989586621680166374"><span class="hs-identifier hs-var">mapTm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166373"><span class="hs-identifier hs-var">env''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span id="local-6989586621680167406"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#genPreds"><span class="hs-identifier hs-type">genPreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167406"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167406"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167406"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167406"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-499"></span><span id="genPreds"><span class="annot"><span class="annottext">genPreds :: forall era. Era era =&gt; GenEnv era -&gt; Gen ([Pred era], GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genPreds"><span class="hs-identifier hs-var hs-var">genPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166363"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166363"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621680166362"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166362"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">forall {t} {era}.
(Num t, Era era, Eq t) =&gt;
t -&gt; GenEnv era -&gt; Gen ([Pred era], GenEnv era)
</span><a href="#local-6989586621680166361"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166362"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166363"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621680166361"><span class="annot"><span class="annottext">loop :: t -&gt; GenEnv era -&gt; Gen ([Pred era], GenEnv era)
</span><a href="#local-6989586621680166361"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621680166348"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166348"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680166347"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166347"><span class="hs-identifier hs-var">env</span></a></span></span><span>
</span><span id="line-504"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166348"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166347"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-506"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680166346"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166346"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166345"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166345"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; GenEnv era -&gt; Gen (Pred era, GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genPredicate"><span class="hs-identifier hs-var">genPredicate</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166347"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-507"></span><span>          </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166346"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; GenEnv era -&gt; Gen ([Pred era], GenEnv era)
</span><a href="#local-6989586621680166361"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166348"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166345"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span id="local-6989586621680167400"><span id="local-6989586621680167401"><span id="local-6989586621680167402"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-type">withEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167402"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167401"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167401"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167400"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-510"></span><span id="withEq"><span class="annot"><span class="annottext">withEq :: forall era t a. Rep era t -&gt; (Eq t =&gt; a) -&gt; Maybe a
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var hs-var">withEq</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-type">SetR</span></a></span><span> </span><span id="local-6989586621680166340"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166340"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166339"><span class="annot"><span class="annottext">Eq t =&gt; a
</span><a href="#local-6989586621680166339"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t a. Rep era t -&gt; (Eq t =&gt; a) -&gt; Maybe a
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166340"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Eq t =&gt; a
</span><a href="#local-6989586621680166339"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-511"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-type">MapR</span></a></span><span> </span><span id="local-6989586621680166330"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166330"><span class="hs-identifier hs-var">kr</span></a></span></span><span> </span><span id="local-6989586621680166329"><span class="annot"><span class="annottext">Rep era b
</span><a href="#local-6989586621680166329"><span class="hs-identifier hs-var">vr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166328"><span class="annot"><span class="annottext">Eq t =&gt; a
</span><a href="#local-6989586621680166328"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t a. Rep era t -&gt; (Eq t =&gt; a) -&gt; Maybe a
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166330"><span class="hs-identifier hs-var">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t a. Rep era t -&gt; (Eq t =&gt; a) -&gt; Maybe a
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era b
</span><a href="#local-6989586621680166329"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Eq t =&gt; a
</span><a href="#local-6989586621680166328"><span class="hs-identifier hs-var">cont</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span> </span><span id="local-6989586621680166320"><span class="annot"><span class="annottext">Eq t =&gt; a
</span><a href="#local-6989586621680166320"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Eq t =&gt; a
</span><a href="#local-6989586621680166320"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-513"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Eq t =&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- We can't drop constraints due to dependency limitations. There needs to be at least one</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- constraint to solve each variable. We can replace constraints by Random though!</span><span>
</span><span id="line-517"></span><span id="local-6989586621680167389"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#shrinkPreds"><span class="hs-identifier hs-type">shrinkPreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167389"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167389"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167389"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167389"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-518"></span><span id="shrinkPreds"><span class="annot"><span class="annottext">shrinkPreds :: forall era. ([Pred era], GenEnv era) -&gt; [([Pred era], GenEnv era)]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#shrinkPreds"><span class="hs-identifier hs-var hs-var">shrinkPreds</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166301"><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166301"><span class="hs-identifier hs-var">preds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166300"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166300"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166299"><span class="hs-identifier hs-var">preds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166298"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680166299"><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166299"><span class="hs-identifier hs-var">preds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; [a]) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">shrinkList</span></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166296"><span class="hs-identifier hs-var">shrinkPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166301"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166295"><span class="annot"><span class="annottext">defined :: Set (Name era)
</span><a href="#local-6989586621680166295"><span class="hs-identifier hs-var hs-var">defined</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166299"><span class="hs-identifier hs-var">preds'</span></a></span><span>
</span><span id="line-522"></span><span>        </span><span id="local-6989586621680166298"><span class="annot"><span class="annottext">env' :: GenEnv era
</span><a href="#local-6989586621680166298"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166300"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gEnv :: Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {era} {era}. Set (Name era) -&gt; Env era -&gt; Env era
</span><a href="#local-6989586621680166293"><span class="hs-identifier hs-var">pruneEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166295"><span class="hs-identifier hs-var">defined</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166300"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (Name era) -&gt; [Pred era] -&gt; Bool
</span><a href="#local-6989586621680166292"><span class="hs-identifier hs-var">depCheck</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166299"><span class="hs-identifier hs-var">preds'</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-comment">-- Shrink to a Random constraint defining the same variables. The makes sure we respect the</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">-- OrderInfo.</span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621680166296"><span class="annot"><span class="annottext">shrinkPred :: Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166296"><span class="hs-identifier hs-var hs-var">shrinkPred</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="#local-6989586621680166296"><span class="hs-identifier hs-var">shrinkPred</span></a></span><span> </span><span id="local-6989586621680166290"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166290"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred era -&gt; Pred era -&gt; Bool
</span><a href="#local-6989586621680166289"><span class="hs-identifier hs-var">checkDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166290"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166288"><span class="hs-identifier hs-var">shrinkToValue</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166290"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall {era}. Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166287"><span class="hs-identifier hs-var">shrinkToRandom</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166290"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621680166289"><span class="annot"><span class="annottext">checkDefs :: Pred era -&gt; Pred era -&gt; Bool
</span><a href="#local-6989586621680166289"><span class="hs-identifier hs-var hs-var">checkDefs</span></a></span></span><span> </span><span id="local-6989586621680166286"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166286"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span id="local-6989586621680166285"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166285"><span class="hs-identifier hs-var">shrunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166286"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166285"><span class="hs-identifier hs-var">shrunk</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166285"><span class="hs-identifier hs-var">shrunk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621680166288"><span class="annot"><span class="annottext">shrinkToValue :: Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166288"><span class="hs-identifier hs-var hs-var">shrinkToValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-type">:=:</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="#local-6989586621680166288"><span class="hs-identifier hs-var">shrinkToValue</span></a></span><span> </span><span id="local-6989586621680166282"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166282"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-535"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166281"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-536"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621680166280"><span class="annot"><span class="annottext">x :: V era t
</span><a href="#local-6989586621680166280"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680166279"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166279"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Access era s t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166282"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-537"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680166278"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166278"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall x. Typed x -&gt; Either [String] x
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#runTyped"><span class="hs-identifier hs-var">runTyped</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Env era -&gt; Term era t -&gt; Typed t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166300"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680166280"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680166281"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166281"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era t a. Rep era t -&gt; (Eq t =&gt; a) -&gt; Maybe a
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#withEq"><span class="hs-identifier hs-var">withEq</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166279"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166279"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166278"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall t era. Eq t =&gt; Term era t -&gt; Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. V era t -&gt; Term era t
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">V era t
</span><a href="#local-6989586621680166280"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-539"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>    </span><span id="local-6989586621680166287"><span class="annot"><span class="annottext">shrinkToRandom :: Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166287"><span class="hs-identifier hs-var hs-var">shrinkToRandom</span></a></span></span><span> </span><span id="local-6989586621680166275"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166275"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166274"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680166274"><span class="annot"><span class="annottext">r :: Pred era
</span><a href="#local-6989586621680166274"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {era}. Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166273"><span class="hs-identifier hs-var">randoms</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166275"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621680166273"><span class="annot"><span class="annottext">randoms :: Pred era -&gt; [Pred era]
</span><a href="#local-6989586621680166273"><span class="hs-identifier hs-var hs-var">randoms</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span id="local-6989586621680166271"><span class="annot"><span class="annottext">Term era Size
</span><a href="#local-6989586621680166271"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680166270"><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166270"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era Size
</span><a href="#local-6989586621680166271"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166270"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><a href="#local-6989586621680166273"><span class="hs-identifier hs-var">randoms</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166268"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Subset"><span class="hs-operator hs-type">`Subset`</span></a></span><span> </span><span id="local-6989586621680166267"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166267"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166267"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><a href="#local-6989586621680166273"><span class="hs-identifier hs-var">randoms</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166265"><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166265"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-type">:=:</span></a></span><span> </span><span id="local-6989586621680166264"><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166264"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166265"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166264"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-546"></span><span>    </span><span class="annot"><a href="#local-6989586621680166273"><span class="hs-identifier hs-var">randoms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Disjoint"><span class="hs-identifier hs-type">Disjoint</span></a></span><span> </span><span id="local-6989586621680166262"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166262"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680166261"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166261"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166262"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; Pred era
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-var">Random</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166261"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="#local-6989586621680166273"><span class="hs-identifier hs-var">randoms</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621680166293"><span class="annot"><span class="annottext">pruneEnv :: Set (Name era) -&gt; Env era -&gt; Env era
</span><a href="#local-6989586621680166293"><span class="hs-identifier hs-var hs-var">pruneEnv</span></a></span></span><span> </span><span id="local-6989586621680166257"><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166257"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span id="local-6989586621680166256"><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680166256"><span class="hs-identifier hs-var">vmap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Map String (Payload era) -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filterWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680166254"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166254"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Payload era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166254"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621680166252"><span class="hs-identifier hs-var">defNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680166256"><span class="hs-identifier hs-var">vmap</span></a></span><span>
</span><span id="line-550"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>        </span><span id="local-6989586621680166252"><span class="annot"><span class="annottext">defNames :: Set String
</span><a href="#local-6989586621680166252"><span class="hs-identifier hs-var hs-var">defNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621680166250"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166250"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Access era s t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166250"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166257"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621680166292"><span class="annot"><span class="annottext">depCheck :: Set (Name era) -&gt; [Pred era] -&gt; Bool
</span><a href="#local-6989586621680166292"><span class="hs-identifier hs-var hs-var">depCheck</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="#local-6989586621680166292"><span class="hs-identifier hs-var">depCheck</span></a></span><span> </span><span id="local-6989586621680166249"><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166249"><span class="hs-identifier hs-var">solved</span></a></span></span><span> </span><span id="local-6989586621680166248"><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166248"><span class="hs-identifier hs-var">preds'</span></a></span></span><span>
</span><span id="line-555"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166247"><span class="hs-identifier hs-var">rdy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-556"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Name era) -&gt; [Pred era] -&gt; Bool
</span><a href="#local-6989586621680166292"><span class="hs-identifier hs-var">depCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166247"><span class="hs-identifier hs-var">rdy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166249"><span class="hs-identifier hs-var">solved</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166246"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-557"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680166247"><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166247"><span class="hs-identifier hs-var">rdy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166246"><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166246"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.partition</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Bool
</span><a href="#local-6989586621680166244"><span class="hs-identifier hs-var">canSolve</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred era]
</span><a href="#local-6989586621680166248"><span class="hs-identifier hs-var">preds'</span></a></span><span>
</span><span id="line-559"></span><span>        </span><span id="local-6989586621680166244"><span class="annot"><span class="annottext">canSolve :: Pred era -&gt; Bool
</span><a href="#local-6989586621680166244"><span class="hs-identifier hs-var hs-var">canSolve</span></a></span></span><span> </span><span id="local-6989586621680166243"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166243"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.isSubsetOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166242"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166243"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Name era)
</span><a href="#local-6989586621680166249"><span class="hs-identifier hs-var">solved</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621680166241"><span class="annot"><span class="annottext">deps :: Pred era -&gt; Map (Name era) (Set (Name era))
</span><a href="#local-6989586621680166241"><span class="hs-identifier hs-var hs-var">deps</span></a></span></span><span> </span><span id="local-6989586621680166240"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166240"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
OrderInfo
-&gt; Map (Name era) (Set (Name era))
-&gt; Pred era
-&gt; Map (Name era) (Set (Name era))
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#accumdep"><span class="hs-identifier hs-var">accumdep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gOrder"><span class="hs-identifier hs-var">gOrder</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621680166300"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166240"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span id="local-6989586621680166294"><span class="annot"><span class="annottext">def :: Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166294"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Map (Name era) (Set (Name era))
</span><a href="#local-6989586621680166241"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621680166242"><span class="annot"><span class="annottext">use :: Pred era -&gt; Set (Name era)
</span><a href="#local-6989586621680166242"><span class="hs-identifier hs-var hs-var">use</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era -&gt; Map (Name era) (Set (Name era))
</span><a href="#local-6989586621680166241"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-comment">-- Tests ---</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-keyword">type</span><span> </span><span id="TestEra"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TestEra"><span class="hs-identifier hs-var">TestEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Standard"><span class="hs-identifier hs-type">Standard</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#testProof"><span class="hs-identifier hs-type">testProof</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TestEra"><span class="hs-identifier hs-type">TestEra</span></a></span><span>
</span><span id="line-570"></span><span id="testProof"><span class="annot"><span class="annottext">testProof :: Proof TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#testProof"><span class="hs-identifier hs-var hs-var">testProof</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Crypto t =&gt; Evidence t -&gt; Proof (ShelleyEra t)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Standard
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Standard"><span class="hs-identifier hs-var">Standard</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#testEnv"><span class="hs-identifier hs-type">testEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TestEra"><span class="hs-identifier hs-type">TestEra</span></a></span><span>
</span><span id="line-573"></span><span id="testEnv"><span class="annot"><span class="annottext">testEnv :: Env TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#testEnv"><span class="hs-identifier hs-var hs-var">testEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Map String (Payload era) -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era t s. Rep era t -&gt; t -&gt; Access era s t -&gt; Payload era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#Payload"><span class="hs-identifier hs-var">Payload</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Rep era Coin
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#CoinR"><span class="hs-identifier hs-var">CoinR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era s t. Access era s t
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#No"><span class="hs-identifier hs-var">No</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span id="local-6989586621680167358"><span id="local-6989586621680167359"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureRight"><span class="hs-identifier hs-type">ensureRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680167359"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621680167358"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680167358"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167359"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span></span><span>
</span><span id="line-576"></span><span id="ensureRight"><span class="annot"><span class="annottext">ensureRight :: forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureRight"><span class="hs-identifier hs-var hs-var">ensureRight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680166230"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166230"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166230"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-577"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureRight"><span class="hs-identifier hs-var">ensureRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680166227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166227"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166226"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621680166226"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621680166226"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166227"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span id="local-6989586621680166223"><span id="local-6989586621680166224"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifRight"><span class="hs-identifier hs-type">ifRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680166224"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621680166223"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680166223"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680166224"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span></span><span>
</span><span id="line-580"></span><span id="ifRight"><span class="annot"><span class="annottext">ifRight :: forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifRight"><span class="hs-identifier hs-var hs-var">ifRight</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; Bool -&gt; prop -&gt; Property
</span><span class="hs-operator hs-var">==&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-581"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifRight"><span class="hs-identifier hs-var">ifRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680166217"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166217"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166216"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621680166216"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621680166216"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166217"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span id="local-6989586621680167349"><span id="local-6989586621680167350"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureTyped"><span class="hs-identifier hs-type">ensureTyped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680167350"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Monad.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680167349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167350"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span></span><span>
</span><span id="line-584"></span><span id="ensureTyped"><span class="annot"><span class="annottext">ensureTyped :: forall prop a. Testable prop =&gt; Typed a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureTyped"><span class="hs-identifier hs-var hs-var">ensureTyped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureRight"><span class="hs-identifier hs-var">ensureRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Typed x -&gt; Either [String] x
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#runTyped"><span class="hs-identifier hs-var">runTyped</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span id="local-6989586621680166211"><span id="local-6989586621680166212"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifTyped"><span class="hs-identifier hs-type">ifTyped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680166212"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Monad.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680166211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680166212"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span></span><span>
</span><span id="line-587"></span><span id="ifTyped"><span class="annot"><span class="annottext">ifTyped :: forall prop a. Testable prop =&gt; Typed a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifTyped"><span class="hs-identifier hs-var hs-var">ifTyped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifRight"><span class="hs-identifier hs-var">ifRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Typed x -&gt; Either [String] x
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#runTyped"><span class="hs-identifier hs-var">runTyped</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#initEnv"><span class="hs-identifier hs-type">initEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#OrderInfo"><span class="hs-identifier hs-type">OrderInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TestEra"><span class="hs-identifier hs-type">TestEra</span></a></span><span>
</span><span id="line-590"></span><span id="initEnv"><span class="annot"><span class="annottext">initEnv :: OrderInfo -&gt; GenEnv TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#initEnv"><span class="hs-identifier hs-var hs-var">initEnv</span></a></span></span><span> </span><span id="local-6989586621680166206"><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166206"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-591"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gOrder :: OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gOrder"><span class="hs-identifier hs-var">gOrder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166206"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-593"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gEnv :: Env TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Env era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#emptyEnv"><span class="hs-identifier hs-var">emptyEnv</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gSolved :: Map (Name TestEra) Depth
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gSolved"><span class="hs-identifier hs-var">gSolved</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span id="local-6989586621680167342"><span id="local-6989586621680167343"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showVal"><span class="hs-identifier hs-type">showVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#Rep"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167343"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167342"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680167342"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span></span><span>
</span><span id="line-598"></span><span id="showVal"><span class="annot"><span class="annottext">showVal :: forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showVal"><span class="hs-identifier hs-var hs-var">showVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#SetR"><span class="hs-identifier hs-type">SetR</span></a></span><span> </span><span id="local-6989586621680166198"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166198"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166197"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166197"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#synopsis"><span class="hs-identifier hs-var">synopsis</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166198"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166197"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showVal"><span class="hs-identifier hs-var">showVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#MapR"><span class="hs-identifier hs-type">MapR</span></a></span><span> </span><span id="local-6989586621680166189"><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166189"><span class="hs-identifier hs-var">kr</span></a></span></span><span> </span><span id="local-6989586621680166188"><span class="annot"><span class="annottext">Rep era b
</span><a href="#local-6989586621680166188"><span class="hs-identifier hs-var">vr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166187"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166187"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#synopsis"><span class="hs-identifier hs-var">synopsis</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era a
</span><a href="#local-6989586621680166189"><span class="hs-identifier hs-var">kr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166186"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#synopsis"><span class="hs-identifier hs-var">synopsis</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era b
</span><a href="#local-6989586621680166188"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680166185"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166186"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166186"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166185"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680166185"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166187"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-600"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showVal"><span class="hs-identifier hs-var">showVal</span></a></span><span> </span><span id="local-6989586621680166184"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166184"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621680166183"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166183"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.TypeRep.html#synopsis"><span class="hs-identifier hs-var">synopsis</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166184"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166183"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span id="local-6989586621680167334"><span id="local-6989586621680167335"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-type">showTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167335"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167334"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span></span><span>
</span><span id="line-603"></span><span id="showTerm"><span class="annot"><span class="annottext">showTerm :: forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var hs-var">showTerm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621680166179"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166179"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621680166178"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166178"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showVal"><span class="hs-identifier hs-var">showVal</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166179"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166178"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-604"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span id="local-6989586621680166173"><span class="annot"><span class="annottext">Term era (Map a b)
</span><a href="#local-6989586621680166173"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Dom &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map a b)
</span><a href="#local-6989586621680166173"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-605"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Rng"><span class="hs-identifier hs-type">Rng</span></a></span><span> </span><span id="local-6989586621680166167"><span class="annot"><span class="annottext">Term era (Map a b)
</span><a href="#local-6989586621680166167"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Rng &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Map a b)
</span><a href="#local-6989586621680166167"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-606"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span id="local-6989586621680166166"><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166166"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Term era t
</span><a href="#local-6989586621680166166"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span id="local-6989586621680167325"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-type">showPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167325"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span><span>
</span><span id="line-609"></span><span id="showPred"><span class="annot"><span class="annottext">showPred :: forall era. Pred era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-var hs-var">showPred</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166161"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166161"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Subset"><span class="hs-operator hs-type">`Subset`</span></a></span><span> </span><span id="local-6989586621680166160"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166160"><span class="hs-identifier hs-var">sup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166161"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &#8838; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166160"><span class="hs-identifier hs-var">sup</span></a></span><span>
</span><span id="line-610"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-var">showPred</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166157"><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166157"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-type">:=:</span></a></span><span> </span><span id="local-6989586621680166156"><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166156"><span class="hs-identifier hs-var">sup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166157"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; == &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era a
</span><a href="#local-6989586621680166156"><span class="hs-identifier hs-var">sup</span></a></span><span>
</span><span id="line-611"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-var">showPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Disjoint"><span class="hs-identifier hs-type">Disjoint</span></a></span><span> </span><span id="local-6989586621680166152"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166152"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680166151"><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166151"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Disjoint &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166152"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Term era t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showTerm"><span class="hs-identifier hs-var">showTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><a href="#local-6989586621680166151"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-612"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-var">showPred</span></a></span><span> </span><span id="local-6989586621680166150"><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166150"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Pred era
</span><a href="#local-6989586621680166150"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span id="local-6989586621680167320"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#showEnv"><span class="hs-identifier hs-type">showEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167320"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span><span>
</span><span id="line-615"></span><span id="showEnv"><span class="annot"><span class="annottext">showEnv :: forall era. Env era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showEnv"><span class="hs-identifier hs-var hs-var">showEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span id="local-6989586621680166148"><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680166148"><span class="hs-identifier hs-var">vmap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {era}. (String, Payload era) -&gt; String
</span><a href="#local-6989586621680166147"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map String (Payload era)
</span><a href="#local-6989586621680166148"><span class="hs-identifier hs-var">vmap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-617"></span><span>    </span><span id="local-6989586621680166147"><span class="annot"><span class="annottext">pr :: (String, Payload era) -&gt; String
</span><a href="#local-6989586621680166147"><span class="hs-identifier hs-var hs-var">pr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680166146"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166146"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Payload"><span class="hs-identifier hs-type">Payload</span></a></span><span> </span><span id="local-6989586621680166140"><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166140"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621680166139"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166139"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Access era s t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166146"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; :: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166140"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era t. Rep era t -&gt; t -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showVal"><span class="hs-identifier hs-var">showVal</span></a></span><span> </span><span class="annot"><span class="annottext">Rep era t
</span><a href="#local-6989586621680166140"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680166139"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span id="local-6989586621680166138"><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-type">predConstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680166138"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span><span>
</span><span id="line-620"></span><span id="predConstr"><span class="annot"><span class="annottext">predConstr :: forall era. Pred era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var hs-var">predConstr</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sized&quot;</span></span><span>
</span><span id="line-621"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term era a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#%3A%3D%3A"><span class="hs-operator hs-type">:=:</span></a></span><span> </span><span class="annot"><span class="annottext">Term era a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:=:&quot;</span></span><span>
</span><span id="line-622"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term era (Set a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Subset"><span class="hs-operator hs-type">`Subset`</span></a></span><span> </span><span class="annot"><span class="annottext">Term era (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Subset&quot;</span></span><span>
</span><span id="line-623"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Disjoint"><span class="hs-identifier hs-type">Disjoint</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Disjoint&quot;</span></span><span>
</span><span id="line-624"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#SumsTo"><span class="hs-identifier hs-type">SumsTo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SumsTo&quot;</span></span><span>
</span><span id="line-625"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Random"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Random&quot;</span></span><span>
</span><span id="line-626"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Component&quot;</span></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#CanFollow"><span class="hs-identifier hs-type">CanFollow</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CanFollow&quot;</span></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="hs-comment">-- | Generate a set of satisfiable constraints and check that we can generate a solution and that it</span><span>
</span><span id="line-630"></span><span class="hs-comment">--   actually satisfies the constraints.</span><span>
</span><span id="line-631"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#prop_soundness"><span class="hs-identifier hs-type">prop_soundness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#OrderInfo"><span class="hs-identifier hs-type">OrderInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-632"></span><span id="prop_soundness"><span class="annot"><span class="annottext">prop_soundness :: OrderInfo -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#prop_soundness"><span class="hs-identifier hs-var hs-var">prop_soundness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [String] -&gt; OrderInfo -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#prop_soundness%27"><span class="hs-identifier hs-var">prop_soundness'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#defaultWhitelist"><span class="hs-identifier hs-type">defaultWhitelist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span id="defaultWhitelist"><span class="annot"><span class="annottext">defaultWhitelist :: [String]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#defaultWhitelist"><span class="hs-identifier hs-var hs-var">defaultWhitelist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Size specifications&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The SetSpec's are inconsistent&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The MapSpec's are inconsistent&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="hs-comment">-- | If argument is True, fail property if constraints cannot be solved. Otherwise discard unsolved</span><span>
</span><span id="line-638"></span><span class="hs-comment">--   constraints.</span><span>
</span><span id="line-639"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#prop_soundness%27"><span class="hs-identifier hs-type">prop_soundness'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#OrderInfo"><span class="hs-identifier hs-type">OrderInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-640"></span><span id="prop_soundness%27"><span class="annot"><span class="annottext">prop_soundness' :: Bool -&gt; [String] -&gt; OrderInfo -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#prop_soundness%27"><span class="hs-identifier hs-var hs-var">prop_soundness'</span></a></span></span><span> </span><span id="local-6989586621680166125"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166125"><span class="hs-identifier hs-var">strict</span></a></span></span><span> </span><span id="local-6989586621680166124"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166124"><span class="hs-identifier hs-var">whitelist</span></a></span></span><span> </span><span id="local-6989586621680166123"><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166123"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-641"></span><span>  </span><span class="annot"><span class="annottext">forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrink</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; GenEnv era -&gt; Gen ([Pred era], GenEnv era)
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#genPreds"><span class="hs-identifier hs-var">genPreds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">OrderInfo -&gt; GenEnv TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#initEnv"><span class="hs-identifier hs-var">initEnv</span></a></span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166123"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era. ([Pred era], GenEnv era) -&gt; [([Pred era], GenEnv era)]
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#shrinkPreds"><span class="hs-identifier hs-var">shrinkPreds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680166121"><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166121"><span class="hs-identifier hs-var">preds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166120"><span class="annot"><span class="annottext">GenEnv TestEra
</span><a href="#local-6989586621680166120"><span class="hs-identifier hs-var">genenv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n-- Order --\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166123"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-643"></span><span>      </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n-- Constraints --\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Pred era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-var">showPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166121"><span class="hs-identifier hs-var">preds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-- Model solution --\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Env era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showEnv"><span class="hs-identifier hs-var">showEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv TestEra
</span><a href="#local-6989586621680166120"><span class="hs-identifier hs-var">genenv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-645"></span><span>          </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; Depth -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">within</span></span><span> </span><span class="annot"><span class="annottext">Depth
</span><span class="hs-number">100000</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-646"></span><span>            </span><span class="annot"><span class="annottext">Typed (DependGraph TestEra)
-&gt; (DependGraph TestEra -&gt; Property) -&gt; Property
</span><a href="#local-6989586621680166118"><span class="hs-identifier hs-var">checkTyped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. OrderInfo -&gt; [Pred era] -&gt; Typed (DependGraph era)
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166123"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166121"><span class="hs-identifier hs-var">preds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166116"><span class="annot"><span class="annottext">DependGraph TestEra
</span><a href="#local-6989586621680166116"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-647"></span><span>              </span><span class="annot"><span class="annottext">forall prop a. Testable prop =&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllBlind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Bool
-&gt; Proof era
-&gt; DependGraph era
-&gt; Gen (Either [String] (Subst era))
</span><a href="Test.Cardano.Ledger.Constrained.Solver.html#genDependGraph"><span class="hs-identifier hs-var">genDependGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Proof TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#testProof"><span class="hs-identifier hs-var">testProof</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph TestEra
</span><a href="#local-6989586621680166116"><span class="hs-identifier hs-var">graph</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Either [String] (Subst TestEra)
-&gt; (Subst TestEra -&gt; Property) -&gt; Property
</span><a href="#local-6989586621680166113"><span class="hs-identifier hs-var">checkRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680166112"><span class="annot"><span class="annottext">Subst TestEra
</span><a href="#local-6989586621680166112"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-648"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166111"><span class="annot"><span class="annottext">env :: Env TestEra
</span><a href="#local-6989586621680166111"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Typed t -&gt; t
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#errorTyped"><span class="hs-identifier hs-var">errorTyped</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. [SubItem era] -&gt; Env era -&gt; Typed (Env era)
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#substToEnv"><span class="hs-identifier hs-var">substToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Subst TestEra
</span><a href="#local-6989586621680166112"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Env era
</span><a href="Test.Cardano.Ledger.Constrained.Env.html#emptyEnv"><span class="hs-identifier hs-var">emptyEnv</span></a></span><span>
</span><span id="line-649"></span><span>                    </span><span id="local-6989586621680166108"><span class="annot"><span class="annottext">checkPred :: Pred TestEra -&gt; Property
</span><a href="#local-6989586621680166108"><span class="hs-identifier hs-var hs-var">checkPred</span></a></span></span><span> </span><span id="local-6989586621680166107"><span class="annot"><span class="annottext">Pred TestEra
</span><a href="#local-6989586621680166107"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Pred era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showPred"><span class="hs-identifier hs-var">showPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred TestEra
</span><a href="#local-6989586621680166107"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall prop a. Testable prop =&gt; Typed a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ensureTyped"><span class="hs-identifier hs-var">ensureTyped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Env era -&gt; Pred era -&gt; Typed Bool
</span><a href="Test.Cardano.Ledger.Constrained.Ast.html#runPred"><span class="hs-identifier hs-var">runPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env TestEra
</span><a href="#local-6989586621680166111"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Pred TestEra
</span><a href="#local-6989586621680166107"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-650"></span><span>                    </span><span id="local-6989586621680166105"><span class="annot"><span class="annottext">n :: Depth
</span><a href="#local-6989586621680166105"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span id="local-6989586621680166104"><span class="annot"><span class="annottext">Map String (Payload TestEra)
</span><a href="#local-6989586621680166104"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; Env era
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#gEnv"><span class="hs-identifier hs-var">gEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv TestEra
</span><a href="#local-6989586621680166120"><span class="hs-identifier hs-var">genenv</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Depth
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map String (Payload TestEra)
</span><a href="#local-6989586621680166104"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-651"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall prop.
Testable prop =&gt;
String -&gt; [String] -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">tabulate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Var count&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621680166105"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-652"></span><span>                      </span><span class="annot"><span class="annottext">forall prop.
Testable prop =&gt;
String -&gt; [String] -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">tabulate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constraint types&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Pred era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#predConstr"><span class="hs-identifier hs-var">predConstr</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166121"><span class="hs-identifier hs-var">preds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-653"></span><span>                        </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-- Solution --\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Env era -&gt; String
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#showEnv"><span class="hs-identifier hs-var">showEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env TestEra
</span><a href="#local-6989586621680166111"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-654"></span><span>                          </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">conjoin</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-655"></span><span>                            </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Pred TestEra -&gt; Property
</span><a href="#local-6989586621680166108"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166121"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621680166118"><span class="annot"><span class="annottext">checkTyped :: Typed (DependGraph TestEra)
-&gt; (DependGraph TestEra -&gt; Property) -&gt; Property
</span><a href="#local-6989586621680166118"><span class="hs-identifier hs-var hs-var">checkTyped</span></a></span></span><span>
</span><span id="line-658"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166125"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="#local-6989586621680166100"><span class="hs-identifier hs-var">checkWhitelist</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Typed x -&gt; Either [String] x
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#runTyped"><span class="hs-identifier hs-var">runTyped</span></a></span><span>
</span><span id="line-659"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop a. Testable prop =&gt; Typed a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifTyped"><span class="hs-identifier hs-var">ifTyped</span></a></span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621680166113"><span class="annot"><span class="annottext">checkRight :: Either [String] (Subst TestEra)
-&gt; (Subst TestEra -&gt; Property) -&gt; Property
</span><a href="#local-6989586621680166113"><span class="hs-identifier hs-var hs-var">checkRight</span></a></span></span><span>
</span><span id="line-661"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680166125"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="#local-6989586621680166100"><span class="hs-identifier hs-var">checkWhitelist</span></a></span><span>
</span><span id="line-662"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#ifRight"><span class="hs-identifier hs-var">ifRight</span></a></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621680166098"><span id="local-6989586621680166099"><span class="annot"><a href="#local-6989586621680166100"><span class="hs-identifier hs-type">checkWhitelist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680166099"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621680166098"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680166098"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680166099"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span></span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621680166100"><span class="annot"><span class="annottext">checkWhitelist :: forall prop a.
Testable prop =&gt;
Either [String] a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="#local-6989586621680166100"><span class="hs-identifier hs-var hs-var">checkWhitelist</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680166091"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166091"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-667"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166090"><span class="hs-identifier hs-var">white</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166089"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680166090"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166090"><span class="hs-identifier hs-var">white</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166124"><span class="hs-identifier hs-var">whitelist</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680166089"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680166089"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166091"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-671"></span><span>        </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; Bool -&gt; prop -&gt; Property
</span><span class="hs-operator hs-var">==&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680166091"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><a href="#local-6989586621680166100"><span class="hs-identifier hs-var">checkWhitelist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680166088"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166088"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680166087"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621680166087"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621680166087"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680166088"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#runPreds"><span class="hs-identifier hs-type">runPreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Ast.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Constrained.Tests.html#TestEra"><span class="hs-identifier hs-type">TestEra</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span id="runPreds"><span class="annot"><span class="annottext">runPreds :: [Pred TestEra] -&gt; IO ()
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#runPreds"><span class="hs-identifier hs-var hs-var">runPreds</span></a></span></span><span> </span><span id="local-6989586621680166085"><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166085"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680166084"><span class="annot"><span class="annottext">info :: OrderInfo
</span><a href="#local-6989586621680166084"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#standardOrderInfo"><span class="hs-identifier hs-var">standardOrderInfo</span></a></span><span>
</span><span id="line-677"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680166083"><span class="annot"><span class="annottext">DependGraph TestEra
</span><a href="#local-6989586621680166083"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. Typed x -&gt; Either [String] x
</span><a href="Test.Cardano.Ledger.Constrained.Monad.html#runTyped"><span class="hs-identifier hs-var">runTyped</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. OrderInfo -&gt; [Pred era] -&gt; Typed (DependGraph era)
</span><a href="Test.Cardano.Ledger.Constrained.Rewrite.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">OrderInfo
</span><a href="#local-6989586621680166084"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred TestEra]
</span><a href="#local-6989586621680166085"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span id="local-6989586621680166082"><span class="annot"><span class="annottext">Either [String] (Subst TestEra)
</span><a href="#local-6989586621680166082"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; IO a
</span><span class="hs-identifier hs-var">generate</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Bool
-&gt; Proof era
-&gt; DependGraph era
-&gt; Gen (Either [String] (Subst era))
</span><a href="Test.Cardano.Ledger.Constrained.Solver.html#genDependGraph"><span class="hs-identifier hs-var">genDependGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Proof TestEra
</span><a href="Test.Cardano.Ledger.Constrained.Tests.html#testProof"><span class="hs-identifier hs-var">testProof</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph TestEra
</span><a href="#local-6989586621680166083"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-679"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="annot"><span class="annottext">Either [String] (Subst TestEra)
</span><a href="#local-6989586621680166082"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-680"></span></pre></body></html>