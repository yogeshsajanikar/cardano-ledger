<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Ledger.Mary.Value</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier">PolicyID</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier">AssetName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier">MaryValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#insert"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#insertMultiAsset"><span class="hs-identifier">insertMultiAsset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#lookup"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#lookupMultiAsset"><span class="hs-identifier">lookupMultiAsset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#multiAssetFromList"><span class="hs-identifier">multiAssetFromList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#policies"><span class="hs-identifier">policies</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#prune"><span class="hs-identifier">prune</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#representationSize"><span class="hs-identifier">representationSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#showValue"><span class="hs-identifier">showValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#flattenMultiAsset"><span class="hs-identifier">flattenMultiAsset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#valueFromList"><span class="hs-identifier">valueFromList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-identifier">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#isMultiAssetSmallEnough"><span class="hs-identifier">isMultiAssetSmallEnough</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-crypto-class-2.1.0.1-c762b570cf40f8cd35d15c1899429c392d4cc06de39a6636725516f614c3ad0c/share/doc/html/src"><span class="hs-identifier">Cardano.Crypto.Hash.Class</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Hash</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Cardano.Ledger.Binary</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">DecCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Decoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-binary-1.7.0.0-230bde4d56d408343ba7811b72bd5dbe1e17edf84be7e56a2d41cc0efcc4b9e8/share/doc/html/src"><span class="hs-identifier">DecoderError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">EncCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Encoding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier">TokenType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-binary-1.7.0.0-230bde4d56d408343ba7811b72bd5dbe1e17edf84be7e56a2d41cc0efcc4b9e8/share/doc/html/src"><span class="hs-identifier">cborError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">decodeInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">decodeMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">decodeWord64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">ifDecoderVersionAtLeast</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">peekTokenType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Cardano.Ledger.Binary.Coders</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Decode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Encode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">decode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">encode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-operator">(!&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-operator">(&lt;!)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Cardano.Ledger.Binary.Version</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">natVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">CompactForm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">decodePositiveCoin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">integerToWord64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">word64ToCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">ADDRHASH</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier">Cardano.Ledger.TreeDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Expr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">App</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">deepseq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">rwhnf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">assert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">forM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad.ST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">runST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FromJSONKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">object</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToJSONKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toJSONKeyText</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base16</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS16</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Short</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SBS</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Short.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ShortByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SBS</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">Data.CanonicalMaps</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">canonicalMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">canonicalMapUnion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">pointWise</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">foldMap'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Abelian</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Group</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">sortOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Internal</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="hs-identifier">link</span></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="hs-identifier">link2</span></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assocs</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">fromJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Monoid</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Sum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">getSum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Primitive.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeLatin1</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OnlyCheckWhnfNamed</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Asset Name</span><span>
</span><span id="line-110"></span><span class="hs-keyword">newtype</span><span> </span><span id="AssetName"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-var">AssetName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AssetName"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-var">AssetName</span></a></span></span><span> </span><span class="hs-special">{</span><span id="assetName"><span class="annot"><span class="annottext">AssetName -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetName"><span class="hs-identifier hs-var hs-var">assetName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SBS.ShortByteString</span></span><span class="hs-special">}</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679246359"><span id="local-6989586621679246364"><span class="annot"><span class="annottext">AssetName -&gt; AssetName -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AssetName -&gt; AssetName -&gt; Bool
$c/= :: AssetName -&gt; AssetName -&gt; Bool
== :: AssetName -&gt; AssetName -&gt; Bool
$c== :: AssetName -&gt; AssetName -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246338"><span id="local-6989586621679246344"><span id="local-6989586621679246351"><span class="annot"><span class="annottext">Typeable AssetName
AssetName -&gt; Encoding
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [AssetName] -&gt; Size
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy AssetName -&gt; Size
forall a.
Typeable a
-&gt; (a -&gt; Encoding)
-&gt; ((forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy a -&gt; Size)
-&gt; ((forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [a] -&gt; Size)
-&gt; EncCBOR a
encodedListSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [AssetName] -&gt; Size
$cencodedListSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [AssetName] -&gt; Size
encodedSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy AssetName -&gt; Size
$cencodedSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy AssetName -&gt; Size
encCBOR :: AssetName -&gt; Encoding
$cencCBOR :: AssetName -&gt; Encoding
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">EncCBOR</span></a></span></span></span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246305"><span id="local-6989586621679246309"><span id="local-6989586621679246313"><span id="local-6989586621679246317"><span id="local-6989586621679246321"><span id="local-6989586621679246325"><span id="local-6989586621679246330"><span class="annot"><span class="annottext">Eq AssetName
AssetName -&gt; AssetName -&gt; Bool
AssetName -&gt; AssetName -&gt; Ordering
AssetName -&gt; AssetName -&gt; AssetName
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: AssetName -&gt; AssetName -&gt; AssetName
$cmin :: AssetName -&gt; AssetName -&gt; AssetName
max :: AssetName -&gt; AssetName -&gt; AssetName
$cmax :: AssetName -&gt; AssetName -&gt; AssetName
&gt;= :: AssetName -&gt; AssetName -&gt; Bool
$c&gt;= :: AssetName -&gt; AssetName -&gt; Bool
&gt; :: AssetName -&gt; AssetName -&gt; Bool
$c&gt; :: AssetName -&gt; AssetName -&gt; Bool
&lt;= :: AssetName -&gt; AssetName -&gt; Bool
$c&lt;= :: AssetName -&gt; AssetName -&gt; Bool
&lt; :: AssetName -&gt; AssetName -&gt; Bool
$c&lt; :: AssetName -&gt; AssetName -&gt; Bool
compare :: AssetName -&gt; AssetName -&gt; Ordering
$ccompare :: AssetName -&gt; AssetName -&gt; Ordering
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246290"><span id="local-6989586621679246294"><span id="local-6989586621679246299"><span class="annot"><span class="annottext">Context -&gt; AssetName -&gt; IO (Maybe ThunkInfo)
Proxy AssetName -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy AssetName -&gt; String
$cshowTypeOf :: Proxy AssetName -&gt; String
wNoThunks :: Context -&gt; AssetName -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; AssetName -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; AssetName -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; AssetName -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246285"><span class="annot"><span class="annottext">AssetName -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: AssetName -&gt; ()
$crnf :: AssetName -&gt; ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246275"><span id="local-6989586621679246278"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679246271"><span class="annot"><span class="annottext">show :: AssetName -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; ByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToBytesAsHex"><span class="hs-identifier hs-var">assetNameToBytesAsHex</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#assetNameToBytesAsHex"><span class="hs-identifier hs-type">assetNameToBytesAsHex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-123"></span><span id="assetNameToBytesAsHex"><span class="annot"><span class="annottext">assetNameToBytesAsHex :: AssetName -&gt; ByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToBytesAsHex"><span class="hs-identifier hs-var hs-var">assetNameToBytesAsHex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS16.encode</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">SBS.fromShort</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetName"><span class="hs-identifier hs-var">assetName</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#assetNameToTextAsHex"><span class="hs-identifier hs-type">assetNameToTextAsHex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-126"></span><span id="assetNameToTextAsHex"><span class="annot"><span class="annottext">assetNameToTextAsHex :: AssetName -&gt; Text
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToTextAsHex"><span class="hs-identifier hs-var hs-var">assetNameToTextAsHex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeLatin1</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; ByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToBytesAsHex"><span class="hs-identifier hs-var">assetNameToBytesAsHex</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246258"><span id="local-6989586621679246260"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">DecCBOR</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679246241"><span class="annot"><span class="annottext">decCBOR :: forall s. Decoder s AssetName
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">decCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679246239"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679246239"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decCBOR</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int
</span><span class="hs-identifier hs-var">SBS.length</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679246239"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. (MonadFail m, Buildable e) =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-binary-1.7.0.0-230bde4d56d408343ba7811b72bd5dbe1e17edf84be7e56a2d41cc0efcc4b9e8/share/doc/html/src"><span class="hs-identifier hs-var">cborError</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; DecoderError
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-binary-1.7.0.0-230bde4d56d408343ba7811b72bd5dbe1e17edf84be7e56a2d41cc0efcc4b9e8/share/doc/html/src"><span class="hs-identifier hs-var">DecoderErrorCustom</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;asset name exceeds 32 bytes:&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">AssetName -&gt; Text
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToTextAsHex"><span class="hs-identifier hs-var">assetNameToTextAsHex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-136"></span><span>              </span><span class="annot"><span class="annottext">ShortByteString -&gt; AssetName
</span><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-var">AssetName</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679246239"><span class="hs-identifier hs-var">an</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; AssetName
</span><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-var">AssetName</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679246239"><span class="hs-identifier hs-var">an</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Policy ID</span><span>
</span><span id="line-140"></span><span id="local-6989586621679246234"><span id="local-6989586621679246235"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PolicyID"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-var">PolicyID</span></a></span></span><span> </span><span id="local-6989586621679247054"><span class="annot"><a href="#local-6989586621679247054"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PolicyID"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-var">PolicyID</span></a></span></span><span> </span><span class="hs-special">{</span><span id="policyID"><span class="annot"><span class="annottext">forall c. PolicyID c -&gt; ScriptHash c
</span><a href="Cardano.Ledger.Mary.Value.html#policyID"><span class="hs-identifier hs-var hs-var">policyID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247054"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679246223"><span id="local-6989586621679246225"><span id="local-6989586621679246230"><span class="annot"><span class="annottext">Int -&gt; PolicyID c -&gt; ShowS
forall c. Int -&gt; PolicyID c -&gt; ShowS
forall c. [PolicyID c] -&gt; ShowS
forall c. PolicyID c -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PolicyID c] -&gt; ShowS
$cshowList :: forall c. [PolicyID c] -&gt; ShowS
show :: PolicyID c -&gt; String
$cshow :: forall c. PolicyID c -&gt; String
showsPrec :: Int -&gt; PolicyID c -&gt; ShowS
$cshowsPrec :: forall c. Int -&gt; PolicyID c -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246216"><span id="local-6989586621679246221"><span class="annot"><span class="annottext">PolicyID c -&gt; PolicyID c -&gt; Bool
forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PolicyID c -&gt; PolicyID c -&gt; Bool
$c/= :: forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
== :: PolicyID c -&gt; PolicyID c -&gt; Bool
$c== :: forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246184"><span id="local-6989586621679246188"><span id="local-6989586621679246192"><span id="local-6989586621679246196"><span id="local-6989586621679246200"><span id="local-6989586621679246204"><span id="local-6989586621679246209"><span class="annot"><span class="annottext">PolicyID c -&gt; PolicyID c -&gt; Bool
PolicyID c -&gt; PolicyID c -&gt; Ordering
PolicyID c -&gt; PolicyID c -&gt; PolicyID c
forall c. Eq (PolicyID c)
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
forall c. PolicyID c -&gt; PolicyID c -&gt; Ordering
forall c. PolicyID c -&gt; PolicyID c -&gt; PolicyID c
min :: PolicyID c -&gt; PolicyID c -&gt; PolicyID c
$cmin :: forall c. PolicyID c -&gt; PolicyID c -&gt; PolicyID c
max :: PolicyID c -&gt; PolicyID c -&gt; PolicyID c
$cmax :: forall c. PolicyID c -&gt; PolicyID c -&gt; PolicyID c
&gt;= :: PolicyID c -&gt; PolicyID c -&gt; Bool
$c&gt;= :: forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
&gt; :: PolicyID c -&gt; PolicyID c -&gt; Bool
$c&gt; :: forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
&lt;= :: PolicyID c -&gt; PolicyID c -&gt; Bool
$c&lt;= :: forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
&lt; :: PolicyID c -&gt; PolicyID c -&gt; Bool
$c&lt; :: forall c. PolicyID c -&gt; PolicyID c -&gt; Bool
compare :: PolicyID c -&gt; PolicyID c -&gt; Ordering
$ccompare :: forall c. PolicyID c -&gt; PolicyID c -&gt; Ordering
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (PolicyID c) x -&gt; PolicyID c
forall c x. PolicyID c -&gt; Rep (PolicyID c) x
$cto :: forall c x. Rep (PolicyID c) x -&gt; PolicyID c
$cfrom :: forall c x. PolicyID c -&gt; Rep (PolicyID c) x
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246167"><span id="local-6989586621679246171"><span id="local-6989586621679246176"><span class="annot"><span class="annottext">Context -&gt; PolicyID c -&gt; IO (Maybe ThunkInfo)
Proxy (PolicyID c) -&gt; String
forall c. Context -&gt; PolicyID c -&gt; IO (Maybe ThunkInfo)
forall c. Proxy (PolicyID c) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (PolicyID c) -&gt; String
$cshowTypeOf :: forall c. Proxy (PolicyID c) -&gt; String
wNoThunks :: Context -&gt; PolicyID c -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall c. Context -&gt; PolicyID c -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PolicyID c -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall c. Context -&gt; PolicyID c -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679246167"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246163"><span class="annot"><span class="annottext">PolicyID c -&gt; ()
forall c. PolicyID c -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: PolicyID c -&gt; ()
$crnf :: forall c. PolicyID c -&gt; ()
</span><a href="#local-6989586621679246163"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246139"><span id="local-6989586621679246145"><span id="local-6989586621679246152"><span class="annot"><span class="annottext">PolicyID c -&gt; Encoding
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID c] -&gt; Size
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID c) -&gt; Size
forall a.
Typeable a
-&gt; (a -&gt; Encoding)
-&gt; ((forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy a -&gt; Size)
-&gt; ((forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [a] -&gt; Size)
-&gt; EncCBOR a
forall {c}. Crypto c =&gt; Typeable (PolicyID c)
forall c. Crypto c =&gt; PolicyID c -&gt; Encoding
forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID c] -&gt; Size
forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID c) -&gt; Size
encodedListSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID c] -&gt; Size
$cencodedListSizeExpr :: forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [PolicyID c] -&gt; Size
encodedSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID c) -&gt; Size
$cencodedSizeExpr :: forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (PolicyID c) -&gt; Size
encCBOR :: PolicyID c -&gt; Encoding
$cencCBOR :: forall c. Crypto c =&gt; PolicyID c -&gt; Encoding
</span><a href="#local-6989586621679246139"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">EncCBOR</span></a></span></span></span></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246120"><span id="local-6989586621679246124"><span id="local-6989586621679246129"><span class="annot"><span class="annottext">Proxy (PolicyID c) -&gt; Text
forall s. Decoder s (PolicyID c)
forall a.
Typeable a
-&gt; (forall s. Decoder s a)
-&gt; (forall s. Proxy a -&gt; Decoder s ())
-&gt; (Proxy a -&gt; Text)
-&gt; DecCBOR a
forall s. Proxy (PolicyID c) -&gt; Decoder s ()
forall {c}. Crypto c =&gt; Typeable (PolicyID c)
forall c. Crypto c =&gt; Proxy (PolicyID c) -&gt; Text
forall c s. Crypto c =&gt; Decoder s (PolicyID c)
forall c s. Crypto c =&gt; Proxy (PolicyID c) -&gt; Decoder s ()
label :: Proxy (PolicyID c) -&gt; Text
$clabel :: forall c. Crypto c =&gt; Proxy (PolicyID c) -&gt; Text
dropCBOR :: forall s. Proxy (PolicyID c) -&gt; Decoder s ()
$cdropCBOR :: forall c s. Crypto c =&gt; Proxy (PolicyID c) -&gt; Decoder s ()
decCBOR :: forall s. Decoder s (PolicyID c)
$cdecCBOR :: forall c s. Crypto c =&gt; Decoder s (PolicyID c)
</span><a href="#local-6989586621679246120"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">DecCBOR</span></a></span></span></span></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246101"><span id="local-6989586621679246105"><span id="local-6989586621679246109"><span id="local-6989586621679246114"><span class="annot"><span class="annottext">[PolicyID c] -&gt; Value
[PolicyID c] -&gt; Encoding
PolicyID c -&gt; Value
PolicyID c -&gt; Encoding
forall c. Crypto c =&gt; [PolicyID c] -&gt; Value
forall c. Crypto c =&gt; [PolicyID c] -&gt; Encoding
forall c. Crypto c =&gt; PolicyID c -&gt; Value
forall c. Crypto c =&gt; PolicyID c -&gt; Encoding
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [PolicyID c] -&gt; Encoding
$ctoEncodingList :: forall c. Crypto c =&gt; [PolicyID c] -&gt; Encoding
toJSONList :: [PolicyID c] -&gt; Value
$ctoJSONList :: forall c. Crypto c =&gt; [PolicyID c] -&gt; Value
toEncoding :: PolicyID c -&gt; Encoding
$ctoEncoding :: forall c. Crypto c =&gt; PolicyID c -&gt; Encoding
toJSON :: PolicyID c -&gt; Value
$ctoJSON :: forall c. Crypto c =&gt; PolicyID c -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246089"><span id="local-6989586621679246094"><span class="annot"><span class="annottext">Value -&gt; Parser [PolicyID c]
Value -&gt; Parser (PolicyID c)
forall c. Crypto c =&gt; Value -&gt; Parser [PolicyID c]
forall c. Crypto c =&gt; Value -&gt; Parser (PolicyID c)
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [PolicyID c]
$cparseJSONList :: forall c. Crypto c =&gt; Value -&gt; Parser [PolicyID c]
parseJSON :: Value -&gt; Parser (PolicyID c)
$cparseJSON :: forall c. Crypto c =&gt; Value -&gt; Parser (PolicyID c)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246077"><span id="local-6989586621679246082"><span class="annot"><span class="annottext">ToJSONKeyFunction [PolicyID c]
ToJSONKeyFunction (PolicyID c)
forall c. Crypto c =&gt; ToJSONKeyFunction [PolicyID c]
forall c. Crypto c =&gt; ToJSONKeyFunction (PolicyID c)
forall a.
ToJSONKeyFunction a -&gt; ToJSONKeyFunction [a] -&gt; ToJSONKey a
toJSONKeyList :: ToJSONKeyFunction [PolicyID c]
$ctoJSONKeyList :: forall c. Crypto c =&gt; ToJSONKeyFunction [PolicyID c]
toJSONKey :: ToJSONKeyFunction (PolicyID c)
$ctoJSONKey :: forall c. Crypto c =&gt; ToJSONKeyFunction (PolicyID c)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">ToJSONKey</span></span></span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246065"><span id="local-6989586621679246070"><span class="annot"><span class="annottext">FromJSONKeyFunction [PolicyID c]
FromJSONKeyFunction (PolicyID c)
forall c. Crypto c =&gt; FromJSONKeyFunction [PolicyID c]
forall c. Crypto c =&gt; FromJSONKeyFunction (PolicyID c)
forall a.
FromJSONKeyFunction a -&gt; FromJSONKeyFunction [a] -&gt; FromJSONKey a
fromJSONKeyList :: FromJSONKeyFunction [PolicyID c]
$cfromJSONKeyList :: forall c. Crypto c =&gt; FromJSONKeyFunction [PolicyID c]
fromJSONKey :: FromJSONKeyFunction (PolicyID c)
$cfromJSONKey :: forall c. Crypto c =&gt; FromJSONKeyFunction (PolicyID c)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSONKey</span></span></span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | The MultiAssets map</span><span>
</span><span id="line-157"></span><span id="local-6989586621679246059"><span id="local-6989586621679246060"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="MultiAsset"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span></span><span> </span><span id="local-6989586621679247011"><span class="annot"><a href="#local-6989586621679247011"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MultiAsset"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247011"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679246047"><span id="local-6989586621679246049"><span id="local-6989586621679246056"><span class="annot"><span class="annottext">Int -&gt; MultiAsset c -&gt; ShowS
forall c. Int -&gt; MultiAsset c -&gt; ShowS
forall c. [MultiAsset c] -&gt; ShowS
forall c. MultiAsset c -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MultiAsset c] -&gt; ShowS
$cshowList :: forall c. [MultiAsset c] -&gt; ShowS
show :: MultiAsset c -&gt; String
$cshow :: forall c. MultiAsset c -&gt; String
showsPrec :: Int -&gt; MultiAsset c -&gt; ShowS
$cshowsPrec :: forall c. Int -&gt; MultiAsset c -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (MultiAsset c) x -&gt; MultiAsset c
forall c x. MultiAsset c -&gt; Rep (MultiAsset c) x
$cto :: forall c x. Rep (MultiAsset c) x -&gt; MultiAsset c
$cfrom :: forall c x. MultiAsset c -&gt; Rep (MultiAsset c) x
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679246020"><span id="local-6989586621679246026"><span id="local-6989586621679246032"><span id="local-6989586621679246039"><span class="annot"><span class="annottext">[MultiAsset c] -&gt; Value
[MultiAsset c] -&gt; Encoding
MultiAsset c -&gt; Value
MultiAsset c -&gt; Encoding
forall c. Crypto c =&gt; [MultiAsset c] -&gt; Value
forall c. Crypto c =&gt; [MultiAsset c] -&gt; Encoding
forall c. Crypto c =&gt; MultiAsset c -&gt; Value
forall c. Crypto c =&gt; MultiAsset c -&gt; Encoding
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [MultiAsset c] -&gt; Encoding
$ctoEncodingList :: forall c. Crypto c =&gt; [MultiAsset c] -&gt; Encoding
toJSONList :: [MultiAsset c] -&gt; Value
$ctoJSONList :: forall c. Crypto c =&gt; [MultiAsset c] -&gt; Value
toEncoding :: MultiAsset c -&gt; Encoding
$ctoEncoding :: forall c. Crypto c =&gt; MultiAsset c -&gt; Encoding
toJSON :: MultiAsset c -&gt; Value
$ctoJSON :: forall c. Crypto c =&gt; MultiAsset c -&gt; Value
</span><a href="#local-6989586621679246020"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246003"><span id="local-6989586621679247007"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247007"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247007"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245992"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245992"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679245991"><span class="annot"><span class="annottext">== :: MultiAsset c -&gt; MultiAsset c -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245990"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245990"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v.
(Ord k, CanonicalZero v) =&gt;
(v -&gt; v -&gt; Bool) -&gt; Map k v -&gt; Map k v -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">pointWise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v.
(Ord k, CanonicalZero v) =&gt;
(v -&gt; v -&gt; Bool) -&gt; Map k v -&gt; Map k v -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">pointWise</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(==)</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245992"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245990"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679247000"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247000"><span class="hs-identifier hs-type">cypto</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679245980"><span class="annot"><span class="annottext">rnf :: MultiAsset cypto -&gt; ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245978"><span class="annot"><span class="annottext">Map (PolicyID cypto) (Map AssetName Integer)
</span><a href="#local-6989586621679245978"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID cypto) (Map AssetName Integer)
</span><a href="#local-6989586621679245978"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245972"><span id="local-6989586621679245974"><span id="local-6989586621679245976"><span id="local-6989586621679246997"><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246997"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245967"><span id="local-6989586621679245969"><span id="local-6989586621679246994"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246994"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245957"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245957"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679245956"><span class="annot"><span class="annottext">&lt;&gt; :: MultiAsset c -&gt; MultiAsset c -&gt; MultiAsset c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245955"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245955"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
(Ord k, CanonicalZero a) =&gt;
(a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">canonicalMapUnion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
(Ord k, CanonicalZero a) =&gt;
(a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">canonicalMapUnion</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245957"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245955"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245947"><span id="local-6989586621679245949"><span id="local-6989586621679246989"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246989"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679245942"><span class="annot"><span class="annottext">mempty :: MultiAsset c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245935"><span id="local-6989586621679245937"><span id="local-6989586621679246984"><span class="annot"><span class="hs-identifier hs-type">Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246984"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679245924"><span class="annot"><span class="annottext">invert :: MultiAsset c -&gt; MultiAsset c
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">invert</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245922"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245922"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
(Ord k, CanonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">canonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
(Ord k, CanonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">canonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245922"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245913"><span id="local-6989586621679245915"><span id="local-6989586621679246981"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246981"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">DecCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246981"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679245911"><span class="annot"><span class="annottext">decCBOR :: forall s. Decoder s (MultiAsset c)
</span><a href="#local-6989586621679245911"><span class="hs-identifier hs-var hs-var hs-var hs-var">decCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c s. Crypto c =&gt; Decoder s (MultiAsset c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMint"><span class="hs-identifier hs-var">decodeMultiAssetMint</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245902"><span id="local-6989586621679245904"><span id="local-6989586621679246978"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246978"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">EncCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246978"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679245900"><span class="annot"><span class="annottext">encCBOR :: MultiAsset c -&gt; Encoding
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">encCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; MultiAsset c -&gt; Encoding
</span><a href="Cardano.Ledger.Mary.Value.html#encodeMultiAssetMaps"><span class="hs-identifier hs-var">encodeMultiAssetMaps</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | The Value representing MultiAssets</span><span>
</span><span id="line-186"></span><span id="local-6989586621679245896"><span id="local-6989586621679245897"></span></span><span class="hs-keyword">data</span><span> </span><span id="MaryValue"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span></span><span> </span><span id="local-6989586621679246976"><span class="annot"><a href="#local-6989586621679246976"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MaryValue"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246976"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245886"><span id="local-6989586621679245888"><span id="local-6989586621679245893"><span class="annot"><span class="annottext">Int -&gt; MaryValue c -&gt; ShowS
forall c. Int -&gt; MaryValue c -&gt; ShowS
forall c. [MaryValue c] -&gt; ShowS
forall c. MaryValue c -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MaryValue c] -&gt; ShowS
$cshowList :: forall c. [MaryValue c] -&gt; ShowS
show :: MaryValue c -&gt; String
$cshow :: forall c. MaryValue c -&gt; String
showsPrec :: Int -&gt; MaryValue c -&gt; ShowS
$cshowsPrec :: forall c. Int -&gt; MaryValue c -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (MaryValue c) x -&gt; MaryValue c
forall c x. MaryValue c -&gt; Rep (MaryValue c) x
$cto :: forall c x. Rep (MaryValue c) x -&gt; MaryValue c
$cfrom :: forall c x. MaryValue c -&gt; Rep (MaryValue c) x
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245881"><span id="local-6989586621679246975"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246975"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246975"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679245878"><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245878"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679245877"><span class="annot"><span class="annottext">== :: MaryValue c -&gt; MaryValue c -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679245876"><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245876"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; (Integer -&gt; Integer -&gt; Bool) -&gt; t -&gt; t -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">pointwise</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245878"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245876"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246971"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246971"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679245870"><span class="annot"><span class="annottext">rnf :: MaryValue c -&gt; ()
</span><a href="#local-6989586621679245870"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245869"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245869"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679245868"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245868"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245869"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-operator hs-var">`deepseq`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245868"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245862"><span id="local-6989586621679245864"><span id="local-6989586621679245866"><span id="local-6989586621679246968"><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246968"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245857"><span id="local-6989586621679245859"><span id="local-6989586621679246967"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246967"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245854"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245854"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679245853"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245853"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679245852"><span class="annot"><span class="annottext">&lt;&gt; :: MaryValue c -&gt; MaryValue c -&gt; MaryValue c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245851"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245851"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span id="local-6989586621679245850"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245850"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245854"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245851"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245853"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245850"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245843"><span id="local-6989586621679245845"><span id="local-6989586621679246966"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246966"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679245841"><span class="annot"><span class="annottext">mempty :: MaryValue c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245834"><span id="local-6989586621679245836"><span id="local-6989586621679246965"><span class="annot"><span class="hs-identifier hs-type">Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246965"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679245831"><span class="annot"><span class="annottext">invert :: MaryValue c -&gt; MaryValue c
</span><a href="#local-6989586621679245831"><span class="hs-identifier hs-var hs-var hs-var hs-var">invert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245830"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245830"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679245829"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245829"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245830"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m. Group m =&gt; m -&gt; m
</span><span class="hs-identifier hs-var">invert</span></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245829"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246961"><span class="annot"><span class="hs-identifier hs-type">Abelian</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246961"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- ===================================================</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- Make the Val instance of MaryValue</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245793"><span id="local-6989586621679245796"><span id="local-6989586621679245798"><span id="local-6989586621679246974"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246974"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246974"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679245767"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679245767"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679245766"><span class="annot"><span class="annottext">&lt;&#215;&gt; :: forall i. Integral i =&gt; i -&gt; MaryValue c -&gt; MaryValue c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&#215;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245764"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245764"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245763"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245763"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679245767"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245764"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
(Ord k, CanonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">canonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
(Ord k, CanonicalZero a) =&gt;
(a -&gt; a) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">canonicalMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679245767"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245763"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679245760"><span class="annot"><span class="annottext">isZero :: MaryValue c -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">isZero</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245758"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245758"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245757"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245757"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245758"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245757"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679245754"><span class="annot"><span class="annottext">coin :: MaryValue c -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">coin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245752"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245752"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245752"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679245750"><span class="annot"><span class="annottext">inject :: Coin -&gt; MaryValue c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">inject</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621679245748"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245748"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245748"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679245746"><span class="annot"><span class="annottext">modifyCoin :: (Coin -&gt; Coin) -&gt; MaryValue c -&gt; MaryValue c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifyCoin</span></a></span></span><span> </span><span id="local-6989586621679245744"><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621679245744"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245743"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245743"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679245742"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245742"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245741"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245742"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621679245741"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245741"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621679245744"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245743"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679245734"><span class="annot"><span class="annottext">pointwise :: (Integer -&gt; Integer -&gt; Bool) -&gt; MaryValue c -&gt; MaryValue c -&gt; Bool
</span><a href="#local-6989586621679245734"><span class="hs-identifier hs-var hs-var hs-var hs-var">pointwise</span></a></span></span><span> </span><span id="local-6989586621679245733"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621679245733"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245732"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245732"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245731"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245731"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245730"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245730"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245729"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245729"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621679245733"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245732"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245730"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v.
(Ord k, CanonicalZero v) =&gt;
(v -&gt; v -&gt; Bool) -&gt; Map k v -&gt; Map k v -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">pointWise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v.
(Ord k, CanonicalZero v) =&gt;
(v -&gt; v -&gt; Bool) -&gt; Map k v -&gt; Map k v -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">pointWise</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621679245733"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245731"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245729"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- returns the size, in Word64's, of the CompactValue representation of MaryValue</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679245724"><span class="annot"><span class="annottext">size :: MaryValue c -&gt; Integer
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679245722"><span class="annot"><span class="annottext">vv :: MaryValue c
</span><a href="#local-6989586621679245722"><span class="hs-identifier hs-var">vv</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245721"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245721"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- when MaryValue contains only ada</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- !WARNING! This branch is INCORRECT in the Mary era and should ONLY be</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- used in the Alonzo ERA.</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- TODO - find a better way to reconcile the mistakes in Mary with what needs</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- to be the case in Alonzo.</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245721"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-comment">-- when MaryValue contains ada as well as other tokens</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- sums up :</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- i) adaWords : the space taken up by the ada amount</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-comment">-- ii) numberMulAssets : the space taken by number of words used to store</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-comment">--    number of non-ada assets in a value</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-comment">-- iii) the space taken up by the rest of the representation (quantities,</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">--    PIDs, AssetNames, indeces)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-243"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Cardano.Ledger.Mary.Value.html#roundupBytesToWords"><span class="hs-identifier hs-var">roundupBytesToWords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; [(PolicyID c, AssetName, Integer)] -&gt; Int
</span><a href="Cardano.Ledger.Mary.Value.html#representationSize"><span class="hs-identifier hs-var">representationSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c.
MaryValue c -&gt; (Integer, [(PolicyID c, AssetName, Integer)])
</span><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-var">gettriples</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245722"><span class="hs-identifier hs-var">vv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>              </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Ledger.Mary.Value.html#repOverhead"><span class="hs-identifier hs-var">repOverhead</span></a></span><span>
</span><span id="line-245"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679245717"><span class="annot"><span class="annottext">isAdaOnly :: MaryValue c -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">isAdaOnly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245715"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245715"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245715"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679245714"><span class="annot"><span class="annottext">isAdaOnlyCompact :: CompactForm (MaryValue c) -&gt; Bool
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">isAdaOnlyCompact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-type">CompactValueAdaOnly</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-type">CompactValueMultiAsset</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679245709"><span class="annot"><span class="annottext">coinCompact :: CompactForm (MaryValue c) -&gt; CompactForm Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">coinCompact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-type">CompactValueAdaOnly</span></a></span><span> </span><span id="local-6989586621679245707"><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245707"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245707"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-type">CompactValueMultiAsset</span></a></span><span> </span><span id="local-6989586621679245706"><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245706"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245706"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679245705"><span class="annot"><span class="annottext">injectCompact :: CompactForm Coin -&gt; CompactForm (MaryValue c)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectCompact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. CompactValue c -&gt; CompactForm (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. CompactForm Coin -&gt; CompactValue c
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-var">CompactValueAdaOnly</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679245703"><span class="annot"><span class="annottext">modifyCompactCoin :: (CompactForm Coin -&gt; CompactForm Coin)
-&gt; CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifyCompactCoin</span></a></span></span><span> </span><span id="local-6989586621679245701"><span class="annot"><span class="annottext">CompactForm Coin -&gt; CompactForm Coin
</span><a href="#local-6989586621679245701"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-type">CompactValueAdaOnly</span></a></span><span> </span><span id="local-6989586621679245700"><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245700"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><span class="annottext">forall c. CompactValue c -&gt; CompactForm (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. CompactForm Coin -&gt; CompactValue c
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-var">CompactValueAdaOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; CompactForm Coin
</span><a href="#local-6989586621679245701"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245700"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-type">CompactValueMultiAsset</span></a></span><span> </span><span id="local-6989586621679245699"><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245699"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679245698"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679245698"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679245697"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245697"><span class="hs-identifier hs-var">sbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">forall c. CompactValue c -&gt; CompactForm (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c.
CompactForm Coin -&gt; Word32 -&gt; ShortByteString -&gt; CompactValue c
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-var">CompactValueMultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; CompactForm Coin
</span><a href="#local-6989586621679245701"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679245699"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679245698"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245697"><span class="hs-identifier hs-var">sbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- space (in Word64s) taken up by the ada amount</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#adaWords"><span class="hs-identifier hs-type">adaWords</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-267"></span><span id="adaWords"><span class="annot"><span class="annottext">adaWords :: Int
</span><a href="Cardano.Ledger.Mary.Value.html#adaWords"><span class="hs-identifier hs-var hs-var">adaWords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- 64 bit machine Word64 length</span><span>
</span><span id="line-270"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#wordLength"><span class="hs-identifier hs-type">wordLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-271"></span><span id="wordLength"><span class="annot"><span class="annottext">wordLength :: Int
</span><a href="Cardano.Ledger.Mary.Value.html#wordLength"><span class="hs-identifier hs-var hs-var">wordLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- overhead in MA compact rep</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#repOverhead"><span class="hs-identifier hs-type">repOverhead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-275"></span><span id="repOverhead"><span class="annot"><span class="annottext">repOverhead :: Int
</span><a href="Cardano.Ledger.Mary.Value.html#repOverhead"><span class="hs-identifier hs-var hs-var">repOverhead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Ledger.Mary.Value.html#adaWords"><span class="hs-identifier hs-var">adaWords</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Ledger.Mary.Value.html#numberMulAssets"><span class="hs-identifier hs-var">numberMulAssets</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- number of words used to store number of MAs in a value</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#numberMulAssets"><span class="hs-identifier hs-type">numberMulAssets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-279"></span><span id="numberMulAssets"><span class="annot"><span class="annottext">numberMulAssets :: Int
</span><a href="Cardano.Ledger.Mary.Value.html#numberMulAssets"><span class="hs-identifier hs-var hs-var">numberMulAssets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- converts bytes to words (rounding up)</span><span>
</span><span id="line-282"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#roundupBytesToWords"><span class="hs-identifier hs-type">roundupBytesToWords</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-283"></span><span id="roundupBytesToWords"><span class="annot"><span class="annottext">roundupBytesToWords :: Int -&gt; Int
</span><a href="Cardano.Ledger.Mary.Value.html#roundupBytesToWords"><span class="hs-identifier hs-var hs-var">roundupBytesToWords</span></a></span></span><span> </span><span id="local-6989586621679245693"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245693"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">quot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245693"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Ledger.Mary.Value.html#wordLength"><span class="hs-identifier hs-var">wordLength</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Ledger.Mary.Value.html#wordLength"><span class="hs-identifier hs-var">wordLength</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- ==============================================================</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- CBOR</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- TODO filter out 0s at deserialization</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- TODO Probably the actual serialization will be of the formal Coin OR Value type</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- Maybe better to make this distinction in the TxOut de/serialization</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#decodeValue"><span class="hs-identifier hs-type">decodeValue</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246942"><span class="annot"><a href="#local-6989586621679246942"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679246941"><span class="annot"><a href="#local-6989586621679246941"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246942"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246941"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246942"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span id="decodeValue"><span class="annot"><span class="annottext">decodeValue :: forall c s. Crypto c =&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValue"><span class="hs-identifier hs-var hs-var">decodeValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">forall s a. Version -&gt; Decoder s a -&gt; Decoder s a -&gt; Decoder s a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">ifDecoderVersionAtLeast</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (v :: Natural).
(KnownNat v, MinVersion &lt;= v, v &lt;= MaxVersion) =&gt;
Version
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">natVersion</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">9</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall t. Decoder t Coin) -&gt; Decoder s (MaryValue c)
</span><a href="#local-6989586621679245669"><span class="hs-identifier hs-var">decode'</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245668"><span class="hs-identifier hs-var">conwayCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall t. Decoder t Coin) -&gt; Decoder s (MaryValue c)
</span><a href="#local-6989586621679245669"><span class="hs-identifier hs-var">decode'</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245667"><span class="hs-identifier hs-var">preConwayCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="#local-6989586621679245668"><span class="hs-identifier hs-type">conwayCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679245666"><span class="annot"><a href="#local-6989586621679245666"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245666"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679245668"><span class="annot"><span class="annottext">conwayCoin :: forall t. Decoder t Coin
</span><a href="#local-6989586621679245668"><span class="hs-identifier hs-var hs-var">conwayCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">decodePositiveCoin</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="#local-6989586621679245667"><span class="hs-identifier hs-type">preConwayCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679245665"><span class="annot"><a href="#local-6989586621679245665"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245665"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679245667"><span class="annot"><span class="annottext">preConwayCoin :: forall t. Decoder t Coin
</span><a href="#local-6989586621679245667"><span class="hs-identifier hs-var hs-var">preConwayCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">word64ToCoin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Word64
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decodeWord64</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="#local-6989586621679245669"><span class="hs-identifier hs-type">decode'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246928"><span class="annot"><a href="#local-6989586621679246928"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246928"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246941"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246942"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679245669"><span class="annot"><span class="annottext">decode' :: (forall t. Decoder t Coin) -&gt; Decoder s (MaryValue c)
</span><a href="#local-6989586621679245669"><span class="hs-identifier hs-var hs-var">decode'</span></a></span></span><span> </span><span id="local-6989586621679245662"><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245662"><span class="hs-identifier hs-var">decodeCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>      </span><span id="local-6989586621679245661"><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679245661"><span class="hs-identifier hs-var">tt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s TokenType
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">peekTokenType</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679245661"><span class="hs-identifier hs-var">tt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeUInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245662"><span class="hs-identifier hs-var">decodeCoin</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeUInt64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245662"><span class="hs-identifier hs-var">decodeCoin</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeListLen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValuePair"><span class="hs-identifier hs-var">decodeValuePair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245662"><span class="hs-identifier hs-var">decodeCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeListLen64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValuePair"><span class="hs-identifier hs-var">decodeValuePair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245662"><span class="hs-identifier hs-var">decodeCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeListLenIndef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValuePair"><span class="hs-identifier hs-var">decodeValuePair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Coin
</span><a href="#local-6989586621679245662"><span class="hs-identifier hs-var">decodeCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Value: expected array or int, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679245661"><span class="hs-identifier hs-var">tt</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span id="local-6989586621679246919"><span id="local-6989586621679246921"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#decodeValuePair"><span class="hs-identifier hs-type">decodeValuePair</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246921"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246920"><span class="annot"><a href="#local-6989586621679246920"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246920"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246919"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246921"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-321"></span><span id="decodeValuePair"><span class="annot"><span class="annottext">decodeValuePair :: forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValuePair"><span class="hs-identifier hs-var hs-var">decodeValuePair</span></a></span></span><span> </span><span id="local-6989586621679245649"><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="#local-6989586621679245649"><span class="hs-identifier hs-var">decodeAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">forall (w :: Wrapped) t s. Decode w t -&gt; Decoder s t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">forall t. t -&gt; Decode ('Closed 'Dense) t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">RecD</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><span class="annottext">forall (w1 :: Wrapped) a t (w :: Density).
Decode w1 (a -&gt; t) -&gt; Decode ('Closed w) a -&gt; Decode w1 t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-operator hs-var">&lt;!</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (forall s. Decoder s t) -&gt; Decode ('Closed 'Dense) t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="#local-6989586621679245649"><span class="hs-identifier hs-var">decodeAmount</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><span class="annottext">forall (w1 :: Wrapped) a t (w :: Density).
Decode w1 (a -&gt; t) -&gt; Decode ('Closed w) a -&gt; Decode w1 t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-operator hs-var">&lt;!</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (forall s. Decoder s t) -&gt; Decode ('Closed 'Dense) t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MultiAsset c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMaps"><span class="hs-identifier hs-var">decodeMultiAssetMaps</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="#local-6989586621679245649"><span class="hs-identifier hs-var">decodeAmount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621679245644"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#encodeMultiAssetMaps"><span class="hs-identifier hs-type">encodeMultiAssetMaps</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245644"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245644"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Encoding</span></a></span></span><span>
</span><span id="line-331"></span><span id="encodeMultiAssetMaps"><span class="annot"><span class="annottext">encodeMultiAssetMaps :: forall c. Crypto c =&gt; MultiAsset c -&gt; Encoding
</span><a href="Cardano.Ledger.Mary.Value.html#encodeMultiAssetMaps"><span class="hs-identifier hs-var hs-var">encodeMultiAssetMaps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245633"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245633"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245633"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | `MultiAsset` can be used in two different circumstances:</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- during minting and in `MaryValue` while sending.</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- In the latter case, MultiAsset amounts cannot be negative,</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- while in minting negative indicates burning, and should not be zero.</span><span>
</span><span id="line-337"></span><span id="local-6989586621679246895"><span id="local-6989586621679246896"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMaps"><span class="hs-identifier hs-type">decodeMultiAssetMaps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246896"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679245632"><span class="annot"><a href="#local-6989586621679245632"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245632"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246895"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246896"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-338"></span><span id="decodeMultiAssetMaps"><span class="annot"><span class="annottext">decodeMultiAssetMaps :: forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MultiAsset c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMaps"><span class="hs-identifier hs-var hs-var">decodeMultiAssetMaps</span></a></span></span><span> </span><span id="local-6989586621679245612"><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="#local-6989586621679245612"><span class="hs-identifier hs-var">decodeAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679245611"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245611"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k s v.
Ord k =&gt;
Decoder s k -&gt; Decoder s v -&gt; Decoder s (Map k v)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decodeMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k s v.
Ord k =&gt;
Decoder s k -&gt; Decoder s v -&gt; Decoder s (Map k v)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decodeMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="#local-6989586621679245612"><span class="hs-identifier hs-var">decodeAmount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall c. MultiAsset c -&gt; Bool
</span><a href="Cardano.Ledger.Mary.Value.html#isMultiAssetSmallEnough"><span class="hs-identifier hs-var">isMultiAssetSmallEnough</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245611"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">forall s a. Version -&gt; Decoder s a -&gt; Decoder s a -&gt; Decoder s a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">ifDecoderVersionAtLeast</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (v :: Natural).
(KnownNat v, MinVersion &lt;= v, v &lt;= MaxVersion) =&gt;
Version
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">natVersion</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">9</span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245611"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245611"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679245609"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679245609"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679245609"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty Assets are not allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c.
Map (PolicyID c) (Map AssetName Integer)
-&gt; Map (PolicyID c) (Map AssetName Integer)
</span><a href="Cardano.Ledger.Mary.Value.html#prune"><span class="hs-identifier hs-var">prune</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245611"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MultiAsset too big to compact&quot;</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span id="local-6989586621679246979"><span id="local-6989586621679246980"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMint"><span class="hs-identifier hs-type">decodeMultiAssetMint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246980"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246979"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246980"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-349"></span><span id="decodeMultiAssetMint"><span class="annot"><span class="annottext">decodeMultiAssetMint :: forall c s. Crypto c =&gt; Decoder s (MultiAsset c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMint"><span class="hs-identifier hs-var hs-var">decodeMultiAssetMint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c s.
Crypto c =&gt;
(forall t. Decoder t Integer) -&gt; Decoder s (MultiAsset c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeMultiAssetMaps"><span class="hs-identifier hs-var">decodeMultiAssetMaps</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="Cardano.Ledger.Mary.Value.html#decodeIntegerBounded64"><span class="hs-identifier hs-var">decodeIntegerBounded64</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245597"><span id="local-6989586621679245599"><span id="local-6989586621679245605"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245605"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">EncCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245605"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679245593"><span class="annot"><span class="annottext">encCBOR :: MaryValue c -&gt; Encoding
</span><a href="#local-6989586621679245593"><span class="hs-identifier hs-var hs-var hs-var hs-var">encCBOR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245592"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245592"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679245591"><span class="annot"><span class="annottext">ma :: MultiAsset c
</span><a href="#local-6989586621679245591"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245590"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245590"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245590"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245592"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">forall (w :: Wrapped) t. Encode w t -&gt; Encoding
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-357"></span><span>          </span><span class="annot"><span class="annottext">forall t. t -&gt; Encode ('Closed 'Dense) t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">Rec</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span>
</span><span id="line-358"></span><span>            </span><span class="annot"><span class="annottext">forall (w :: Wrapped) a t (r :: Density).
Encode w (a -&gt; t) -&gt; Encode ('Closed r) a -&gt; Encode w t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-operator hs-var">!&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. EncCBOR t =&gt; t -&gt; Encode ('Closed 'Dense) t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">To</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245592"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-359"></span><span>            </span><span class="annot"><span class="annottext">forall (w :: Wrapped) a t (r :: Density).
Encode w (a -&gt; t) -&gt; Encode ('Closed r) a -&gt; Encode w t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-operator hs-var">!&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. EncCBOR t =&gt; t -&gt; Encode ('Closed 'Dense) t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">To</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245591"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245579"><span id="local-6989586621679245581"><span id="local-6989586621679245587"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245587"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">DecCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245587"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621679245577"><span class="annot"><span class="annottext">decCBOR :: forall s. Decoder s (MaryValue c)
</span><a href="#local-6989586621679245577"><span class="hs-identifier hs-var hs-var hs-var hs-var">decCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c s. Crypto c =&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- Note: we do not use `decodeInt64` from the cborg library here because the</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- implementation contains &quot;-- TODO FIXME: overflow&quot;</span><span>
</span><span id="line-366"></span><span id="local-6989586621679245576"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#decodeIntegerBounded64"><span class="hs-identifier hs-type">decodeIntegerBounded64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245576"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span>
</span><span id="line-367"></span><span id="decodeIntegerBounded64"><span class="annot"><span class="annottext">decodeIntegerBounded64 :: forall t. Decoder t Integer
</span><a href="Cardano.Ledger.Mary.Value.html#decodeIntegerBounded64"><span class="hs-identifier hs-var hs-var">decodeIntegerBounded64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679245544"><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679245544"><span class="hs-identifier hs-var">tt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s TokenType
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">peekTokenType</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679245544"><span class="hs-identifier hs-var">tt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeUInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeUInt64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeNInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">TokenType
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cborg-0.2.8.0-f8f83cc3baa0d5b9a506f97bbef0fc73477cc313444ece46030cdbea18290919/share/doc/html/src"><span class="hs-identifier hs-var">TypeNInt64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><span class="annottext">TokenType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected major type 0 or 1 when decoding mint field&quot;</span></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679245541"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall t. Decoder t Integer
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">decodeInteger</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245540"><span class="hs-identifier hs-var">minval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245538"><span class="hs-identifier hs-var">maxval</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s a. Version -&gt; Decoder s a -&gt; Decoder s a -&gt; Decoder s a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">ifDecoderVersionAtLeast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (v :: Natural).
(KnownNat v, MinVersion &lt;= v, v &lt;= MaxVersion) =&gt;
Version
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">natVersion</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">9</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mint field cannot be 0 (zero)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span>
</span><span id="line-384"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;overflow when decoding mint field. min value: &quot;</span></span><span>
</span><span id="line-385"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245540"><span class="hs-identifier hs-var">minval</span></a></span><span>
</span><span id="line-386"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; max value: &quot;</span></span><span>
</span><span id="line-387"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245538"><span class="hs-identifier hs-var">maxval</span></a></span><span>
</span><span id="line-388"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; got: &quot;</span></span><span>
</span><span id="line-389"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245541"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679245538"><span class="annot"><span class="annottext">maxval :: Integer
</span><a href="#local-6989586621679245538"><span class="hs-identifier hs-var hs-var">maxval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621679245540"><span class="annot"><span class="annottext">minval :: Integer
</span><a href="#local-6989586621679245540"><span class="hs-identifier hs-var hs-var">minval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- JSON</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245520"><span id="local-6989586621679245522"><span id="local-6989586621679245526"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245526"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245526"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621679245516"><span class="annot"><span class="annottext">toJSON :: MaryValue c -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall c a. (Crypto c, KeyValue a) =&gt; MaryValue c -&gt; [a]
</span><a href="Cardano.Ledger.Mary.Value.html#toMaryValuePairs"><span class="hs-identifier hs-var">toMaryValuePairs</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679245508"><span class="annot"><span class="annottext">toEncoding :: MaryValue c -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Series -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.pairs</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall c a. (Crypto c, KeyValue a) =&gt; MaryValue c -&gt; [a]
</span><a href="Cardano.Ledger.Mary.Value.html#toMaryValuePairs"><span class="hs-identifier hs-var">toMaryValuePairs</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span id="local-6989586621679246859"><span id="local-6989586621679246860"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#toMaryValuePairs"><span class="hs-identifier hs-type">toMaryValuePairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246860"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.KeyValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679246859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246860"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679246859"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-403"></span><span id="toMaryValuePairs"><span class="annot"><span class="annottext">toMaryValuePairs :: forall c a. (Crypto c, KeyValue a) =&gt; MaryValue c -&gt; [a]
</span><a href="Cardano.Ledger.Mary.Value.html#toMaryValuePairs"><span class="hs-identifier hs-var hs-var">toMaryValuePairs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245496"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245496"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679245495"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245495"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;lovelace&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245496"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;policies&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245495"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245488"><span id="local-6989586621679245490"><span id="local-6989586621679245492"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679245487"><span class="annot"><span class="annottext">toJSON :: AssetName -&gt; Value
</span><a href="#local-6989586621679245487"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; Text
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToTextAsHex"><span class="hs-identifier hs-var">assetNameToTextAsHex</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245483"><span class="annot"><span class="hs-identifier hs-type">ToJSONKey</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679245482"><span class="annot"><span class="annottext">toJSONKey :: ToJSONKeyFunction AssetName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSONKey</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Text) -&gt; ToJSONKeyFunction a
</span><span class="hs-identifier hs-var">toJSONKeyText</span></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; Text
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToTextAsHex"><span class="hs-identifier hs-var">assetNameToTextAsHex</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- Compactible</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- This is used in the TxOut which stores the (CompactForm MaryValue).</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245480"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245480"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245480"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="CompactForm"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">CompactForm</span></a></span></span><span> </span><span id="local-6989586621679245480"><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245480"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CompactValue"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679245480"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245459"><span id="local-6989586621679245463"><span class="annot"><span class="annottext">CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c) -&gt; Bool
forall c.
Crypto c =&gt;
CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c) -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c) -&gt; Bool
$c/= :: forall c.
Crypto c =&gt;
CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c) -&gt; Bool
== :: CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c) -&gt; Bool
$c== :: forall c.
Crypto c =&gt;
CompactForm (MaryValue c) -&gt; CompactForm (MaryValue c) -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245449"><span id="local-6989586621679245451"><span id="local-6989586621679245455"><span class="annot"><span class="annottext">Int -&gt; CompactForm (MaryValue c) -&gt; ShowS
forall c. Int -&gt; CompactForm (MaryValue c) -&gt; ShowS
forall c. [CompactForm (MaryValue c)] -&gt; ShowS
forall c. CompactForm (MaryValue c) -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CompactForm (MaryValue c)] -&gt; ShowS
$cshowList :: forall c. [CompactForm (MaryValue c)] -&gt; ShowS
show :: CompactForm (MaryValue c) -&gt; String
$cshow :: forall c. CompactForm (MaryValue c) -&gt; String
showsPrec :: Int -&gt; CompactForm (MaryValue c) -&gt; ShowS
$cshowsPrec :: forall c. Int -&gt; CompactForm (MaryValue c) -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245438"><span id="local-6989586621679245442"><span id="local-6989586621679245447"><span class="annot"><span class="annottext">Context -&gt; CompactForm (MaryValue c) -&gt; IO (Maybe ThunkInfo)
Proxy (CompactForm (MaryValue c)) -&gt; String
forall c.
Context -&gt; CompactForm (MaryValue c) -&gt; IO (Maybe ThunkInfo)
forall c. Proxy (CompactForm (MaryValue c)) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (CompactForm (MaryValue c)) -&gt; String
$cshowTypeOf :: forall c. Proxy (CompactForm (MaryValue c)) -&gt; String
wNoThunks :: Context -&gt; CompactForm (MaryValue c) -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall c.
Context -&gt; CompactForm (MaryValue c) -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; CompactForm (MaryValue c) -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall c.
Context -&gt; CompactForm (MaryValue c) -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679245438"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245417"><span id="local-6989586621679245423"><span id="local-6989586621679245429"><span class="annot"><span class="annottext">CompactForm (MaryValue c) -&gt; Encoding
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (MaryValue c)] -&gt; Size
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (MaryValue c)) -&gt; Size
forall a.
Typeable a
-&gt; (a -&gt; Encoding)
-&gt; ((forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy a -&gt; Size)
-&gt; ((forall t. EncCBOR t =&gt; Proxy t -&gt; Size) -&gt; Proxy [a] -&gt; Size)
-&gt; EncCBOR a
forall {c}. Crypto c =&gt; Typeable (CompactForm (MaryValue c))
forall c. Crypto c =&gt; CompactForm (MaryValue c) -&gt; Encoding
forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (MaryValue c)] -&gt; Size
forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (MaryValue c)) -&gt; Size
encodedListSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (MaryValue c)] -&gt; Size
$cencodedListSizeExpr :: forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy [CompactForm (MaryValue c)] -&gt; Size
encodedSizeExpr :: (forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (MaryValue c)) -&gt; Size
$cencodedSizeExpr :: forall c.
Crypto c =&gt;
(forall t. EncCBOR t =&gt; Proxy t -&gt; Size)
-&gt; Proxy (CompactForm (MaryValue c)) -&gt; Size
encCBOR :: CompactForm (MaryValue c) -&gt; Encoding
$cencCBOR :: forall c. Crypto c =&gt; CompactForm (MaryValue c) -&gt; Encoding
</span><a href="#local-6989586621679245417"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">EncCBOR</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245398"><span id="local-6989586621679245402"><span id="local-6989586621679245406"><span class="annot"><span class="annottext">Proxy (CompactForm (MaryValue c)) -&gt; Text
forall s. Decoder s (CompactForm (MaryValue c))
forall a.
Typeable a
-&gt; (forall s. Decoder s a)
-&gt; (forall s. Proxy a -&gt; Decoder s ())
-&gt; (Proxy a -&gt; Text)
-&gt; DecCBOR a
forall s. Proxy (CompactForm (MaryValue c)) -&gt; Decoder s ()
forall {c}. Crypto c =&gt; Typeable (CompactForm (MaryValue c))
forall c. Crypto c =&gt; Proxy (CompactForm (MaryValue c)) -&gt; Text
forall c s. Crypto c =&gt; Decoder s (CompactForm (MaryValue c))
forall c s.
Crypto c =&gt;
Proxy (CompactForm (MaryValue c)) -&gt; Decoder s ()
label :: Proxy (CompactForm (MaryValue c)) -&gt; Text
$clabel :: forall c. Crypto c =&gt; Proxy (CompactForm (MaryValue c)) -&gt; Text
dropCBOR :: forall s. Proxy (CompactForm (MaryValue c)) -&gt; Decoder s ()
$cdropCBOR :: forall c s.
Crypto c =&gt;
Proxy (CompactForm (MaryValue c)) -&gt; Decoder s ()
decCBOR :: forall s. Decoder s (CompactForm (MaryValue c))
$cdecCBOR :: forall c s. Crypto c =&gt; Decoder s (CompactForm (MaryValue c))
</span><a href="#local-6989586621679245398"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">DecCBOR</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245392"><span class="annot"><span class="annottext">CompactForm (MaryValue c) -&gt; ()
forall c. CompactForm (MaryValue c) -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: CompactForm (MaryValue c) -&gt; ()
$crnf :: forall c. CompactForm (MaryValue c) -&gt; ()
</span><a href="#local-6989586621679245392"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679245384"><span class="annot"><span class="annottext">toCompact :: MaryValue c -&gt; Maybe (CompactForm (MaryValue c))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCompact</span></a></span></span><span> </span><span id="local-6989586621679245382"><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245382"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. CompactValue c -&gt; CompactForm (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; MaryValue c -&gt; Maybe (CompactValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245382"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621679245379"><span class="annot"><span class="annottext">fromCompact :: CompactForm (MaryValue c) -&gt; MaryValue c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCompact</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span id="local-6989586621679245377"><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245377"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; CompactValue c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245377"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245368"><span id="local-6989586621679245370"><span id="local-6989586621679246842"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246842"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">EncCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246842"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679245365"><span class="annot"><span class="annottext">encCBOR :: CompactValue c -&gt; Encoding
</span><a href="#local-6989586621679245365"><span class="hs-identifier hs-var hs-var hs-var hs-var">encCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; CompactValue c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245357"><span id="local-6989586621679245359"><span id="local-6989586621679246838"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246838"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-binary-1.1.0.0/doc/html/cardano-ledger-binary/src"><span class="hs-identifier hs-type">DecCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246838"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621679245351"><span class="annot"><span class="annottext">decCBOR :: forall s. Decoder s (CompactValue c)
</span><a href="#local-6989586621679245351"><span class="hs-identifier hs-var hs-var hs-var hs-var">decCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679245350"><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245350"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall c s. Crypto c =&gt; Decoder s (MaryValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; MaryValue c -&gt; Maybe (CompactValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245350"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><span class="annottext">Maybe (CompactValue c)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span>
</span><span id="line-433"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible failure: decoded nonnegative value that cannot be compacted&quot;</span></span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679245349"><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245349"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245349"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-keyword">data</span><span> </span><span id="CompactValue"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-var">CompactValue</span></a></span></span><span> </span><span id="local-6989586621679246944"><span class="annot"><a href="#local-6989586621679246944"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CompactValueAdaOnly"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-var">CompactValueAdaOnly</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">CompactForm</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CompactValueMultiAsset"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-var">CompactValueMultiAsset</span></a></span></span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">CompactForm</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ada</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-comment">-- number of ma's</span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ShortByteString</span></span><span> </span><span class="hs-comment">-- rep</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245334"><span id="local-6989586621679245336"><span id="local-6989586621679245347"><span class="annot"><span class="annottext">Int -&gt; CompactValue c -&gt; ShowS
forall c. Int -&gt; CompactValue c -&gt; ShowS
forall c. [CompactValue c] -&gt; ShowS
forall c. CompactValue c -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CompactValue c] -&gt; ShowS
$cshowList :: forall c. [CompactValue c] -&gt; ShowS
show :: CompactValue c -&gt; String
$cshow :: forall c. CompactValue c -&gt; String
showsPrec :: Int -&gt; CompactValue c -&gt; ShowS
$cshowsPrec :: forall c. Int -&gt; CompactValue c -&gt; ShowS
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246836"><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246836"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621679245332"><span class="annot"><span class="annottext">rnf :: CompactValue c -&gt; ()
</span><a href="#local-6989586621679245332"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rwhnf</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679245329"><span id="local-6989586621679246848"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246848"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246848"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621679245325"><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245325"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679245324"><span class="annot"><span class="annottext">== :: CompactValue c -&gt; CompactValue c -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679245323"><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245323"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; CompactValue c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245325"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; CompactValue c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">CompactValue c
</span><a href="#local-6989586621679245323"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span id="local-6989586621679245310"><span id="local-6989586621679245315"><span id="local-6989586621679245321"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621679246846"><span class="annot"><span class="hs-identifier hs-type">OnlyCheckWhnfNamed</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CompactValue&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246846"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-keyword">instance</span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246846"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">{-
The MaryValue surface type uses a nested map. For the compact version we use a
flattened representation, equivalent to a list of triples:
  [(PolicyID, AssetName, Quantity)]

Example:
  [ (&quot;0xa519f84e...&quot;, &quot;&quot;,       42)  -- empty asset name
  , (&quot;0xf820a82c...&quot;, &quot;Snark&quot;,  1)
  , (&quot;0xf820a82c...&quot;, &quot;Boojum&quot;, 1)   -- shared policy id, different name
  ]

We start by sorting in /descending/ order by asset name. Note that descending
order puts empty strings last:
  [ (&quot;0xf820a82c...&quot;, &quot;Snark&quot;,  1)
  , (&quot;0xf820a82c...&quot;, &quot;Boojum&quot;, 1)
  , (&quot;0xa519f84e...&quot;, &quot;&quot;,      42)
  ]

This example will be serialised as:
  &#9487;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9523;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9523;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9491;
A)&#9475;             1 &#9475;             1 &#9475;            42 &#9475; Word64 quantities
  &#9507;&#9473;&#9473;&#9473;&#9523;&#9473;&#9473;&#9473;&#9523;&#9473;&#9473;&#9473;&#9523;&#9473;&#9473;&#9473;&#9531;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9531;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9473;&#9499;
B)&#9475; 36&#9475; 36&#9475; 64&#9475;                                     Word16 policyId offsets
  &#9507;&#9473;&#9473;&#9473;&#9547;&#9473;&#9473;&#9473;&#9547;&#9473;&#9473;&#9473;&#9515;
C)&#9475; 92&#9475; 98&#9475;103&#9475;                                     Word16 asset name offsets
  &#9507;&#9473;&#9519;&#9473;&#9543;&#9473;&#9519;&#9473;&#9543;&#9473;&#9519;&#9473;&#9543;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9519;&#9473;&#9491;
D)&#9475;f820a82c.. &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9475; 28 byte policyId #1
  &#9507;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9515;
  &#9475;a519f84e.. &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9482; &#9475; 28 byte policyId #2
  &#9507;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9535;&#9473;&#9544;&#9473;&#9544;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9499;
E)&#9475;S&#9482;n&#9482;a&#9482;r&#9482;k&#9482;B&#9482;o&#9482;o&#9482;j&#9482;u&#9482;m&#9475;&#9664;&#9538;&#9472;padding to word size    Asset names, plus padding
  &#9495;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9527;&#9473;&#9531;&#9473;&#9499;
   &#9650;         &#9650;           &#9650;
   92-offset 97-offset   103-offset, end of string

Note that the asset name offsets end up sorted in ascending order, with empty
asset names pointing to the offset past the end of the concatenated names.

The serialised representation consists of five parts, concatenated together:
  A) A sequence of Word64s representing asset quantities.

  B) A sequence of Word16s representing policyId string offsets within D.
     We do not need to store a length because policyIds are fixed size.

  C) A sequence of Word16s representing asset name string offsets within E.
     We store only the starting offset and not a end offset or length. We can
     do this because we keep the assets in A,B,C sorted by the asset name, so
     the offsets in C are sorted. This means the next distinct entry gives the
     (exclusive) end offset of the asset name string. As a special case for
     empty asset names, the index points to the end of the string E.

     Note: If there are duplicate asset names, this can yield a sequence of
     multiple of the same offset. For example, if the assets are named
     &quot;Snark&quot;,&quot;Snark&quot;,&quot;Boojum&quot;, region E would contain &quot;SnarkBoojum&quot;,
     and region C would contain 92, 92, 97. For the decoder to determine the
     length of the first asset, it would subtract 92 from 97 (and not from the
     duplicate 92).

  D) a blob of policyIDs, without duplicates, concatenated.

  E) a blob of asset names, sorted, without duplicates, concatenated.

The size of the regions A,B,C are known based on the number of values. The
string offsets in B and C are relative to the whole of the representation, not
relative to the start of D &amp; E (since D is variable size depending on whether
there were duplicate policyIDs)

The encoding strategy is
 - Collect all (unique) policy Ids.
 - Collect all (unique) asset names.
 - Determine the sizes of the regions and allocate them.
   - size A = 8 * numassets
   - size B = 2 * numassets
   - size C = 2 * numassets
   - size D = length (concat policyIds)
   - size E = length (concat assetNames)
   - sum = 12*numassets
         + length (concat policyIds)
         + length (concat assetNames)
 - Write the policyIds to region D
 - Write the asset names to region E
 - For each asset entry
   - Locate the corresponding asset name and policyId
   - Write quantity, policyId location, and asset name location to corresponding
     regions
   - For the special case of 0 length asset names, the location is the end of
     region E

The decoding strategy is
 - Use length information to determine the beginnings of regions A,B,C
   (We do not need to do this for regions D and E because the policyId
   and asset name locations are relative to the beginning of entire rep.)
 - For each integer in 0..(numassets -1)
   - Read corresponding quantity, pid offset, and asset name offset from regions
     A, B, and C, respectively.
   - Read (pid length) bytes from pid offset. assume it points into region D
   - Determine asset name lengths using the difference between the offset and
     the next greater offset (if it exists). If there is no next greater offset,
     use the difference from the end of the rep. (Note: for the special case of
     0 length asset names, this calculation results in 0 because we are
     subtracting the end of the rep from itself.)
   - Read (asset name length) bytes from asset name offset. assume it points
     into region E.
 -}</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#to"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246835"><span class="annot"><a href="#local-6989586621679246835"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246835"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-563"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246835"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-comment">-- The Nothing case of the return value corresponds to a quantity that is outside</span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-comment">-- the bounds of a Word64. x &lt; 0 or x &gt; (2^64 - 1)</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246835"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span id="to"><span class="annot"><span class="annottext">to :: forall c. Crypto c =&gt; MaryValue c -&gt; Maybe (CompactValue c)
</span><a href="Cardano.Ledger.Mary.Value.html#to"><span class="hs-identifier hs-var hs-var">to</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679245242"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245242"><span class="hs-identifier hs-var">ada</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245241"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245241"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245241"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-569"></span><span>      </span><span class="annot"><span class="annottext">forall c. CompactForm Coin -&gt; CompactValue c
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-var">CompactValueAdaOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Word64
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">integerToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245242"><span class="hs-identifier hs-var">ada</span></a></span><span>
</span><span id="line-570"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span id="local-6989586621679245239"><span class="annot"><span class="annottext">v :: MaryValue c
</span><a href="#local-6989586621679245239"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679245238"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245238"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679245237"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245237"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. MultiAsset c -&gt; Bool
</span><a href="Cardano.Ledger.Mary.Value.html#isMultiAssetSmallEnough"><span class="hs-identifier hs-var">isMultiAssetSmallEnough</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245238"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Maybe Word64
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">integerToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245236"><span class="hs-identifier hs-var">ada</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-comment">-- Here we convert the (pid, assetName, quantity) triples into</span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-comment">-- (Int, (Word16,Word16,Word64))</span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-comment">-- These represent the index, pid offset, asset name offset, and quantity.</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-comment">-- If any of the quantities out of bounds, this will produce Nothing.</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-comment">-- The triples are ordered by asset name in descending order.</span><span>
</span><span id="line-577"></span><span>  </span><span id="local-6989586621679245235"><span class="annot"><span class="annottext">[(Int, (Word16, Word16, Word64))]
</span><a href="#local-6989586621679245235"><span class="hs-identifier hs-var">preparedTriples</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245234"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245234"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245234"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">(PolicyID c, AssetName, Integer) -&gt; Maybe (Word16, Word16, Word64)
</span><a href="#local-6989586621679245232"><span class="hs-identifier hs-var">prepare</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245231"><span class="hs-identifier hs-var">triples</span></a></span><span>
</span><span id="line-579"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="annottext">forall c.
CompactForm Coin -&gt; Word32 -&gt; ShortByteString -&gt; CompactValue c
</span><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-var">CompactValueMultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245237"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245230"><span class="hs-identifier hs-var">numTriples</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><span class="annottext">forall a. (forall s. ST s a) -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>        </span><span id="local-6989586621679245190"><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
PrimMonad m =&gt;
Int -&gt; m (MutableByteArray (PrimState m))
</span><span class="hs-identifier hs-var">BA.newByteArray</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245188"><span class="hs-identifier hs-var">repSize</span></a></span><span>
</span><span id="line-583"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, (Word16, Word16, Word64))]
</span><a href="#local-6989586621679245235"><span class="hs-identifier hs-var">preparedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679245187"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245187"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245186"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245186"><span class="hs-identifier hs-var">pidoff</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245185"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245185"><span class="hs-identifier hs-var">anoff</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245184"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245184"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-584"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-585"></span><span>            </span><span class="hs-comment">-- For each triple, we write the quantity to region A,</span><span>
</span><span id="line-586"></span><span>            </span><span class="hs-comment">-- the pid offset to region B, and the asset name offset to region C.</span><span>
</span><span id="line-587"></span><span>            </span><span class="hs-comment">-- We can calculate the sizes (and therefore the starts) of each region</span><span>
</span><span id="line-588"></span><span>            </span><span class="hs-comment">-- using the number of triples.</span><span>
</span><span id="line-589"></span><span>            </span><span class="hs-comment">-- A:</span><span>
</span><span id="line-590"></span><span>            </span><span class="hs-comment">--   size: (#triples * 8) bytes</span><span>
</span><span id="line-591"></span><span>            </span><span class="hs-comment">--   start: offset 0</span><span>
</span><span id="line-592"></span><span>            </span><span class="hs-comment">-- B:</span><span>
</span><span id="line-593"></span><span>            </span><span class="hs-comment">--   size: (#triples * 2) bytes</span><span>
</span><span id="line-594"></span><span>            </span><span class="hs-comment">--   start: size(A) = #triples * 8</span><span>
</span><span id="line-595"></span><span>            </span><span class="hs-comment">-- C:</span><span>
</span><span id="line-596"></span><span>            </span><span class="hs-comment">--   size: (#triples * 2) bytes</span><span>
</span><span id="line-597"></span><span>            </span><span class="hs-comment">--   start: size(A) + size(B) = #triples * 10</span><span>
</span><span id="line-598"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-599"></span><span>            </span><span class="hs-comment">-- The position argument to writeByteArray is an index in terms of the</span><span>
</span><span id="line-600"></span><span>            </span><span class="hs-comment">-- size of the value being written. So writeByteArray of a Word64 at</span><span>
</span><span id="line-601"></span><span>            </span><span class="hs-comment">-- position 1 writes at offset 8.</span><span>
</span><span id="line-602"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-603"></span><span>            </span><span class="hs-comment">-- For the following, the byte offsets calculated above are converted to</span><span>
</span><span id="line-604"></span><span>            </span><span class="hs-comment">-- ByteArray positions by division.</span><span>
</span><span id="line-605"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-606"></span><span>            </span><span class="hs-comment">-- The byte offset of the ith...</span><span>
</span><span id="line-607"></span><span>            </span><span class="hs-comment">--   quantity: 8i</span><span>
</span><span id="line-608"></span><span>            </span><span class="hs-comment">--   pid offset: 8n + 2i</span><span>
</span><span id="line-609"></span><span>            </span><span class="hs-comment">--   asset name offset: 8n + 2n + 2i</span><span>
</span><span id="line-610"></span><span>            </span><span class="hs-comment">-- Dividing by the respective sizes (8,2,2) yields the indices below.</span><span>
</span><span id="line-611"></span><span>            </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">BA.writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245187"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245184"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-612"></span><span>            </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">BA.writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245230"><span class="hs-identifier hs-var">numTriples</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245187"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245186"><span class="hs-identifier hs-var">pidoff</span></a></span><span>
</span><span id="line-613"></span><span>            </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">BA.writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245230"><span class="hs-identifier hs-var">numTriples</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245187"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245185"><span class="hs-identifier hs-var">anoff</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) Word16
</span><a href="#local-6989586621679245181"><span class="hs-identifier hs-var">pidOffsetMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-616"></span><span>          </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span id="local-6989586621679245179"><span class="annot"><span class="annottext">Hash (ADDRHASH c) EraIndependentScript
</span><a href="#local-6989586621679245179"><span class="hs-identifier hs-var">sh</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245178"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245178"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-617"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245177"><span class="annot"><span class="annottext">pidBytes :: ShortByteString
</span><a href="#local-6989586621679245177"><span class="hs-identifier hs-var hs-var">pidBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall h a. Hash h a -&gt; ShortByteString
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-crypto-class-2.1.0.1-c762b570cf40f8cd35d15c1899429c392d4cc06de39a6636725516f614c3ad0c/share/doc/html/src"><span class="hs-identifier hs-var">Hash.hashToBytesShort</span></a></span><span> </span><span class="annot"><span class="annottext">Hash (ADDRHASH c) EraIndependentScript
</span><a href="#local-6989586621679245179"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-618"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
PrimMonad m =&gt;
MutableByteArray (PrimState m)
-&gt; Int -&gt; ByteArray -&gt; Int -&gt; Int -&gt; m ()
</span><span class="hs-identifier hs-var">BA.copyByteArray</span></span><span>
</span><span id="line-619"></span><span>                  </span><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span><span>
</span><span id="line-620"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245178"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteArray
</span><a href="Cardano.Ledger.Mary.Value.html#sbsToByteArray"><span class="hs-identifier hs-var">sbsToByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245177"><span class="hs-identifier hs-var">pidBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-623"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245173"><span class="hs-identifier hs-var">pidSize</span></a></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map AssetName Word16
</span><a href="#local-6989586621679245172"><span class="hs-identifier hs-var">assetNameOffsetMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-626"></span><span>          </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span id="local-6989586621679245171"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245171"><span class="hs-identifier hs-var">anameBS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245170"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245170"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-627"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245169"><span class="annot"><span class="annottext">anameBytes :: ShortByteString
</span><a href="#local-6989586621679245169"><span class="hs-identifier hs-var hs-var">anameBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245171"><span class="hs-identifier hs-var">anameBS</span></a></span><span>
</span><span id="line-628"></span><span>                </span><span id="local-6989586621679245168"><span class="annot"><span class="annottext">anameLen :: Int
</span><a href="#local-6989586621679245168"><span class="hs-identifier hs-var hs-var">anameLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int
</span><span class="hs-identifier hs-var">SBS.length</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245171"><span class="hs-identifier hs-var">anameBS</span></a></span><span>
</span><span id="line-629"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
PrimMonad m =&gt;
MutableByteArray (PrimState m)
-&gt; Int -&gt; ByteArray -&gt; Int -&gt; Int -&gt; m ()
</span><span class="hs-identifier hs-var">BA.copyByteArray</span></span><span>
</span><span id="line-630"></span><span>                  </span><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span><span>
</span><span id="line-631"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245170"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteArray
</span><a href="Cardano.Ledger.Mary.Value.html#sbsToByteArray"><span class="hs-identifier hs-var">sbsToByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245169"><span class="hs-identifier hs-var">anameBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-634"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245168"><span class="hs-identifier hs-var">anameLen</span></a></span><span>
</span><span id="line-635"></span><span>        </span><span class="annot"><span class="annottext">ByteArray -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#byteArrayToSbs"><span class="hs-identifier hs-var">byteArrayToSbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
PrimMonad m =&gt;
MutableByteArray (PrimState m) -&gt; m ByteArray
</span><span class="hs-identifier hs-var">BA.unsafeFreezeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray s
</span><a href="#local-6989586621679245190"><span class="hs-identifier hs-var">byteArray</span></a></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679245236"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245236"><span class="hs-identifier hs-var">ada</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245231"><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245231"><span class="hs-identifier hs-var">triples</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c.
MaryValue c -&gt; (Integer, [(PolicyID c, AssetName, Integer)])
</span><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-var">gettriples</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245239"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621679245230"><span class="annot"><span class="annottext">numTriples :: Int
</span><a href="#local-6989586621679245230"><span class="hs-identifier hs-var hs-var">numTriples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245231"><span class="hs-identifier hs-var">triples</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-comment">-- abcRegionSize is the combined size of regions A, B, and C</span><span>
</span><span id="line-641"></span><span>    </span><span id="local-6989586621679245164"><span class="annot"><span class="annottext">abcRegionSize :: Int
</span><a href="#local-6989586621679245164"><span class="hs-identifier hs-var hs-var">abcRegionSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245230"><span class="hs-identifier hs-var">numTriples</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679245173"><span class="annot"><span class="annottext">pidSize :: Int
</span><a href="#local-6989586621679245173"><span class="hs-identifier hs-var hs-var">pidSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall h (proxy :: * -&gt; *). HashAlgorithm h =&gt; proxy h -&gt; Word
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-crypto-class-2.1.0.1-c762b570cf40f8cd35d15c1899429c392d4cc06de39a6636725516f614c3ad0c/share/doc/html/src"><span class="hs-identifier hs-var">Hash.sizeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246835"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-comment">-- pids is the collection of all distinct pids</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621679245161"><span class="annot"><span class="annottext">pids :: Set (PolicyID c)
</span><a href="#local-6989586621679245161"><span class="hs-identifier hs-var hs-var">pids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679245159"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245159"><span class="hs-identifier hs-var">pid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245159"><span class="hs-identifier hs-var">pid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245231"><span class="hs-identifier hs-var">triples</span></a></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><a href="#local-6989586621679245181"><span class="hs-identifier hs-type">pidOffsetMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246835"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-649"></span><span>    </span><span id="local-6989586621679245181"><span class="annot"><span class="annottext">pidOffsetMap :: Map (PolicyID c) Word16
</span><a href="#local-6989586621679245181"><span class="hs-identifier hs-var hs-var">pidOffsetMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-650"></span><span>      </span><span class="hs-comment">-- the pid offsets are:</span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-comment">--   X, X + s, X + 2s, X + 3s, ...</span><span>
</span><span id="line-652"></span><span>      </span><span class="hs-comment">-- where X is the start of block D and s is the size of a pid</span><span>
</span><span id="line-653"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245158"><span class="annot"><span class="annottext">offsets :: [Word16]
</span><a href="#local-6989586621679245158"><span class="hs-identifier hs-var hs-var">offsets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-654"></span><span>            </span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">enumFromThen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245164"><span class="hs-identifier hs-var">abcRegionSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245164"><span class="hs-identifier hs-var">abcRegionSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245173"><span class="hs-identifier hs-var">pidSize</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (PolicyID c)
</span><a href="#local-6989586621679245161"><span class="hs-identifier hs-var">pids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679245158"><span class="hs-identifier hs-var">offsets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679245155"><span class="annot"><span class="annottext">pidOffset :: PolicyID c -&gt; Word16
</span><a href="#local-6989586621679245155"><span class="hs-identifier hs-var hs-var">pidOffset</span></a></span></span><span> </span><span id="local-6989586621679245154"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245154"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245154"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) Word16
</span><a href="#local-6989586621679245181"><span class="hs-identifier hs-var">pidOffsetMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span>    </span><span id="local-6989586621679245152"><span class="annot"><span class="annottext">pidBlockSize :: Int
</span><a href="#local-6989586621679245152"><span class="hs-identifier hs-var hs-var">pidBlockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set (PolicyID c)
</span><a href="#local-6989586621679245161"><span class="hs-identifier hs-var">pids</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245173"><span class="hs-identifier hs-var">pidSize</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-comment">-- Putting asset names in descending order ensures that the empty string</span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-comment">-- is last, so the associated offset is pointing to the end of the array</span><span>
</span><span id="line-663"></span><span>    </span><span id="local-6989586621679245150"><span class="annot"><span class="annottext">assetNames :: [AssetName]
</span><a href="#local-6989586621679245150"><span class="hs-identifier hs-var hs-var">assetNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toDescList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245148"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245148"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245148"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245231"><span class="hs-identifier hs-var">triples</span></a></span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621679245147"><span class="annot"><span class="annottext">assetNameLengths :: [Int]
</span><a href="#local-6989586621679245147"><span class="hs-identifier hs-var hs-var">assetNameLengths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int
</span><span class="hs-identifier hs-var">SBS.length</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetName"><span class="hs-identifier hs-var">assetName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[AssetName]
</span><a href="#local-6989586621679245150"><span class="hs-identifier hs-var">assetNames</span></a></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span>    </span><span class="annot"><a href="#local-6989586621679245172"><span class="hs-identifier hs-type">assetNameOffsetMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679245172"><span class="annot"><span class="annottext">assetNameOffsetMap :: Map AssetName Word16
</span><a href="#local-6989586621679245172"><span class="hs-identifier hs-var hs-var">assetNameOffsetMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-669"></span><span>      </span><span class="hs-comment">-- The asset name offsets are the running sum of the asset lengths,</span><span>
</span><span id="line-670"></span><span>      </span><span class="hs-comment">-- but starting with the offset of the start of block E.</span><span>
</span><span id="line-671"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245146"><span class="annot"><span class="annottext">offsets :: [Int]
</span><a href="#local-6989586621679245146"><span class="hs-identifier hs-var hs-var">offsets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">scanl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245164"><span class="hs-identifier hs-var">abcRegionSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245152"><span class="hs-identifier hs-var">pidBlockSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679245147"><span class="hs-identifier hs-var">assetNameLengths</span></a></span><span>
</span><span id="line-672"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[AssetName]
</span><a href="#local-6989586621679245150"><span class="hs-identifier hs-var">assetNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679245146"><span class="hs-identifier hs-var">offsets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679245141"><span class="annot"><span class="annottext">assetNameOffset :: AssetName -&gt; Word16
</span><a href="#local-6989586621679245141"><span class="hs-identifier hs-var hs-var">assetNameOffset</span></a></span></span><span> </span><span id="local-6989586621679245140"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245140"><span class="hs-identifier hs-var">aname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245140"><span class="hs-identifier hs-var">aname</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Word16
</span><a href="#local-6989586621679245172"><span class="hs-identifier hs-var">assetNameOffsetMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679245139"><span class="annot"><span class="annottext">anameBlockSize :: Int
</span><a href="#local-6989586621679245139"><span class="hs-identifier hs-var hs-var">anameBlockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679245147"><span class="hs-identifier hs-var">assetNameLengths</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-comment">-- size = size(A+B+C)      + size(D)      + size(E)</span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621679245188"><span class="annot"><span class="annottext">repSize :: Int
</span><a href="#local-6989586621679245188"><span class="hs-identifier hs-var hs-var">repSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245164"><span class="hs-identifier hs-var">abcRegionSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245152"><span class="hs-identifier hs-var">pidBlockSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245139"><span class="hs-identifier hs-var">anameBlockSize</span></a></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>    </span><span id="local-6989586621679245232"><span class="annot"><span class="annottext">prepare :: (PolicyID c, AssetName, Integer) -&gt; Maybe (Word16, Word16, Word64)
</span><a href="#local-6989586621679245232"><span class="hs-identifier hs-var hs-var">prepare</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245137"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245137"><span class="hs-identifier hs-var">pid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245136"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245136"><span class="hs-identifier hs-var">aname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245135"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245135"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-682"></span><span>      </span><span id="local-6989586621679245134"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245134"><span class="hs-identifier hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Word64
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">integerToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679245135"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID c -&gt; Word16
</span><a href="#local-6989586621679245155"><span class="hs-identifier hs-var">pidOffset</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245137"><span class="hs-identifier hs-var">pid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; Word16
</span><a href="#local-6989586621679245141"><span class="hs-identifier hs-var">assetNameOffset</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245136"><span class="hs-identifier hs-var">aname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245134"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-comment">-- | Unlike `representationSize`, this function cheaply checks whether</span><span>
</span><span id="line-686"></span><span class="hs-comment">-- any offset within a MultiAsset compact representation is likely to overflow Word16.</span><span>
</span><span id="line-687"></span><span class="hs-comment">--</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- compact form inequality:</span><span>
</span><span id="line-689"></span><span class="hs-comment">--   8n (Word64) + 2n (Word16) + 2n (Word16) + 28p (policy ids) + sum of lengths of unique asset names &lt;= 65535</span><span>
</span><span id="line-690"></span><span class="hs-comment">-- maximum size for the asset name is 32 bytes, so:</span><span>
</span><span id="line-691"></span><span class="hs-comment">-- 8n + 2n + 2n + 28p + 32n &lt;= 65535</span><span>
</span><span id="line-692"></span><span class="hs-comment">-- where: n = total number of assets, p = number of unique policy ids</span><span>
</span><span id="line-693"></span><span id="local-6989586621679246885"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#isMultiAssetSmallEnough"><span class="hs-identifier hs-type">isMultiAssetSmallEnough</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246885"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-694"></span><span id="isMultiAssetSmallEnough"><span class="annot"><span class="annottext">isMultiAssetSmallEnough :: forall c. MultiAsset c -&gt; Bool
</span><a href="Cardano.Ledger.Mary.Value.html#isMultiAssetSmallEnough"><span class="hs-identifier hs-var hs-var">isMultiAssetSmallEnough</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679245121"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245121"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-695"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">44</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Sum a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">M.getSum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Sum a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">M.Sum</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245121"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">28</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679245121"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">65535</span></span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#representationSize"><span class="hs-identifier hs-type">representationSize</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246950"><span class="annot"><a href="#local-6989586621679246950"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-699"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246950"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246950"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-701"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-702"></span><span id="representationSize"><span class="annot"><span class="annottext">representationSize :: forall c. Crypto c =&gt; [(PolicyID c, AssetName, Integer)] -&gt; Int
</span><a href="Cardano.Ledger.Mary.Value.html#representationSize"><span class="hs-identifier hs-var hs-var">representationSize</span></a></span></span><span> </span><span id="local-6989586621679245102"><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245102"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245101"><span class="hs-identifier hs-var">abcRegionSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245100"><span class="hs-identifier hs-var">pidBlockSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245099"><span class="hs-identifier hs-var">anameBlockSize</span></a></span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621679245098"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679245098"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245102"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-705"></span><span>    </span><span id="local-6989586621679245101"><span class="annot"><span class="annottext">abcRegionSize :: Int
</span><a href="#local-6989586621679245101"><span class="hs-identifier hs-var hs-var">abcRegionSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245098"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>    </span><span id="local-6989586621679245097"><span class="annot"><span class="annottext">numPids :: Int
</span><a href="#local-6989586621679245097"><span class="hs-identifier hs-var hs-var">numPids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679245096"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245096"><span class="hs-identifier hs-var">pid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679245096"><span class="hs-identifier hs-var">pid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245102"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679245095"><span class="annot"><span class="annottext">pidSize :: Int
</span><a href="#local-6989586621679245095"><span class="hs-identifier hs-var hs-var">pidSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall h (proxy :: * -&gt; *). HashAlgorithm h =&gt; proxy h -&gt; Word
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-crypto-class-2.1.0.1-c762b570cf40f8cd35d15c1899429c392d4cc06de39a6636725516f614c3ad0c/share/doc/html/src"><span class="hs-identifier hs-var">Hash.sizeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246950"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>    </span><span id="local-6989586621679245100"><span class="annot"><span class="annottext">pidBlockSize :: Int
</span><a href="#local-6989586621679245100"><span class="hs-identifier hs-var hs-var">pidBlockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245097"><span class="hs-identifier hs-var">numPids</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245095"><span class="hs-identifier hs-var">pidSize</span></a></span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span>    </span><span id="local-6989586621679245094"><span class="annot"><span class="annottext">assetNames :: Set AssetName
</span><a href="#local-6989586621679245094"><span class="hs-identifier hs-var hs-var">assetNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245093"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245093"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679245093"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245102"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-712"></span><span>    </span><span id="local-6989586621679245099"><span class="annot"><span class="annottext">anameBlockSize :: Int
</span><a href="#local-6989586621679245099"><span class="hs-identifier hs-var hs-var">anameBlockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-713"></span><span>      </span><span class="annot"><span class="annottext">forall a. Sum a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Semigroup.getSum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Sum a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Semigroup.Sum</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int
</span><span class="hs-identifier hs-var">SBS.length</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#assetName"><span class="hs-identifier hs-var">assetName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set AssetName
</span><a href="#local-6989586621679245094"><span class="hs-identifier hs-var">assetNames</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246834"><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValue"><span class="hs-identifier hs-type">CompactValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-716"></span><span id="from"><span class="annot"><span class="annottext">from :: forall c. Crypto c =&gt; CompactValue c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueAdaOnly"><span class="hs-identifier hs-type">CompactValueAdaOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">CompactCoin</span></a></span><span> </span><span id="local-6989586621679245045"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245045"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245045"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#from"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#CompactValueMultiAsset"><span class="hs-identifier hs-type">CompactValueMultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">CompactCoin</span></a></span><span> </span><span id="local-6989586621679245044"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245044"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679245043"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679245043"><span class="hs-identifier hs-var">numAssets</span></a></span></span><span> </span><span id="local-6989586621679245042"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245042"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245041"><span class="annot"><span class="annottext">mv :: MaryValue c
</span><a href="#local-6989586621679245041"><span class="hs-identifier hs-var">mv</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679245040"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245040"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Integer -&gt; [(PolicyID era, AssetName, Integer)] -&gt; MaryValue era
</span><a href="Cardano.Ledger.Mary.Value.html#valueFromList"><span class="hs-identifier hs-var">valueFromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245044"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245039"><span class="hs-identifier hs-var">triples</span></a></span><span>
</span><span id="line-719"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. MultiAsset c -&gt; Bool
</span><a href="Cardano.Ledger.Mary.Value.html#isMultiAssetSmallEnough"><span class="hs-identifier hs-var">isMultiAssetSmallEnough</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679245040"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679245041"><span class="hs-identifier hs-var">mv</span></a></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-721"></span><span>    </span><span id="local-6989586621679245038"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679245038"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679245043"><span class="hs-identifier hs-var">numAssets</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span>    </span><span id="local-6989586621679245037"><span class="annot"><span class="annottext">ba :: ByteArray
</span><a href="#local-6989586621679245037"><span class="hs-identifier hs-var hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteArray
</span><a href="Cardano.Ledger.Mary.Value.html#sbsToByteArray"><span class="hs-identifier hs-var">sbsToByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245042"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><a href="#local-6989586621679245036"><span class="hs-identifier hs-type">getTripleForIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>    </span><span id="local-6989586621679245036"><span class="annot"><span class="annottext">getTripleForIndex :: Int -&gt; (Word16, Word16, Word64)
</span><a href="#local-6989586621679245036"><span class="hs-identifier hs-var hs-var">getTripleForIndex</span></a></span></span><span> </span><span id="local-6989586621679245035"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245035"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-727"></span><span>      </span><span class="hs-comment">-- indexByteArray indices are in terms of the size of the value being indexed</span><span>
</span><span id="line-728"></span><span>      </span><span class="hs-comment">-- rather than byte offsets.</span><span>
</span><span id="line-729"></span><span>      </span><span class="hs-comment">-- The corresponding byte offsets are:</span><span>
</span><span id="line-730"></span><span>      </span><span class="hs-comment">-- q: 0 + 8i</span><span>
</span><span id="line-731"></span><span>      </span><span class="hs-comment">-- pidix: 8n + 2i</span><span>
</span><span id="line-732"></span><span>      </span><span class="hs-comment">-- anameix: 8n + 2n + 2i</span><span>
</span><span id="line-733"></span><span>      </span><span class="hs-comment">-- Dividing by the sized (resp 8,2,2) yields the indices below</span><span>
</span><span id="line-734"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245034"><span class="annot"><span class="annottext">q :: Word64
</span><a href="#local-6989586621679245034"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">BA.indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679245037"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245035"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-735"></span><span>          </span><span id="local-6989586621679245032"><span class="annot"><span class="annottext">pidix :: Word16
</span><a href="#local-6989586621679245032"><span class="hs-identifier hs-var hs-var">pidix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">BA.indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679245037"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245038"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245035"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>          </span><span id="local-6989586621679245031"><span class="annot"><span class="annottext">anameix :: Word16
</span><a href="#local-6989586621679245031"><span class="hs-identifier hs-var hs-var">anameix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">BA.indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679245037"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245038"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679245035"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245032"><span class="hs-identifier hs-var">pidix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245031"><span class="hs-identifier hs-var">anameix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245034"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-comment">-- raw triples :: [(pid offset, asset name offset, quantity)]</span><span>
</span><span id="line-740"></span><span>    </span><span class="annot"><a href="#local-6989586621679245030"><span class="hs-identifier hs-type">rawTriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-741"></span><span>    </span><span id="local-6989586621679245030"><span class="annot"><span class="annottext">rawTriples :: [(Word16, Word16, Word64)]
</span><a href="#local-6989586621679245030"><span class="hs-identifier hs-var hs-var">rawTriples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Word16, Word16, Word64)
</span><a href="#local-6989586621679245036"><span class="hs-identifier hs-var">getTripleForIndex</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679245043"><span class="hs-identifier hs-var">numAssets</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-742"></span><span>
</span><span id="line-743"></span><span>    </span><span class="annot"><a href="#local-6989586621679245039"><span class="hs-identifier hs-type">triples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-744"></span><span>    </span><span id="local-6989586621679245039"><span class="annot"><span class="annottext">triples :: [(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679245039"><span class="hs-identifier hs-var hs-var">triples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16, Word16, Word64) -&gt; (PolicyID c, AssetName, Integer)
</span><a href="#local-6989586621679245029"><span class="hs-identifier hs-var">convertTriple</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word16, Word16, Word64)]
</span><a href="#local-6989586621679245030"><span class="hs-identifier hs-var">rawTriples</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span>    </span><span class="hs-comment">-- Asset name length are calculated by subtracting the offset from the</span><span>
</span><span id="line-747"></span><span>    </span><span class="hs-comment">-- next greater offset (or from the end of the rep, if there is none.)</span><span>
</span><span id="line-748"></span><span>    </span><span class="hs-comment">-- For an index pointing to the end of the array, the associated</span><span>
</span><span id="line-749"></span><span>    </span><span class="hs-comment">-- length will be: offset - length(rep) = 0</span><span>
</span><span id="line-750"></span><span>    </span><span id="local-6989586621679245028"><span class="annot"><span class="annottext">assetLens :: Map Word16 Int
</span><a href="#local-6989586621679245028"><span class="hs-identifier hs-var hs-var">assetLens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-751"></span><span>      </span><span class="hs-comment">-- This assumes that the triples are ordered by nondecreasing asset name offset</span><span>
</span><span id="line-752"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245026"><span class="annot"><span class="annottext">ixs :: [Word16]
</span><a href="#local-6989586621679245026"><span class="hs-identifier hs-var hs-var">ixs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="Cardano.Ledger.Mary.Value.html#nubOrd"><span class="hs-identifier hs-var">nubOrd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245024"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245024"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245024"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Word16, Word16, Word64)]
</span><a href="#local-6989586621679245030"><span class="hs-identifier hs-var">rawTriples</span></a></span><span>
</span><span id="line-753"></span><span>          </span><span id="local-6989586621679245023"><span class="annot"><span class="annottext">ixPairs :: [(Word16, Word16)]
</span><a href="#local-6989586621679245023"><span class="hs-identifier hs-var hs-var">ixPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679245026"><span class="hs-identifier hs-var">ixs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679245026"><span class="hs-identifier hs-var">ixs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int
</span><span class="hs-identifier hs-var">SBS.length</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245042"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679245021"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245021"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245020"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245020"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245021"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245020"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245021"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word16, Word16)]
</span><a href="#local-6989586621679245023"><span class="hs-identifier hs-var">ixPairs</span></a></span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><a href="#local-6989586621679245019"><span class="hs-identifier hs-type">assetLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-756"></span><span>    </span><span id="local-6989586621679245019"><span class="annot"><span class="annottext">assetLen :: Word16 -&gt; Int
</span><a href="#local-6989586621679245019"><span class="hs-identifier hs-var hs-var">assetLen</span></a></span></span><span> </span><span id="local-6989586621679245018"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245018"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245018"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Map Word16 Int
</span><a href="#local-6989586621679245028"><span class="hs-identifier hs-var">assetLens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>    </span><span class="annot"><a href="#local-6989586621679245029"><span class="hs-identifier hs-type">convertTriple</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-759"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>    </span><span id="local-6989586621679245029"><span class="annot"><span class="annottext">convertTriple :: (Word16, Word16, Word64) -&gt; (PolicyID c, AssetName, Integer)
</span><a href="#local-6989586621679245029"><span class="hs-identifier hs-var hs-var">convertTriple</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245017"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245017"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245016"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245016"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679245015"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245015"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-761"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall c. ScriptHash c -&gt; PolicyID c
</span><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-var">PolicyID</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-762"></span><span>          </span><span class="annot"><span class="annottext">forall c. Hash (ADDRHASH c) EraIndependentScript -&gt; ScriptHash c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-763"></span><span>            </span><span class="annot"><span class="annottext">forall h a. HashAlgorithm h =&gt; ShortByteString -&gt; Hash h a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-crypto-class-2.1.0.1-c762b570cf40f8cd35d15c1899429c392d4cc06de39a6636725516f614c3ad0c/share/doc/html/src"><span class="hs-identifier hs-var">Hash.UnsafeHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-764"></span><span>              </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int -&gt; Int -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#readShortByteString"><span class="hs-identifier hs-var">readShortByteString</span></a></span><span>
</span><span id="line-765"></span><span>                </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245042"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-766"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245017"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall h (proxy :: * -&gt; *). HashAlgorithm h =&gt; proxy h -&gt; Word
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-crypto-class-2.1.0.1-c762b570cf40f8cd35d15c1899429c392d4cc06de39a6636725516f614c3ad0c/share/doc/html/src"><span class="hs-identifier hs-var">Hash.sizeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ADDRHASH</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; AssetName
</span><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-var">AssetName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int -&gt; Int -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#readShortByteString"><span class="hs-identifier hs-var">readShortByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679245042"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245016"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Int
</span><a href="#local-6989586621679245019"><span class="hs-identifier hs-var">assetLen</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679245016"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679245015"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-770"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="hs-comment">-- | Strip out duplicates</span><span>
</span><span id="line-773"></span><span id="local-6989586621679246756"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#nubOrd"><span class="hs-identifier hs-type">nubOrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246756"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679246756"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679246756"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-774"></span><span id="nubOrd"><span class="annot"><span class="annottext">nubOrd :: forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="Cardano.Ledger.Mary.Value.html#nubOrd"><span class="hs-identifier hs-var hs-var">nubOrd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-775"></span><span>  </span><span class="annot"><span class="annottext">forall {a}. Ord a =&gt; Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679245008"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679245008"><span class="annot"><span class="annottext">loop :: Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679245008"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><a href="#local-6989586621679245008"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679245004"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679245004"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679245003"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679245003"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679245002"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679245002"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679245003"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679245004"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679245008"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679245004"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679245002"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-780"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-781"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679245000"><span class="annot"><span class="annottext">s' :: Set a
</span><a href="#local-6989586621679245000"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679245003"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679245004"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679245000"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679245003"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679245008"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679245000"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679245002"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#sbsToByteArray"><span class="hs-identifier hs-type">sbsToByteArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShortByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BA.ByteArray</span></span><span>
</span><span id="line-784"></span><span id="sbsToByteArray"><span class="annot"><span class="annottext">sbsToByteArray :: ShortByteString -&gt; ByteArray
</span><a href="Cardano.Ledger.Mary.Value.html#sbsToByteArray"><span class="hs-identifier hs-var hs-var">sbsToByteArray</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SBS</span></span><span> </span><span id="local-6989586621679244998"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679244998"><span class="hs-identifier hs-var">bah</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray
</span><span class="hs-identifier hs-var">BA.ByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679244998"><span class="hs-identifier hs-var">bah</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#byteArrayToSbs"><span class="hs-identifier hs-type">byteArrayToSbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BA.ByteArray</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShortByteString</span></span><span>
</span><span id="line-787"></span><span id="byteArrayToSbs"><span class="annot"><span class="annottext">byteArrayToSbs :: ByteArray -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#byteArrayToSbs"><span class="hs-identifier hs-var hs-var">byteArrayToSbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BA.ByteArray</span></span><span> </span><span id="local-6989586621679244996"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679244996"><span class="hs-identifier hs-var">bah</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ShortByteString
</span><span class="hs-identifier hs-var">SBS</span></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679244996"><span class="hs-identifier hs-var">bah</span></a></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#readShortByteString"><span class="hs-identifier hs-type">readShortByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShortByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShortByteString</span></span><span>
</span><span id="line-790"></span><span id="readShortByteString"><span class="annot"><span class="annottext">readShortByteString :: ShortByteString -&gt; Int -&gt; Int -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#readShortByteString"><span class="hs-identifier hs-var hs-var">readShortByteString</span></a></span></span><span> </span><span id="local-6989586621679244995"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679244995"><span class="hs-identifier hs-var">sbs</span></a></span></span><span> </span><span id="local-6989586621679244994"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244994"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679244993"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244993"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-791"></span><span>  </span><span class="annot"><span class="annottext">ByteArray -&gt; ShortByteString
</span><a href="Cardano.Ledger.Mary.Value.html#byteArrayToSbs"><span class="hs-identifier hs-var">byteArrayToSbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Int -&gt; ByteArray
</span><span class="hs-identifier hs-var">BA.cloneByteArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteArray
</span><a href="Cardano.Ledger.Mary.Value.html#sbsToByteArray"><span class="hs-identifier hs-var">sbsToByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679244995"><span class="hs-identifier hs-var">sbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244994"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244993"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-794"></span><span class="hs-comment">-- Operations on Values</span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span class="hs-comment">-- | Extract the set of policies in the Value.</span><span>
</span><span id="line-797"></span><span class="hs-comment">--</span><span>
</span><span id="line-798"></span><span class="hs-comment">--   This function is equivalent to computing the support of the value in the</span><span>
</span><span id="line-799"></span><span class="hs-comment">--   spec.</span><span>
</span><span id="line-800"></span><span id="local-6989586621679246743"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#policies"><span class="hs-identifier hs-type">policies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246743"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246743"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-801"></span><span id="policies"><span class="annot"><span class="annottext">policies :: forall c. MultiAsset c -&gt; Set (PolicyID c)
</span><a href="Cardano.Ledger.Mary.Value.html#policies"><span class="hs-identifier hs-var hs-var">policies</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679244991"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244991"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244991"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span id="local-6989586621679246739"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246739"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246739"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span>
</span><span id="line-804"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: forall c. PolicyID c -&gt; AssetName -&gt; MaryValue c -&gt; Integer
</span><a href="Cardano.Ledger.Mary.Value.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. PolicyID c -&gt; AssetName -&gt; MaryValue c -&gt; Integer
</span><a href="Cardano.Ledger.Mary.Value.html#lookupMultiAsset"><span class="hs-identifier hs-var">lookupMultiAsset</span></a></span><span>
</span><span id="line-805"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">lookup</span><span> </span><span class="hs-pragma">&quot;In favor of `lookupMultiAsset`&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span id="local-6989586621679244989"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#lookupMultiAsset"><span class="hs-identifier hs-type">lookupMultiAsset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244989"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244989"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span>
</span><span id="line-808"></span><span id="lookupMultiAsset"><span class="annot"><span class="annottext">lookupMultiAsset :: forall c. PolicyID c -&gt; AssetName -&gt; MaryValue c -&gt; Integer
</span><a href="Cardano.Ledger.Mary.Value.html#lookupMultiAsset"><span class="hs-identifier hs-var hs-var">lookupMultiAsset</span></a></span></span><span> </span><span id="local-6989586621679244985"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244985"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span id="local-6989586621679244984"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244984"><span class="hs-identifier hs-var">aid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679244983"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244983"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244985"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244983"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Map AssetName Integer)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-811"></span><span>    </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679244982"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244982"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">Map.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244984"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244982"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span class="hs-comment">-- | insert comb policy asset n v,</span><span>
</span><span id="line-814"></span><span class="hs-comment">--   if comb = \ old new -&gt; old, the integer in the MultiAsset is prefered over n</span><span>
</span><span id="line-815"></span><span class="hs-comment">--   if comb = \ old new -&gt; new, then n is prefered over the integer in the MultiAsset</span><span>
</span><span id="line-816"></span><span class="hs-comment">--   if (comb old new) == 0, then that value should not be stored in the MultiAsset</span><span>
</span><span id="line-817"></span><span id="local-6989586621679246735"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-818"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-819"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246735"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-820"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-821"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-822"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246735"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-823"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246735"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-824"></span><span id="insert"><span class="annot"><span class="annottext">insert :: forall c.
(Integer -&gt; Integer -&gt; Integer)
-&gt; PolicyID c
-&gt; AssetName
-&gt; Integer
-&gt; MultiAsset c
-&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c.
(Integer -&gt; Integer -&gt; Integer)
-&gt; PolicyID c
-&gt; AssetName
-&gt; Integer
-&gt; MultiAsset c
-&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#insertMultiAsset"><span class="hs-identifier hs-var">insertMultiAsset</span></a></span><span>
</span><span id="line-825"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">insert</span><span> </span><span class="hs-pragma">&quot;In favor of `insertMultiAsset`&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="hs-comment">-- | insertMultiAsset comb policy asset n v,</span><span>
</span><span id="line-828"></span><span class="hs-comment">--   if comb = \ old new -&gt; old, the integer in the MultiAsset is prefered over n</span><span>
</span><span id="line-829"></span><span class="hs-comment">--   if comb = \ old new -&gt; new, then n is prefered over the integer in the MultiAsset</span><span>
</span><span id="line-830"></span><span class="hs-comment">--   if (comb old new) == 0, then that value should not be stored in the MultiAsset</span><span>
</span><span id="line-831"></span><span id="local-6989586621679244980"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#insertMultiAsset"><span class="hs-identifier hs-type">insertMultiAsset</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-833"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244980"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-834"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-835"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-836"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244980"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-837"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244980"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-838"></span><span id="insertMultiAsset"><span class="annot"><span class="annottext">insertMultiAsset :: forall c.
(Integer -&gt; Integer -&gt; Integer)
-&gt; PolicyID c
-&gt; AssetName
-&gt; Integer
-&gt; MultiAsset c
-&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#insertMultiAsset"><span class="hs-identifier hs-var hs-var">insertMultiAsset</span></a></span></span><span> </span><span id="local-6989586621679244970"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679244970"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679244969"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244969"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span id="local-6989586621679244968"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244968"><span class="hs-identifier hs-var">aid</span></a></span></span><span> </span><span id="local-6989586621679244967"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679244966"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244966"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244969"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244966"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679244964"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679244963"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244962"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-841"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244968"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-842"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679244961"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244961"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679244960"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244960"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244959"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244959"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-843"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244958"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-844"></span><span>            </span><span class="hs-keyword">then</span><span>
</span><span id="line-845"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244957"><span class="annot"><span class="annottext">m3 :: Map AssetName Integer
</span><a href="#local-6989586621679244957"><span class="hs-identifier hs-var hs-var">m3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244961"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244959"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-846"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244957"><span class="hs-identifier hs-var">m3</span></a></span><span>
</span><span id="line-847"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244969"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244957"><span class="hs-identifier hs-var">m3</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244969"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244968"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244958"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244961"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244959"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-851"></span><span>            </span><span id="local-6989586621679244958"><span class="annot"><span class="annottext">n :: Integer
</span><a href="#local-6989586621679244958"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621679244970"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244960"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-852"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AssetName Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-853"></span><span>          </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span>
</span><span id="line-854"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span>
</span><span id="line-855"></span><span>                </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244969"><span class="hs-identifier hs-var">pid</span></a></span><span>
</span><span id="line-856"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-857"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-858"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244968"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-859"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>                </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-861"></span><span>                </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-862"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679244955"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244955"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Map AssetName Integer)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244954"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244954"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-864"></span><span>      </span><span class="annot"><span class="annottext">forall c. Map (PolicyID c) (Map AssetName Integer) -&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-var">MultiAsset</span></a></span><span>
</span><span id="line-865"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-866"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link2</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244955"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244954"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-867"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">link</span></span><span> </span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244969"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244968"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244955"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244954"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-868"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-comment">-- ========================================================</span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span class="hs-comment">-- | Remove 0 assets from a map</span><span>
</span><span id="line-873"></span><span id="local-6989586621679246876"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#prune"><span class="hs-identifier hs-type">prune</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-874"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246876"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246876"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-876"></span><span id="prune"><span class="annot"><span class="annottext">prune :: forall c.
Map (PolicyID c) (Map AssetName Integer)
-&gt; Map (PolicyID c) (Map AssetName Integer)
</span><a href="Cardano.Ledger.Mary.Value.html#prune"><span class="hs-identifier hs-var hs-var">prune</span></a></span></span><span> </span><span id="local-6989586621679244948"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244948"><span class="hs-identifier hs-var">assets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-877"></span><span>  </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244948"><span class="hs-identifier hs-var">assets</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">-- | Rather than using prune to remove 0 assets, when can avoid adding them in the</span><span>
</span><span id="line-880"></span><span class="hs-comment">--   first place by using valueFromList to construct a MultiAsset</span><span>
</span><span id="line-881"></span><span id="local-6989586621679246719"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#multiAssetFromList"><span class="hs-identifier hs-type">multiAssetFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246719"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246719"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-882"></span><span id="multiAssetFromList"><span class="annot"><span class="annottext">multiAssetFromList :: forall era. [(PolicyID era, AssetName, Integer)] -&gt; MultiAsset era
</span><a href="Cardano.Ledger.Mary.Value.html#multiAssetFromList"><span class="hs-identifier hs-var hs-var">multiAssetFromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679244939"><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679244939"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244938"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244938"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244937"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244937"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679244936"><span class="annot"><span class="annottext">MultiAsset era
</span><a href="#local-6989586621679244936"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c.
(Integer -&gt; Integer -&gt; Integer)
-&gt; PolicyID c
-&gt; AssetName
-&gt; Integer
-&gt; MultiAsset c
-&gt; MultiAsset c
</span><a href="Cardano.Ledger.Mary.Value.html#insertMultiAsset"><span class="hs-identifier hs-var">insertMultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyID era
</span><a href="#local-6989586621679244939"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244938"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244937"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset era
</span><a href="#local-6989586621679244936"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span id="local-6989586621679246760"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#valueFromList"><span class="hs-identifier hs-type">valueFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246760"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246760"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-885"></span><span id="valueFromList"><span class="annot"><span class="annottext">valueFromList :: forall era.
Integer -&gt; [(PolicyID era, AssetName, Integer)] -&gt; MaryValue era
</span><a href="Cardano.Ledger.Mary.Value.html#valueFromList"><span class="hs-identifier hs-var hs-var">valueFromList</span></a></span></span><span> </span><span id="local-6989586621679244935"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244935"><span class="hs-identifier hs-var">ada</span></a></span></span><span> </span><span id="local-6989586621679244934"><span class="annot"><span class="annottext">[(PolicyID era, AssetName, Integer)]
</span><a href="#local-6989586621679244934"><span class="hs-identifier hs-var">triples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Integer -&gt; MultiAsset c -&gt; MaryValue c
</span><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-var">MaryValue</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244935"><span class="hs-identifier hs-var">ada</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. [(PolicyID era, AssetName, Integer)] -&gt; MultiAsset era
</span><a href="Cardano.Ledger.Mary.Value.html#multiAssetFromList"><span class="hs-identifier hs-var">multiAssetFromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID era, AssetName, Integer)]
</span><a href="#local-6989586621679244934"><span class="hs-identifier hs-var">triples</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span class="hs-comment">-- | Display a MaryValue as a String, one token per line</span><span>
</span><span id="line-888"></span><span id="local-6989586621679244933"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#showValue"><span class="hs-identifier hs-type">showValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244933"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span></span><span>
</span><span id="line-889"></span><span id="showValue"><span class="annot"><span class="annottext">showValue :: forall c. MaryValue c -&gt; String
</span><a href="Cardano.Ledger.Mary.Value.html#showValue"><span class="hs-identifier hs-var hs-var">showValue</span></a></span></span><span> </span><span id="local-6989586621679244927"><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679244927"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244926"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {c}.
(Show a, Show a) =&gt;
(PolicyID c, a, a) -&gt; String
</span><a href="#local-6989586621679244924"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679244923"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-891"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679244926"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244926"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244923"><span class="annot"><span class="annottext">[(PolicyID c, AssetName, Integer)]
</span><a href="#local-6989586621679244923"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c.
MaryValue c -&gt; (Integer, [(PolicyID c, AssetName, Integer)])
</span><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-var">gettriples</span></a></span><span> </span><span class="annot"><span class="annottext">MaryValue c
</span><a href="#local-6989586621679244927"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-892"></span><span>    </span><span id="local-6989586621679244924"><span class="annot"><span class="annottext">trans :: (PolicyID c, a, a) -&gt; String
</span><a href="#local-6989586621679244924"><span class="hs-identifier hs-var hs-var">trans</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span id="local-6989586621679244914"><span class="annot"><span class="annottext">ScriptHash c
</span><a href="#local-6989586621679244914"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244913"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244913"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244912"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244912"><span class="hs-identifier hs-var">cnt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-893"></span><span>      </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash c
</span><a href="#local-6989586621679244914"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-894"></span><span>        </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,  &quot;</span></span><span>
</span><span id="line-895"></span><span>        </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244913"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-896"></span><span>        </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,  &quot;</span></span><span>
</span><span id="line-897"></span><span>        </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244912"><span class="hs-identifier hs-var">cnt</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- | Turn the nested 'MaryValue' map-of-maps representation into a flat sequence</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- of policyID, asset name and quantity, plus separately the ada quantity.</span><span>
</span><span id="line-901"></span><span id="local-6989586621679246947"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-type">gettriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246947"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246947"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-902"></span><span id="gettriples"><span class="annot"><span class="annottext">gettriples :: forall c.
MaryValue c -&gt; (Integer, [(PolicyID c, AssetName, Integer)])
</span><a href="Cardano.Ledger.Mary.Value.html#gettriples"><span class="hs-identifier hs-var hs-var">gettriples</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span id="local-6989586621679244911"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244911"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679244910"><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679244910"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244911"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall c. MultiAsset c -&gt; [(PolicyID c, AssetName, Integer)]
</span><a href="Cardano.Ledger.Mary.Value.html#flattenMultiAsset"><span class="hs-identifier hs-var">flattenMultiAsset</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAsset c
</span><a href="#local-6989586621679244910"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span id="local-6989586621679246709"><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#flattenMultiAsset"><span class="hs-identifier hs-type">flattenMultiAsset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246709"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246709"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-905"></span><span id="flattenMultiAsset"><span class="annot"><span class="annottext">flattenMultiAsset :: forall c. MultiAsset c -&gt; [(PolicyID c, AssetName, Integer)]
</span><a href="Cardano.Ledger.Mary.Value.html#flattenMultiAsset"><span class="hs-identifier hs-var hs-var">flattenMultiAsset</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span id="local-6989586621679244909"><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244909"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-906"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244908"><span class="hs-identifier hs-var">policyId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244907"><span class="hs-identifier hs-var">aname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244906"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679244908"><span class="annot"><span class="annottext">PolicyID c
</span><a href="#local-6989586621679244908"><span class="hs-identifier hs-var">policyId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244905"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244905"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">assocs</span></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID c) (Map AssetName Integer)
</span><a href="#local-6989586621679244909"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679244907"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244907"><span class="hs-identifier hs-var">aname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244906"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679244906"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">assocs</span></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679244905"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-909"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span class="hs-comment">-- ==========================================</span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679244901"><span id="local-6989586621679244903"><span id="local-6989586621679246705"><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MaryValue"><span class="hs-identifier hs-type">MaryValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246705"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679244896"><span id="local-6989586621679244898"><span id="local-6989586621679246704"><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#MultiAsset"><span class="hs-identifier hs-type">MultiAsset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246704"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679244892"><span id="local-6989586621679244894"><span id="local-6989586621679246703"><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#PolicyID"><span class="hs-identifier hs-type">PolicyID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246703"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679244889"><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Mary.Value.html#AssetName"><span class="hs-identifier hs-type">AssetName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-920"></span><span>  </span><span id="local-6989586621679244886"><span class="annot"><span class="annottext">toExpr :: AssetName -&gt; Expr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toExpr</span></span></span><span> </span><span id="local-6989586621679244884"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244884"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Expr] -&gt; Expr
</span><span class="hs-identifier hs-var">App</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AssetName&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. ToExpr a =&gt; a -&gt; Expr
</span><span class="hs-identifier hs-var">toExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetName -&gt; Text
</span><a href="Cardano.Ledger.Mary.Value.html#assetNameToTextAsHex"><span class="hs-identifier hs-var">assetNameToTextAsHex</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679244884"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-921"></span></pre></body></html>