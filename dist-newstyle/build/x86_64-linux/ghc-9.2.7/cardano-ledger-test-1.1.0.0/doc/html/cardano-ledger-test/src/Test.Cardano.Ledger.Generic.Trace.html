<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Generic.Trace</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- =========================================================================</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Rules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">AlonzoUtxowPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">AlonzoTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">body</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-babbage-1.2.0.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier">Cardano.Ledger.Babbage.Rules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-babbage-1.2.0.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier">BabbageUtxowPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-babbage-1.2.0.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier">Cardano.Ledger.Babbage.TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-babbage-1.2.0.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier">certs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">BlocksMade</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Globals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.EpochBoundary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">SnapShots</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">calculatePoolDistr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Keys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyRole</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.PoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">PoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">Cardano.Ledger.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">PDoc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppRecord</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppSafeHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppSlotNo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppWord64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">hashAnnotated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.Core</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">AccountState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">CertState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">DState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">dsUnified</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">EpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">NewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">PState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">StashedAVVMAddresses</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">UTxOState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.Rules</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ShelleyLedgerPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ShelleyLedgersPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ShelleyUtxowPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ScriptWitnessNotValidatingUTXOW</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.UMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UM</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier">Cardano.Slotting.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier">EpochNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier">SlotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">forM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">Control.State.Transition</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STS</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">Control.State.Transition.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">IRC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">Control.State.Transition.Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">lastState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">splitTrace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">Control.State.Transition.Trace.Generator.QuickCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">traceFromInitState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Functor.Identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">runIdentity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.IORef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">IORef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">newIORef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">readIORef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">writeIORef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier">Data.Maybe.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SS</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Debug.Trace</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hsep</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parens</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">vsep</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">unsafePerformIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ApplyTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html#applyTx"><span class="hs-identifier">applyTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Fields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxBodyField"><span class="hs-identifier">TxBodyField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#abstractTxBody"><span class="hs-identifier">abstractTxBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Functions</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#adaPots"><span class="hs-identifier">adaPots</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#allInputs"><span class="hs-identifier">allInputs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#getBody"><span class="hs-identifier">getBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#getScriptWits"><span class="hs-identifier">getScriptWits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#getWitnesses"><span class="hs-identifier">getWitnesses</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#isValid%27"><span class="hs-identifier">isValid'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#totalAda"><span class="hs-identifier">totalAda</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutFields"><span class="hs-identifier">txoutFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.GenState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier">GenEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier">GenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier">GenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier">getBlocksizeMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier">getReserves</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier">getSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier">getSlotDelta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier">getTreasury</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier">gsModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier">initStableFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier">initialLedgerState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier">modifyModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier">runGenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.MockChain</span></a></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ModelState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier">MUtxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#stashedAVVMAddressesZero"><span class="hs-identifier">stashedAVVMAddressesZero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.PrettyCore</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCoin"><span class="hs-identifier">pcCoin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier">pcCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcDCert"><span class="hs-identifier">pcDCert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier">pcKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcPoolParams"><span class="hs-identifier">pcPoolParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcScript"><span class="hs-identifier">pcScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcScriptHash"><span class="hs-identifier">pcScriptHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxBodyField"><span class="hs-identifier">pcTxBodyField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxIn"><span class="hs-identifier">pcTxIn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#scriptSummary"><span class="hs-identifier">scriptSummary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.TxGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier">genAlonzoTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Rules.IncrementalStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">stakeDistr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier">applySTSTest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">runShelleyBase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">testGlobals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TestTree</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">defaultMain</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testGroup</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">testProperty</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- ===========================================</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Generate a Tx and an internal Model of the state after the tx</span><span>
</span><span id="line-139"></span><span class="hs-comment">--   has been applied. That model can be used to generate the next Tx</span><span>
</span><span id="line-140"></span><span id="local-6989586621680192971"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxAndModel"><span class="hs-identifier hs-type">genRsTxAndModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192971"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-141"></span><span id="genRsTxAndModel"><span class="annot"><span class="annottext">genRsTxAndModel :: forall era.
Reflect era =&gt;
Proof era -&gt; Int -&gt; SlotNo -&gt; GenRS era (Tx era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxAndModel"><span class="hs-identifier hs-var hs-var">genRsTxAndModel</span></a></span></span><span> </span><span id="local-6989586621680190771"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190771"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190770"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190770"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680190769"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190769"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680190768"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190768"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; SlotNo -&gt; GenRS era (UTxO era, Tx era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier hs-var">genAlonzoTx</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190771"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190769"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680190767"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621680190767"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Int -&gt; SlotNo -&gt; Model era -&gt; Tx era -&gt; Model era
</span><a href="Test.Cardano.Ledger.Generic.ApplyTx.html#applyTx"><span class="hs-identifier hs-var">applyTx</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190771"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190770"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190769"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621680190767"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190768"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190768"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Generate a Vector of (StrictSeq (Tx era))  representing a (Vector Block)</span><span>
</span><span id="line-147"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-type">genRsTxSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192956"><span class="annot"><a href="#local-6989586621680192956"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192956"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192956"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192956"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192956"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192956"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span id="genRsTxSeq"><span class="annot"><span class="annottext">genRsTxSeq :: forall era.
Reflect era =&gt;
Proof era
-&gt; Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var hs-var">genRsTxSeq</span></a></span></span><span> </span><span id="local-6989586621680190722"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190722"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190721"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190721"><span class="hs-identifier hs-var">this</span></a></span></span><span> </span><span id="local-6989586621680190720"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190720"><span class="hs-identifier hs-var">lastN</span></a></span></span><span> </span><span id="local-6989586621680190719"><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680190719"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621680190718"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190718"><span class="hs-identifier hs-var">_slot</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190721"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190720"><span class="hs-identifier hs-var">lastN</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">seq</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IO a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IORef a -&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">writeIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef TT
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#theVector"><span class="hs-identifier hs-var">theVector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Proof c -&gt; [(StrictSeq (Tx c), SlotNo)] -&gt; TT
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-var">TT</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190722"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680190719"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680190719"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var">genRsTxSeq</span></a></span><span> </span><span id="local-6989586621680190713"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190713"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190712"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190712"><span class="hs-identifier hs-var">this</span></a></span></span><span> </span><span id="local-6989586621680190711"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190711"><span class="hs-identifier hs-var">lastN</span></a></span></span><span> </span><span id="local-6989586621680190710"><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680190710"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621680190709"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190709"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621680190708"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680190708"><span class="hs-identifier hs-var">maxBlockSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier hs-var">getBlocksizeMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621680190706"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190706"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680190708"><span class="hs-identifier hs-var">maxBlockSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621680190704"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190704"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190706"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680190703"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190703"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Int -&gt; SlotNo -&gt; GenRS era (Tx era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxAndModel"><span class="hs-identifier hs-var">genRsTxAndModel</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190713"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190712"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190703"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190709"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621680190701"><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621680190701"><span class="hs-identifier hs-var">newSlotRange</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier hs-var">getSlotDelta</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621680190700"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190700"><span class="hs-identifier hs-var">nextSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190709"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621680190701"><span class="hs-identifier hs-var">newSlotRange</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var">genRsTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190713"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190712"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190706"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190711"><span class="hs-identifier hs-var">lastN</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-var">SS.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190704"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190709"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680190710"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190700"><span class="hs-identifier hs-var">nextSlotNo</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Generate a Vector of Blocks, and an initial LedgerState</span><span>
</span><span id="line-169"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-type">genTxSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192900"><span class="annot"><a href="#local-6989586621680192900"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192900"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192900"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Proof of the Era we want to generate the sequence in</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Size of things the generated code should adhere to</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- The number of Tx in the sequence</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192900"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- An arbitrary 'initialization action', to run before we generate the sequence</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-comment">-- use (pure ()) if you don't want or need initialization</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192900"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192900"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="genTxSeq"><span class="annot"><span class="annottext">genTxSeq :: forall era.
Reflect era =&gt;
Proof era
-&gt; GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var hs-var">genTxSeq</span></a></span></span><span> </span><span id="local-6989586621680190689"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190689"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190688"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190688"><span class="hs-identifier hs-var">gensize</span></a></span></span><span> </span><span id="local-6989586621680190687"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190687"><span class="hs-identifier hs-var">numTx</span></a></span></span><span> </span><span id="local-6989586621680190686"><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621680190686"><span class="hs-identifier hs-var">initialize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">forall era a.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; GenRS era a -&gt; Gen (a, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-var">runGenRS</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190689"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190688"><span class="hs-identifier hs-var">gensize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621680190686"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var">genRsTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190689"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190687"><span class="hs-identifier hs-var">numTx</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#runTest"><span class="hs-identifier hs-type">runTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span id="runTest"><span class="annot"><span class="annottext">runTest :: IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#runTest"><span class="hs-identifier hs-var hs-var">runTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680190684"><span class="annot"><span class="annottext">Vector (StrictSeq (AlonzoTx (BabbageEra Mock)), SlotNo)
</span><a href="#local-6989586621680190684"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenState (BabbageEra Mock)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; IO a
</span><span class="hs-identifier hs-var">generate</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">Vector.length</span></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (AlonzoTx (BabbageEra Mock)), SlotNo)
</span><a href="#local-6989586621680190684"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Constructing the &quot;real&quot;, initial NewEpochState, from the GenState</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621680192888"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-type">initialMockChainState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192888"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192888"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192888"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192888"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-194"></span><span id="initialMockChainState"><span class="annot"><span class="annottext">initialMockChainState :: forall era.
Reflect era =&gt;
Proof era -&gt; GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var hs-var">initialMockChainState</span></a></span></span><span> </span><span id="local-6989586621680190674"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190674"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190673"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190673"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><span class="annottext">forall era.
NewEpochState era -&gt; SlotNo -&gt; Int -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-var">MockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621680190671"><span class="hs-identifier hs-var">newepochstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; SlotNo
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier hs-var">getSlot</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190673"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621680190670"><span class="annot"><span class="annottext">ledgerstate :: LedgerState era
</span><a href="#local-6989586621680190670"><span class="hs-identifier hs-var hs-var">ledgerstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenState era -&gt; LedgerState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier hs-var">initialLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190673"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621680190671"><span class="annot"><span class="annottext">newepochstate :: NewEpochState era
</span><a href="#local-6989586621680190671"><span class="hs-identifier hs-var hs-var">newepochstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nesEL :: EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesBprev :: BlocksMade (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesBprev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Map (KeyHash 'StakePool c) Natural -&gt; BlocksMade c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesBcur :: BlocksMade (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesBcur</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Map (KeyHash 'StakePool c) Natural -&gt; BlocksMade c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesEs :: EpochState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesEs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenState era -&gt; LedgerState era -&gt; EpochState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#makeEpochState"><span class="hs-identifier hs-var">makeEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190673"><span class="hs-identifier hs-var">gstate</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621680190670"><span class="hs-identifier hs-var">ledgerstate</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesRu :: StrictMaybe (PulsingRewUpdate (EraCrypto era))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesRu</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesPd :: PoolDistr (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesPd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c.
Map (KeyHash 'StakePool c) (IndividualPoolStake c) -&gt; PoolDistr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">PoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190673"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stashedAVVMAddresses :: StashedAVVMAddresses era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">stashedAVVMAddresses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; StashedAVVMAddresses era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#stashedAVVMAddressesZero"><span class="hs-identifier hs-var">stashedAVVMAddressesZero</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190674"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621680192875"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#makeEpochState"><span class="hs-identifier hs-type">makeEpochState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192875"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192875"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192875"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">EpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192875"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-210"></span><span id="makeEpochState"><span class="annot"><span class="annottext">makeEpochState :: forall era.
Reflect era =&gt;
GenState era -&gt; LedgerState era -&gt; EpochState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#makeEpochState"><span class="hs-identifier hs-var hs-var">makeEpochState</span></a></span></span><span> </span><span id="local-6989586621680190644"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190644"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span id="local-6989586621680190643"><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621680190643"><span class="hs-identifier hs-var">ledgerstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">EpochState</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">esAccountState :: AccountState
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esAccountState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; AccountState
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">AccountState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier hs-var">getTreasury</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190644"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier hs-var">getReserves</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190644"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esSnapshots :: SnapShots (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esSnapshots</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
LedgerState era -&gt; SnapShots (EraCrypto era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#snaps"><span class="hs-identifier hs-var">snaps</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621680190643"><span class="hs-identifier hs-var">ledgerstate</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esLState :: LedgerState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esLState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621680190643"><span class="hs-identifier hs-var">ledgerstate</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esPrevPp :: PParams era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esPrevPp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190644"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esPp :: PParams era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esPp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190644"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esNonMyopic :: NonMyopic (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esNonMyopic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621680192859"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#snaps"><span class="hs-identifier hs-type">snaps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192859"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192859"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SnapShots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192859"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-221"></span><span id="snaps"><span class="annot"><span class="annottext">snaps :: forall era.
EraTxOut era =&gt;
LedgerState era -&gt; SnapShots (EraCrypto era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#snaps"><span class="hs-identifier hs-var hs-var">snaps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">utxosUtxo :: forall era. UTxOState era -&gt; UTxO era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680190626"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680190626"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosFees :: forall era. UTxOState era -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680190624"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680190624"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">CertState</span></a></span><span> </span><span class="annot"><span class="annottext">VState era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680190622"><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621680190622"><span class="hs-identifier hs-var">pstate</span></a></span></span><span> </span><span id="local-6989586621680190621"><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621680190621"><span class="hs-identifier hs-var">dstate</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="annottext">forall c.
SnapShot c
-&gt; PoolDistr c -&gt; SnapShot c -&gt; SnapShot c -&gt; Coin -&gt; SnapShots c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">SnapShots</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot (EraCrypto era)
</span><a href="#local-6989586621680190619"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. SnapShot c -&gt; PoolDistr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">calculatePoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot (EraCrypto era)
</span><a href="#local-6989586621680190619"><span class="hs-identifier hs-var">snap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SnapShot (EraCrypto era)
</span><a href="#local-6989586621680190619"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot (EraCrypto era)
</span><a href="#local-6989586621680190619"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621680190624"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621680190619"><span class="annot"><span class="annottext">snap :: SnapShot (EraCrypto era)
</span><a href="#local-6989586621680190619"><span class="hs-identifier hs-var hs-var">snap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
UTxO era -&gt; DState era -&gt; PState era -&gt; SnapShot (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">stakeDistr</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680190626"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621680190621"><span class="hs-identifier hs-var">dstate</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621680190622"><span class="hs-identifier hs-var">pstate</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- ==============================================================================</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Turn a UTxO into a smaller UTxO, with only entries mentioned in</span><span>
</span><span id="line-229"></span><span class="hs-comment">--   the inputs of 'txs' ,  then pretty print it.</span><span>
</span><span id="line-230"></span><span id="local-6989586621680192849"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#pcSmallUTxO"><span class="hs-identifier hs-type">pcSmallUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192849"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192849"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192849"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192849"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PDoc</span></a></span></span><span>
</span><span id="line-231"></span><span id="pcSmallUTxO"><span class="annot"><span class="annottext">pcSmallUTxO :: forall era. EraTx era =&gt; Proof era -&gt; MUtxo era -&gt; [Tx era] -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#pcSmallUTxO"><span class="hs-identifier hs-var hs-var">pcSmallUTxO</span></a></span></span><span> </span><span id="local-6989586621680190606"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190606"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190605"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190605"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621680190604"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190604"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. TxIn c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxIn"><span class="hs-identifier hs-var">pcTxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. EraTxOut era =&gt; Proof era -&gt; TxOut era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#shortTxOut"><span class="hs-identifier hs-var">shortTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190606"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190602"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621680190601"><span class="annot"><span class="annottext">keys :: Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190601"><span class="hs-identifier hs-var hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190599"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190604"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621680190599"><span class="annot"><span class="annottext">f :: Tx era -&gt; Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190599"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680190598"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190598"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxBody era =&gt;
Proof era -&gt; TxBody era -&gt; Set (TxIn (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#allInputs"><span class="hs-identifier hs-var">allInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190606"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. EraTx era =&gt; Proof era -&gt; Tx era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#getBody"><span class="hs-identifier hs-var">getBody</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190606"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190598"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621680190602"><span class="annot"><span class="annottext">m :: MUtxo era
</span><a href="#local-6989586621680190602"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190605"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190601"><span class="hs-identifier hs-var">keys</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#raiseMockError"><span class="hs-identifier hs-type">raiseMockError</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192830"><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">EpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFailure"><span class="hs-identifier hs-type">MockChainFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-247"></span><span id="raiseMockError"><span class="annot"><span class="annottext">raiseMockError :: forall era.
Reflect era =&gt;
Word64
-&gt; SlotNo
-&gt; EpochState era
-&gt; [MockChainFailure era]
-&gt; [Tx era]
-&gt; GenState era
-&gt; String
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#raiseMockError"><span class="hs-identifier hs-var hs-var">raiseMockError</span></a></span></span><span> </span><span id="local-6989586621680190562"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190562"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621680190561"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190561"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680190560"><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span></span><span> </span><span id="local-6989586621680190559"><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190559"><span class="hs-identifier hs-var">pdfs</span></a></span></span><span> </span><span id="local-6989586621680190558"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190558"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680190538"><span id="local-6989586621680190539"><span id="local-6989586621680190540"><span id="local-6989586621680190541"><span id="local-6989586621680190542"><span id="local-6989586621680190543"><span id="local-6989586621680190544"><span id="local-6989586621680190545"><span id="local-6989586621680190546"><span id="local-6989586621680190547"><span id="local-6989586621680190548"><span id="local-6989586621680190549"><span id="local-6989586621680190550"><span id="local-6989586621680190551"><span id="local-6989586621680190552"><span id="local-6989586621680190553"><span id="local-6989586621680190554"><span id="local-6989586621680190555"><span id="local-6989586621680190556"><span class="annot"><span class="annottext">Int
Set (Credential 'Staking (EraCrypto era))
Set (KeyHash 'StakePool (EraCrypto era))
Map (ScriptHash (EraCrypto era), Tag) (IsValid, Script era)
Map (ScriptHash (EraCrypto era)) (Script era)
Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
Map (TxIn (EraCrypto era)) (TxOut era)
Map (Credential 'Staking (EraCrypto era)) Coin
Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
Map (DataHash (EraCrypto era)) (Data era)
Map
  (KeyHash 'Witness (EraCrypto era))
  (KeyPair 'Witness (EraCrypto era))
Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
ValidityInterval
Proof era
ModelNewEpochState era
GenEnv era
gsSeedIdx :: forall era. GenState era -&gt; Int
gsProof :: forall era. GenState era -&gt; Proof era
gsAvoidKey :: forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
gsAvoidCred :: forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
gsStableDelegators :: forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
gsStablePools :: forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
gsInitialPoolParams :: forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
gsInitialDelegations :: forall era.
GenState era
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
gsInitialRewards :: forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
gsInitialUtxo :: forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
gsVI :: forall era.
GenState era
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
gsDatums :: forall era.
GenState era -&gt; Map (DataHash (EraCrypto era)) (Data era)
gsPlutusScripts :: forall era.
GenState era
-&gt; Map (ScriptHash (EraCrypto era), Tag) (IsValid, Script era)
gsScripts :: forall era.
GenState era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
gsKeys :: forall era.
GenState era
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
gsValidityInterval :: forall era. GenState era -&gt; ValidityInterval
gsSeedIdx :: Int
gsGenEnv :: GenEnv era
gsProof :: Proof era
gsAvoidKey :: Set (KeyHash 'StakePool (EraCrypto era))
gsAvoidCred :: Set (Credential 'Staking (EraCrypto era))
gsStableDelegators :: Set (Credential 'Staking (EraCrypto era))
gsStablePools :: Set (KeyHash 'StakePool (EraCrypto era))
gsInitialPoolDistr :: Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
gsInitialPoolParams :: Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
gsInitialDelegations :: Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
gsInitialRewards :: Map (Credential 'Staking (EraCrypto era)) Coin
gsInitialUtxo :: Map (TxIn (EraCrypto era)) (TxOut era)
gsModel :: ModelNewEpochState era
gsVI :: Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
gsDatums :: Map (DataHash (EraCrypto era)) (Data era)
gsPlutusScripts :: Map (ScriptHash (EraCrypto era), Tag) (IsValid, Script era)
gsScripts :: Map (ScriptHash (EraCrypto era)) (Script era)
gsKeys :: Map
  (KeyHash 'Witness (EraCrypto era))
  (KeyPair 'Witness (EraCrypto era))
gsValidityInterval :: ValidityInterval
gsGenEnv :: forall era. GenState era -&gt; GenEnv era
gsInitialPoolDistr :: forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
gsModel :: forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsSeedIdx"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680190521"><span class="annot"><span class="annottext">utxo :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621680190521"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. UTxO era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">unUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. UTxOState era -&gt; UTxO era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. LedgerState era -&gt; UTxOState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">lsUTxOState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EpochState era -&gt; LedgerState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esLState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span id="local-6989586621680190518"><span class="annot"><span class="annottext">_ssPoolParams :: Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621680190518"><span class="hs-identifier hs-var hs-var">_ssPoolParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
PState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">psStakePoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. CertState era -&gt; PState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">certPState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. LedgerState era -&gt; CertState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">lsCertState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EpochState era -&gt; LedgerState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esLState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621680190514"><span class="annot"><span class="annottext">_pooldeposits :: Map (KeyHash 'StakePool (EraCrypto era)) Coin
</span><a href="#local-6989586621680190514"><span class="hs-identifier hs-var hs-var">_pooldeposits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
PState era -&gt; Map (KeyHash 'StakePool (EraCrypto era)) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">psDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. CertState era -&gt; PState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">certPState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. LedgerState era -&gt; CertState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">lsCertState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EpochState era -&gt; LedgerState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esLState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621680190512"><span class="annot"><span class="annottext">_keydeposits :: Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="#local-6989586621680190512"><span class="hs-identifier hs-var hs-var">_keydeposits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. UMap c -&gt; Map (Credential 'Staking c) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UM.depositView</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. DState era -&gt; UMap (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">dsUnified</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. CertState era -&gt; DState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">certDState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. LedgerState era -&gt; CertState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">lsCertState</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EpochState era -&gt; LedgerState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esLState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span><span>
</span><span id="line-252"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span>
</span><span id="line-254"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UTxO\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EraTx era =&gt; Proof era -&gt; MUtxo era -&gt; [Tx era] -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#pcSmallUTxO"><span class="hs-identifier hs-var">pcSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621680190521"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190558"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Stable Pools\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (discriminator :: KeyRole) c.
KeyHash discriminator c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier hs-var">pcKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621680190544"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-259"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Stable Delegators\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (keyrole :: KeyRole) c. Credential keyrole c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier hs-var">pcCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking (EraCrypto era))
</span><a href="#local-6989586621680190543"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span>
</span><span id="line-260"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- You never know what is NEEDED to debug a failure, and what is a DISTRACTION</span><span>
</span><span id="line-261"></span><span>            </span><span class="hs-comment">-- These things certainly fall in that category. I leave them commented out so if</span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-comment">-- they are not a distraction in the current error, they are easy to turn back on.</span><span>
</span><span id="line-263"></span><span>            </span><span class="hs-comment">-- ppString &quot;===================================&quot;,</span><span>
</span><span id="line-264"></span><span>            </span><span class="hs-comment">-- ppString &quot;PoolDeposits\n&quot; &lt;&gt; ppMap pcKeyHash pcCoin _pooldeposits,</span><span>
</span><span id="line-265"></span><span>            </span><span class="hs-comment">-- ppString &quot;===================================&quot;,</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-comment">-- ppString &quot;KeyDeposits\n&quot; &lt;&gt; ppMap pcCredential pcCoin _keydeposits,</span><span>
</span><span id="line-267"></span><span>            </span><span class="hs-comment">-- ppString &quot;Model KeyDeposits\n&quot; &lt;&gt; ppMap pcCredential pcCoin (mKeyDeposits gsModel),</span><span>
</span><span id="line-268"></span><span>            </span><span class="hs-comment">-- ppString &quot;Initial Pool Distr\n&quot; &lt;&gt; ppMap pcKeyHash pcIndividualPoolStake gsInitialPoolDistr,</span><span>
</span><span id="line-269"></span><span>            </span><span class="hs-comment">-- ppString &quot;===================================&quot;,</span><span>
</span><span id="line-270"></span><span>            </span><span class="hs-comment">-- ppString &quot;Initial Pool Params\n&quot; &lt;&gt; ppMap pcKeyHash pcPoolParams gsInitialPoolParams,</span><span>
</span><span id="line-271"></span><span>            </span><span class="hs-comment">-- ppString &quot;===================================&quot;,</span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-comment">-- ppString &quot;Initial Rewards\n&quot; &lt;&gt; ppMap pcCredential pcCoin gsInitialRewards,</span><span>
</span><span id="line-273"></span><span>            </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-274"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; MUtxo era -&gt; [Tx era] -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#showBlock"><span class="hs-identifier hs-var">showBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621680190521"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190558"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-275"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-276"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; EpochState era -&gt; AdaPots
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#adaPots"><span class="hs-identifier hs-var">adaPots</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-278"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; [x] -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; MockChainFailure era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#ppMockChainFailure"><span class="hs-identifier hs-var">ppMockChainFailure</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190559"><span class="hs-identifier hs-var">pdfs</span></a></span><span>
</span><span id="line-279"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-280"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Last Slot &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Word64 -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190562"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-281"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Current Slot &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Word64 -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190561"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-282"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===================================&quot;</span></span><span>
</span><span id="line-283"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Script TxWits\n&quot;</span></span><span>
</span><span id="line-284"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppMap</span></a></span><span>
</span><span id="line-285"></span><span>                </span><span class="annot"><span class="annottext">forall era. ScriptHash era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcScriptHash"><span class="hs-identifier hs-var">pcScriptHash</span></a></span><span>
</span><span id="line-286"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Script era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#scriptSummary"><span class="hs-identifier hs-var">scriptSummary</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680192830"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621680190554"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; [MockChainFailure era] -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#badScripts"><span class="hs-identifier hs-var">badScripts</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190559"><span class="hs-identifier hs-var">pdfs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ppString &quot;===================================&quot;,</span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-comment">-- ppString &quot;Real Pool Params\n&quot; &lt;&gt; ppMap pcKeyHash pcPoolParams poolParams,</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=====================================&quot;</span></span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Protocol Parameters\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. EpochState era -&gt; PParams era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">esPp</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190560"><span class="hs-identifier hs-var">epochstate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span id="local-6989586621680192778"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#badScripts"><span class="hs-identifier hs-type">badScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192778"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFailure"><span class="hs-identifier hs-type">MockChainFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192778"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192778"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-295"></span><span id="badScripts"><span class="annot"><span class="annottext">badScripts :: forall era.
Proof era
-&gt; [MockChainFailure era] -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#badScripts"><span class="hs-identifier hs-var hs-var">badScripts</span></a></span></span><span> </span><span id="local-6989586621680190502"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190502"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190501"><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190501"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Fold.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680190499"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621680190499"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680190498"><span class="annot"><span class="annottext">MockChainFailure era
</span><a href="#local-6989586621680190498"><span class="hs-identifier hs-var">mcf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621680190499"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; MockChainFailure era -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621680190496"><span class="hs-identifier hs-var">getw</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190502"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainFailure era
</span><a href="#local-6989586621680190498"><span class="hs-identifier hs-var">mcf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190501"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621680192770"><span class="annot"><a href="#local-6989586621680190496"><span class="hs-identifier hs-type">getw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192770"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFailure"><span class="hs-identifier hs-type">MockChainFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192770"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192770"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621680190496"><span class="annot"><span class="annottext">getw :: forall era.
Proof era
-&gt; MockChainFailure era -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621680190496"><span class="hs-identifier hs-var hs-var">getw</span></a></span></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-301"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-302"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-303"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-babbage-1.2.0.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">AlonzoInBabbageUtxowPredFailure</span></a></span><span>
</span><span id="line-304"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">ShelleyInAlonzoUtxowPredFailure</span></a></span><span>
</span><span id="line-305"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621680190487"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (BabbageEra c)))
</span><a href="#local-6989586621680190487"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (BabbageEra c)))
</span><a href="#local-6989586621680190487"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621680190496"><span class="hs-identifier hs-var">getw</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-314"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-315"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-316"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">ShelleyInAlonzoUtxowPredFailure</span></a></span><span>
</span><span id="line-317"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621680190483"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (AlonzoEra c)))
</span><a href="#local-6989586621680190483"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (AlonzoEra c)))
</span><a href="#local-6989586621680190483"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621680190496"><span class="hs-identifier hs-var">getw</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-325"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-326"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-327"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621680190479"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (MaryEra c)))
</span><a href="#local-6989586621680190479"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (MaryEra c)))
</span><a href="#local-6989586621680190479"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="#local-6989586621680190496"><span class="hs-identifier hs-var">getw</span></a></span><span>
</span><span id="line-332"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-335"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-336"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621680190475"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (AllegraEra c)))
</span><a href="#local-6989586621680190475"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto (AllegraEra c)))
</span><a href="#local-6989586621680190475"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="#local-6989586621680190496"><span class="hs-identifier hs-var">getw</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MockChainFailure era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#showBlock"><span class="hs-identifier hs-type">showBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192786"><span class="annot"><a href="#local-6989586621680192786"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192786"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192786"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192786"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PDoc</span></a></span><span>
</span><span id="line-343"></span><span id="showBlock"><span class="annot"><span class="annottext">showBlock :: forall era. Reflect era =&gt; MUtxo era -&gt; [Tx era] -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#showBlock"><span class="hs-identifier hs-var hs-var">showBlock</span></a></span></span><span> </span><span id="local-6989586621680190445"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190445"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621680190444"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190444"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; [x] -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppList</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx era, Int) -&gt; PDoc
</span><a href="#local-6989586621680190443"><span class="hs-identifier hs-var">pppair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190444"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621680190443"><span class="annot"><span class="annottext">pppair :: (Tx era, Int) -&gt; PDoc
</span><a href="#local-6989586621680190443"><span class="hs-identifier hs-var hs-var">pppair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680190442"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190442"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680190441"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190441"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680190440"><span class="annot"><span class="annottext">body :: TxBody era
</span><a href="#local-6989586621680190440"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraTx era =&gt; Proof era -&gt; Tx era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#getBody"><span class="hs-identifier hs-var">getBody</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190442"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-347"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span>
</span><span id="line-348"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n###########&quot;</span></span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190441"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall c index. SafeHash c index -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppSafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x index c.
(HashAnnotated x index c, HashAlgorithm (HASH c)) =&gt;
x -&gt; SafeHash c index
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashAnnotated</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680190440"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; MUtxo era -&gt; TxBody era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#smartTxBody"><span class="hs-identifier hs-var">smartTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190445"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680190440"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Tx era -&gt; IsValid
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#isValid%27"><span class="hs-identifier hs-var">isValid'</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190442"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. ScriptHash era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcScriptHash"><span class="hs-identifier hs-var">pcScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; Script era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcScript"><span class="hs-identifier hs-var">pcScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680192786"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
EraTxWits era =&gt;
Proof era
-&gt; TxWits era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#getScriptWits"><span class="hs-identifier hs-var">getScriptWits</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. EraTx era =&gt; Proof era -&gt; Tx era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#getWitnesses"><span class="hs-identifier hs-var">getWitnesses</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621680190442"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span id="local-6989586621680192841"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#shortTxOut"><span class="hs-identifier hs-type">shortTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192841"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192841"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192841"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PDoc</span></a></span></span><span>
</span><span id="line-358"></span><span id="shortTxOut"><span class="annot"><span class="annottext">shortTxOut :: forall era. EraTxOut era =&gt; Proof era -&gt; TxOut era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#shortTxOut"><span class="hs-identifier hs-var hs-var">shortTxOut</span></a></span></span><span> </span><span id="local-6989586621680190429"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190429"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190428"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680190428"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; TxOut era -&gt; (Addr (EraCrypto era), Value era, [TxOutField era])
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutFields"><span class="hs-identifier hs-var">txoutFields</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190429"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680190428"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680190426"><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621680190426"><span class="hs-identifier hs-var">pay</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PDoc
</span><span class="hs-string">&quot;Out&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PDoc
</span><span class="hs-string">&quot;Addr&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (keyrole :: KeyRole) c. Credential keyrole c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier hs-var">pcCredential</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621680190426"><span class="hs-identifier hs-var">pay</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCoin"><span class="hs-identifier hs-var">pcCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680190428"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall era. EraTxOut era =&gt; Lens' (TxOut era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coinTxOutL</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">(Addr (EraCrypto era), Value era, [TxOutField era])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bootstrap Address in shortTxOut&quot;</span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span id="local-6989586621680192739"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#smartTxBody"><span class="hs-identifier hs-type">smartTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192739"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192739"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192739"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192739"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PDoc</span></a></span></span><span>
</span><span id="line-364"></span><span id="smartTxBody"><span class="annot"><span class="annottext">smartTxBody :: forall era.
Reflect era =&gt;
Proof era -&gt; MUtxo era -&gt; TxBody era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#smartTxBody"><span class="hs-identifier hs-var hs-var">smartTxBody</span></a></span></span><span> </span><span id="local-6989586621680190409"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190409"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190408"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190408"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621680190407"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680190407"><span class="hs-identifier hs-var">txbody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, PDoc)] -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppRecord</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TxBody&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, PDoc)]
</span><a href="#local-6989586621680190406"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621680190405"><span class="annot"><span class="annottext">fields :: [TxBodyField era]
</span><a href="#local-6989586621680190405"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; TxBody era -&gt; [TxBodyField era]
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#abstractTxBody"><span class="hs-identifier hs-var">abstractTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190409"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621680190407"><span class="hs-identifier hs-var">txbody</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621680190406"><span class="annot"><span class="annottext">pairs :: [(Text, PDoc)]
</span><a href="#local-6989586621680190406"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyField era -&gt; [(Text, PDoc)]
</span><a href="#local-6989586621680190403"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">[TxBodyField era]
</span><a href="#local-6989586621680190405"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621680190403"><span class="annot"><span class="annottext">help :: TxBodyField era -&gt; [(Text, PDoc)]
</span><a href="#local-6989586621680190403"><span class="hs-identifier hs-var hs-var">help</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#Inputs"><span class="hs-identifier hs-type">Inputs</span></a></span><span> </span><span id="local-6989586621680190401"><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190401"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;spend inputs&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era) -&gt; PDoc
</span><a href="#local-6989586621680190400"><span class="hs-identifier hs-var">pcIn</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190401"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="#local-6989586621680190403"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#Collateral"><span class="hs-identifier hs-type">Collateral</span></a></span><span> </span><span id="local-6989586621680190398"><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190398"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;coll inputs&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era) -&gt; PDoc
</span><a href="#local-6989586621680190400"><span class="hs-identifier hs-var">pcIn</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621680190398"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="#local-6989586621680190403"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span id="local-6989586621680190397"><span class="annot"><span class="annottext">TxBodyField era
</span><a href="#local-6989586621680190397"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; TxBodyField era -&gt; [(Text, PDoc)]
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxBodyField"><span class="hs-identifier hs-var">pcTxBodyField</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190409"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyField era
</span><a href="#local-6989586621680190397"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621680190400"><span class="annot"><span class="annottext">pcIn :: TxIn (EraCrypto era) -&gt; PDoc
</span><a href="#local-6989586621680190400"><span class="hs-identifier hs-var hs-var">pcIn</span></a></span></span><span> </span><span id="local-6989586621680190396"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621680190396"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall c. TxIn c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxIn"><span class="hs-identifier hs-var">pcTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621680190396"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PDoc
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621680190396"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621680190408"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680190394"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680190394"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. EraTxOut era =&gt; Proof era -&gt; TxOut era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#shortTxOut"><span class="hs-identifier hs-var">shortTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190409"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621680190394"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut era)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PDoc
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- =====================================================================</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- HasTrace instance of MOCKCHAIN depends on STS(MOCKCHAIN era) instance</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- We show the type family instances here for reference.</span><span>
</span><span id="line-381"></span><span class="hs-comment">{-
instance STS (MOCKCHAIN era)
  where
  type State (MOCKCHAIN era) = MockChainState era
  type Signal (MOCKCHAIN era) = (MockBlock era,UTxO era)
  type Environment (MOCKCHAIN era) = ()
-}</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- ==============================================================</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-keyword">data</span><span> </span><span id="Gen1"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span></span><span> </span><span id="local-6989586621680192649"><span class="annot"><a href="#local-6989586621680192649"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gen1"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192649"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192649"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621680192972"><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192972"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192972"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192972"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192972"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BaseEnv"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">BaseEnv</span></a></span></span><span> </span><span id="local-6989586621680192972"><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192972"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Globals</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621680190382"><span class="annot"><span class="annottext">interpretSTS :: forall a.
HasCallStack =&gt;
BaseEnv (MOCKCHAIN era) -&gt; BaseM (MOCKCHAIN era) a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretSTS</span></a></span></span><span> </span><span id="local-6989586621680190380"><span class="annot"><span class="annottext">BaseEnv (MOCKCHAIN era)
</span><a href="#local-6989586621680190380"><span class="hs-identifier hs-var">globals</span></a></span></span><span> </span><span id="local-6989586621680190379"><span class="annot"><span class="annottext">BaseM (MOCKCHAIN era) a
</span><a href="#local-6989586621680190379"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">BaseM (MOCKCHAIN era) a
</span><a href="#local-6989586621680190379"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv (MOCKCHAIN era)
</span><a href="#local-6989586621680190380"><span class="hs-identifier hs-var">globals</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621680190374"><span class="annot"><span class="annottext">envGen :: HasCallStack =&gt; Gen1 era -&gt; Gen (Environment (MOCKCHAIN era))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">envGen</span></a></span></span><span> </span><span id="local-6989586621680190372"><span class="annot"><span class="annottext">Gen1 era
</span><a href="#local-6989586621680190372"><span class="hs-identifier hs-var">_gstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621680190359"><span class="annot"><span class="annottext">sigGen :: HasCallStack =&gt;
Gen1 era
-&gt; Environment (MOCKCHAIN era)
-&gt; State (MOCKCHAIN era)
-&gt; Gen (Signal (MOCKCHAIN era))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">sigGen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span id="local-6989586621680190357"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680190357"><span class="hs-identifier hs-var">txss</span></a></span></span><span> </span><span id="local-6989586621680190356"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190356"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680190355"><span class="annot"><span class="annottext">mcs :: State (MOCKCHAIN era)
</span><a href="#local-6989586621680190355"><span class="hs-identifier hs-var">mcs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span id="local-6989586621680190354"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621680190354"><span class="hs-identifier hs-var">newepoch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621680190353"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190353"><span class="hs-identifier hs-var">lastSlot</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680190352"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190352"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span id="local-6989586621680190351"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680190351"><span class="hs-identifier hs-var">epochnum</span></a></span></span><span> </span><span class="annot"><span class="annottext">BlocksMade (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BlocksMade (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680190350"><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190350"><span class="hs-identifier hs-var">epochstate</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (PulsingRewUpdate (EraCrypto era))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680190349"><span class="annot"><span class="annottext">PoolDistr (EraCrypto era)
</span><a href="#local-6989586621680190349"><span class="hs-identifier hs-var">pooldistr</span></a></span></span><span> </span><span class="annot"><span class="annottext">StashedAVVMAddresses era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621680190354"><span class="hs-identifier hs-var">newepoch</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621680190348"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621680190348"><span class="hs-identifier hs-var">issuerkey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall c.
EpochNo
-&gt; Word64 -&gt; Int -&gt; PoolDistr c -&gt; Gen (KeyHash 'StakePool c)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chooseIssuer"><span class="hs-identifier hs-var">chooseIssuer</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680190351"><span class="hs-identifier hs-var">epochnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190353"><span class="hs-identifier hs-var">lastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190352"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr (EraCrypto era)
</span><a href="#local-6989586621680190349"><span class="hs-identifier hs-var">pooldistr</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680190346"><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621680190346"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680190345"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190345"><span class="hs-identifier hs-var">nextSlotNo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680190357"><span class="hs-identifier hs-var">txss</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190352"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-comment">-- Assmble it into a MockBlock</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680190344"><span class="annot"><span class="annottext">mockblock :: MockBlock era
</span><a href="#local-6989586621680190344"><span class="hs-identifier hs-var hs-var">mockblock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
KeyHash 'StakePool (EraCrypto era)
-&gt; SlotNo -&gt; StrictSeq (Tx era) -&gt; MockBlock era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockBlock"><span class="hs-identifier hs-var">MockBlock</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621680190348"><span class="hs-identifier hs-var">issuerkey</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190345"><span class="hs-identifier hs-var">nextSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621680190346"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-comment">-- Run the STS Rules for MOCKCHAIN with generated signal</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">applySTSTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">TRC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192972"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State (MOCKCHAIN era)
</span><a href="#local-6989586621680190355"><span class="hs-identifier hs-var">mcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MockBlock era
</span><a href="#local-6989586621680190344"><span class="hs-identifier hs-var">mockblock</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680190341"><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190341"><span class="hs-identifier hs-var">pdfs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680190340"><span class="annot"><span class="annottext">txsl :: [Tx era]
</span><a href="#local-6989586621680190340"><span class="hs-identifier hs-var hs-var">txsl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Fold.toList</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621680190346"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-415"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">trace</span></a></span><span>
</span><span id="line-416"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Word64
-&gt; SlotNo
-&gt; EpochState era
-&gt; [MockChainFailure era]
-&gt; [Tx era]
-&gt; GenState era
-&gt; String
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#raiseMockError"><span class="hs-identifier hs-var">raiseMockError</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190353"><span class="hs-identifier hs-var">lastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680190345"><span class="hs-identifier hs-var">nextSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621680190350"><span class="hs-identifier hs-var">epochstate</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621680190341"><span class="hs-identifier hs-var">pdfs</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680190340"><span class="hs-identifier hs-var">txsl</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190356"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FAILS&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680190338"><span class="annot"><span class="annottext">State (MOCKCHAIN era)
</span><a href="#local-6989586621680190338"><span class="hs-identifier hs-var">mcs2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">seq</span></a></span><span> </span><span class="annot"><span class="annottext">State (MOCKCHAIN era)
</span><a href="#local-6989586621680190338"><span class="hs-identifier hs-var">mcs2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">MockBlock era
</span><a href="#local-6989586621680190344"><span class="hs-identifier hs-var">mockblock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621680190336"><span class="annot"><span class="annottext">shrinkSignal :: HasCallStack =&gt; Signal (MOCKCHAIN era) -&gt; [Signal (MOCKCHAIN era)]
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">shrinkSignal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Signal (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- TODO, perhaps we might add shrinking like this. Just a thought. Failure is usually caused by just one Tx</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- in the Block. If the first or last Tx, is independent of the failing Tx, we can probably throw them away.</span><span>
</span><span id="line-424"></span><span class="hs-comment">--  shrinkSignal (MockBlock _ _ xs) | SS.null xs = []</span><span>
</span><span id="line-425"></span><span class="hs-comment">--  shrinkSignal (MockBlock i s xs) = [MockBlock i s (SS.drop 1 xs), MockBlock i s (SS.take (SS.length xs - 1) xs)]</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span id="local-6989586621680192678"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#mapProportion"><span class="hs-identifier hs-type">mapProportion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680192678"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621680192678"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-428"></span><span id="mapProportion"><span class="annot"><span class="annottext">mapProportion :: forall k. EpochNo -&gt; Word64 -&gt; Int -&gt; Map k Int -&gt; Gen k
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#mapProportion"><span class="hs-identifier hs-var hs-var">mapProportion</span></a></span></span><span> </span><span id="local-6989586621680190315"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680190315"><span class="hs-identifier hs-var">epochnum</span></a></span></span><span> </span><span id="local-6989586621680190314"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190314"><span class="hs-identifier hs-var">lastSlot</span></a></span></span><span> </span><span id="local-6989586621680190313"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190313"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span id="local-6989586621680190312"><span class="annot"><span class="annottext">Map k Int
</span><a href="#local-6989586621680190312"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621680190310"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;There are no stakepools to choose an issuer from&quot;</span></span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  epoch = &quot;</span></span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680190315"><span class="hs-identifier hs-var">epochnum</span></a></span><span>
</span><span id="line-435"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  last slot =&quot;</span></span><span>
</span><span id="line-436"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190314"><span class="hs-identifier hs-var">lastSlot</span></a></span><span>
</span><span id="line-437"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  index of Tx in the trace = &quot;</span></span><span>
</span><span id="line-438"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190313"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680190308"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190308"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680190307"><span class="annot"><span class="annottext">Gen k
</span><a href="#local-6989586621680190307"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190308"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621680190310"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621680190310"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- All stakepools have zero Stake, choose issuer arbitrarily. possible, but rare.</span><span>
</span><span id="line-444"></span><span>          </span><span class="annot"><span class="annottext">forall a. [(Int, Gen a)] -&gt; Gen a
</span><span class="hs-identifier hs-var">frequency</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621680190310"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621680190310"><span class="annot"><span class="annottext">pairs :: [(Int, Gen k)]
</span><a href="#local-6989586621680190310"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190304"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680190303"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680190303"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680190303"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680190304"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190304"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map k Int
</span><a href="#local-6989586621680190312"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span id="local-6989586621680192692"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#chooseIssuer"><span class="hs-identifier hs-type">chooseIssuer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192692"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-449"></span><span id="chooseIssuer"><span class="annot"><span class="annottext">chooseIssuer :: forall c.
EpochNo
-&gt; Word64 -&gt; Int -&gt; PoolDistr c -&gt; Gen (KeyHash 'StakePool c)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chooseIssuer"><span class="hs-identifier hs-var hs-var">chooseIssuer</span></a></span></span><span> </span><span id="local-6989586621680190297"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680190297"><span class="hs-identifier hs-var">epochnum</span></a></span></span><span> </span><span id="local-6989586621680190296"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190296"><span class="hs-identifier hs-var">lastSlot</span></a></span></span><span> </span><span id="local-6989586621680190295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190295"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolDistr</span></a></span><span> </span><span id="local-6989586621680190294"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool c) (IndividualPoolStake c)
</span><a href="#local-6989586621680190294"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k. EpochNo -&gt; Word64 -&gt; Int -&gt; Map k Int -&gt; Gen k
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#mapProportion"><span class="hs-identifier hs-var">mapProportion</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680190297"><span class="hs-identifier hs-var">epochnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680190296"><span class="hs-identifier hs-var">lastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190295"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {b} {c}. Integral b =&gt; IndividualPoolStake c -&gt; b
</span><a href="#local-6989586621680190293"><span class="hs-identifier hs-var">getInt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool c) (IndividualPoolStake c)
</span><a href="#local-6989586621680190294"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-451"></span><span>    </span><span id="local-6989586621680190293"><span class="annot"><span class="annottext">getInt :: IndividualPoolStake c -&gt; b
</span><a href="#local-6989586621680190293"><span class="hs-identifier hs-var hs-var">getInt</span></a></span></span><span> </span><span id="local-6989586621680190284"><span class="annot"><span class="annottext">IndividualPoolStake c
</span><a href="#local-6989586621680190284"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">floor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. IndividualPoolStake c -&gt; Rational
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">individualPoolStake</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake c
</span><a href="#local-6989586621680190284"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Generating Traces, and making properties out of a Trace</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- =========================================================================</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-type">genTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192657"><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- An arbitrary 'initialization action', to run before we generate the sequence</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-comment">-- use (pure ()) if you don't want or need initialization</span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span id="genTrace"><span class="annot"><span class="annottext">genTrace :: forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var hs-var">genTrace</span></a></span></span><span> </span><span id="local-6989586621680190263"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190263"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190262"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190262"><span class="hs-identifier hs-var">numTxInTrace</span></a></span></span><span> </span><span id="local-6989586621680190261"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190261"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621680190260"><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621680190260"><span class="hs-identifier hs-var">initialize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680190259"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680190259"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680190258"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190258"><span class="hs-identifier hs-var">genstate</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190263"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190261"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190262"><span class="hs-identifier hs-var">numTxInTrace</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621680190260"><span class="hs-identifier hs-var">initialize</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680190257"><span class="annot"><span class="annottext">initState :: MockChainState era
</span><a href="#local-6989586621680190257"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var">initialMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190263"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190258"><span class="hs-identifier hs-var">genstate</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts -&gt; Gen (Either [PredicateFailure sts] (State sts)))
-&gt; Gen (Trace sts)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192657"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><span class="annottext">Globals
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">testGlobals</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680190259"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680190259"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680190258"><span class="hs-identifier hs-var">genstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IRC (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680190257"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#traceProp"><span class="hs-identifier hs-type">traceProp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192646"><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621680192645"><span class="annot"><a href="#local-6989586621680192645"><span class="hs-identifier hs-type">prop</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192646"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680192645"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621680192645"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-488"></span><span id="traceProp"><span class="annot"><span class="annottext">traceProp :: forall era prop.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int
-&gt; GenSize
-&gt; (MockChainState era -&gt; MockChainState era -&gt; prop)
-&gt; Gen prop
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#traceProp"><span class="hs-identifier hs-var hs-var">traceProp</span></a></span></span><span> </span><span id="local-6989586621680190247"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190247"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190246"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190246"><span class="hs-identifier hs-var">numTxInTrace</span></a></span></span><span> </span><span id="local-6989586621680190245"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190245"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621680190244"><span class="annot"><span class="annottext">MockChainState era -&gt; MockChainState era -&gt; prop
</span><a href="#local-6989586621680190244"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-489"></span><span>  </span><span id="local-6989586621680190243"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680190243"><span class="hs-identifier hs-var">trace1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190247"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190246"><span class="hs-identifier hs-var">numTxInTrace</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190245"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainState era -&gt; MockChainState era -&gt; prop
</span><a href="#local-6989586621680190244"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Trace s -&gt; State s
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">_traceInitState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680190243"><span class="hs-identifier hs-var">trace1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Trace s -&gt; State s
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680190243"><span class="hs-identifier hs-var">trace1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#forEachEpochTrace"><span class="hs-identifier hs-type">forEachEpochTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192638"><span class="annot"><a href="#local-6989586621680192638"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621680192640"><span class="annot"><a href="#local-6989586621680192640"><span class="hs-identifier hs-type">prop</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680192640"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192638"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192638"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-498"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-499"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192638"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680192640"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-502"></span><span id="forEachEpochTrace"><span class="annot"><span class="annottext">forEachEpochTrace :: forall era prop.
(Testable prop, Reflect era) =&gt;
Proof era
-&gt; Int
-&gt; GenSize
-&gt; (Trace (MOCKCHAIN era) -&gt; prop)
-&gt; Gen Property
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#forEachEpochTrace"><span class="hs-identifier hs-var hs-var">forEachEpochTrace</span></a></span></span><span> </span><span id="local-6989586621680190195"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680190194"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span></span><span> </span><span id="local-6989586621680190193"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span></span><span> </span><span id="local-6989586621680190192"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; prop
</span><a href="#local-6989586621680190192"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680190189"><span class="annot"><span class="annottext">newEpoch :: MockChainState era -&gt; MockChainState era -&gt; Bool
</span><a href="#local-6989586621680190189"><span class="hs-identifier hs-var hs-var">newEpoch</span></a></span></span><span> </span><span id="local-6989586621680190188"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680190188"><span class="hs-identifier hs-var">tr1</span></a></span></span><span> </span><span id="local-6989586621680190187"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680190187"><span class="hs-identifier hs-var">tr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. NewEpochState era -&gt; EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. MockChainState era -&gt; NewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#mcsNes"><span class="hs-identifier hs-var">mcsNes</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680190188"><span class="hs-identifier hs-var">tr1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. NewEpochState era -&gt; EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. MockChainState era -&gt; NewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#mcsNes"><span class="hs-identifier hs-var">mcsNes</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680190187"><span class="hs-identifier hs-var">tr2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>  </span><span id="local-6989586621680190184"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680190184"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680190195"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680190194"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680190193"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680188376"><span class="annot"><span class="annottext">propf :: (Trace (MOCKCHAIN era), Int) -&gt; Property
</span><a href="#local-6989586621680188376"><span class="hs-identifier hs-var hs-var">propf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680188375"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680188375"><span class="hs-identifier hs-var">subtrace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680188374"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188374"><span class="hs-identifier hs-var">index</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Subtrace of EpochNo &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188374"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; fails.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; prop
</span><a href="#local-6989586621680190192"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680188375"><span class="hs-identifier hs-var">subtrace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-comment">-- The very last sub-trace may not be a full epoch, so we throw it away.</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. (State s -&gt; State s -&gt; Bool) -&gt; Trace s -&gt; [Trace s]
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">splitTrace</span></a></span><span> </span><span class="annot"><span class="annottext">forall {era} {era}.
MockChainState era -&gt; MockChainState era -&gt; Bool
</span><a href="#local-6989586621680190189"><span class="hs-identifier hs-var">newEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680190184"><span class="hs-identifier hs-var">trc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680188371"><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)]
</span><a href="#local-6989586621680188371"><span class="hs-identifier hs-var">revSplits</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">conjoin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Trace (MOCKCHAIN era), Int) -&gt; Property
</span><a href="#local-6989586621680188376"><span class="hs-identifier hs-var">propf</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)]
</span><a href="#local-6989586621680188371"><span class="hs-identifier hs-var">revSplits</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">-- | Check a property on the 'sts' traces.</span><span>
</span><span id="line-518"></span><span class="hs-comment">--</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- Takes an optional generator for initial state of the STS.</span><span>
</span><span id="line-520"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#forAllTraceFromInitState"><span class="hs-identifier hs-type">forAllTraceFromInitState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192564"><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span></span><span> </span><span id="local-6989586621680192563"><span class="annot"><a href="#local-6989586621680192563"><span class="hs-identifier hs-type">traceGenEnv</span></a></span></span><span> </span><span id="local-6989586621680192562"><span class="annot"><a href="#local-6989586621680192562"><span class="hs-identifier hs-type">prop</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192563"><span class="hs-identifier hs-type">traceGenEnv</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Testable</span></span><span> </span><span class="annot"><a href="#local-6989586621680192562"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-comment">-- | Maximum trace length.</span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><a href="#local-6989586621680192563"><span class="hs-identifier hs-type">traceGenEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-comment">-- | Optional generator of STS initial state</span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">IRC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">STS.PredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680192562"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-534"></span><span id="forAllTraceFromInitState"><span class="annot"><span class="annottext">forAllTraceFromInitState :: forall sts traceGenEnv prop.
(HasTrace sts traceGenEnv, Testable prop,
 Show (Environment sts)) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts -&gt; Gen (Either [PredicateFailure sts] (State sts)))
-&gt; (Trace sts -&gt; prop)
-&gt; Property
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#forAllTraceFromInitState"><span class="hs-identifier hs-var hs-var">forAllTraceFromInitState</span></a></span></span><span> </span><span id="local-6989586621680188360"><span class="annot"><span class="annottext">BaseEnv sts
</span><a href="#local-6989586621680188360"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621680188359"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680188359"><span class="hs-identifier hs-var">maxTraceLength</span></a></span></span><span> </span><span id="local-6989586621680188358"><span class="annot"><span class="annottext">traceGenEnv
</span><a href="#local-6989586621680188358"><span class="hs-identifier hs-var">traceGenEnv</span></a></span></span><span> </span><span id="local-6989586621680188357"><span class="annot"><span class="annottext">Maybe (IRC sts -&gt; Gen (Either [PredicateFailure sts] (State sts)))
</span><a href="#local-6989586621680188357"><span class="hs-identifier hs-var">genSt0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="annottext">forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkBlind</span></span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts -&gt; Gen (Either [PredicateFailure sts] (State sts)))
-&gt; Gen (Trace sts)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680192564"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680192563"><span class="hs-identifier hs-type">traceGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv sts
</span><a href="#local-6989586621680188360"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680188359"><span class="hs-identifier hs-var">maxTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">traceGenEnv
</span><a href="#local-6989586621680188358"><span class="hs-identifier hs-var">traceGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (IRC sts -&gt; Gen (Either [PredicateFailure sts] (State sts)))
</span><a href="#local-6989586621680188357"><span class="hs-identifier hs-var">genSt0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- =========================================================================</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- Test for just making a trace</span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-type">chainTest</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192554"><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">StashedAVVMAddresses</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span>
</span><span id="line-552"></span><span id="chainTest"><span class="annot"><span class="annottext">chainTest :: forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var hs-var">chainTest</span></a></span></span><span> </span><span id="local-6989586621680188319"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188319"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680188318"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188318"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680188317"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680188317"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Testable a =&gt; String -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">testProperty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680188316"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Property
</span><a href="#local-6989586621680188315"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621680188316"><span class="annot"><span class="annottext">message :: String
</span><a href="#local-6989586621680188316"><span class="hs-identifier hs-var hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188319"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; era.&quot;</span></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621680188315"><span class="annot"><span class="annottext">action :: Gen Property
</span><a href="#local-6989586621680188315"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680188314"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680188314"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680188313"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680188313"><span class="hs-identifier hs-var">genstate</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188319"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680188317"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-557"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680188312"><span class="annot"><span class="annottext">initState :: MockChainState era
</span><a href="#local-6989586621680188312"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var">initialMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188319"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680188313"><span class="hs-identifier hs-var">genstate</span></a></span><span>
</span><span id="line-558"></span><span>      </span><span id="local-6989586621680188311"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680188311"><span class="hs-identifier hs-var">trace1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-559"></span><span>        </span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts -&gt; Gen (Either [PredicateFailure sts] (State sts)))
-&gt; Gen (Trace sts)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192554"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>          </span><span class="annot"><span class="annottext">Globals
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-test-1.1.0.0/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">testGlobals</span></a></span><span>
</span><span id="line-561"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680188314"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621680188314"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621680188313"><span class="hs-identifier hs-var">genstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IRC (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188312"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-comment">-- Here is where we can add some properties for traces:</span><span>
</span><span id="line-565"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Trace s -&gt; State s
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-var">_traceInitState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621680188311"><span class="hs-identifier hs-var">trace1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188312"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#testTraces"><span class="hs-identifier hs-type">testTraces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span>
</span><span id="line-568"></span><span id="testTraces"><span class="annot"><span class="annottext">testTraces :: Int -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#testTraces"><span class="hs-identifier hs-var hs-var">testTraces</span></a></span></span><span> </span><span id="local-6989586621680188308"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188308"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [TestTree] -&gt; TestTree
</span><span class="hs-identifier hs-var">testGroup</span></span><span>
</span><span id="line-570"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MockChainTrace&quot;</span></span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188308"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (AlonzoEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188308"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (MaryEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188308"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (AllegraEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188308"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var">multiEpochTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">225</span></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-576"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var">multiEpochTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (ShelleyEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">225</span></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="hs-comment">-- | Show that Ada is preserved across multiple Epochs</span><span>
</span><span id="line-580"></span><span id="local-6989586621680192545"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-type">multiEpochTest</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192545"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/small-steps-test-1.0.0.0/doc/html/small-steps-test/src"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192545"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192545"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192545"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-585"></span><span>  </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span><span>
</span><span id="line-588"></span><span id="multiEpochTest"><span class="annot"><span class="annottext">multiEpochTest :: forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var hs-var">multiEpochTest</span></a></span></span><span> </span><span id="local-6989586621680188290"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188290"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680188289"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188289"><span class="hs-identifier hs-var">numTx</span></a></span></span><span> </span><span id="local-6989586621680188288"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680188288"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680188287"><span class="annot"><span class="annottext">gensize :: GenSize
</span><a href="#local-6989586621680188287"><span class="hs-identifier hs-var hs-var">gensize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680188288"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">blocksizeMax :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slotDelta :: (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-590"></span><span>      </span><span id="local-6989586621680188284"><span class="annot"><span class="annottext">getEpoch :: MockChainState era -&gt; EpochNo
</span><a href="#local-6989586621680188284"><span class="hs-identifier hs-var hs-var">getEpoch</span></a></span></span><span> </span><span id="local-6989586621680188283"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188283"><span class="hs-identifier hs-var">mockchainstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. NewEpochState era -&gt; EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-shelley-1.2.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. MockChainState era -&gt; NewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#mcsNes"><span class="hs-identifier hs-var">mcsNes</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188283"><span class="hs-identifier hs-var">mockchainstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>      </span><span id="local-6989586621680188271"><span class="annot"><span class="annottext">propf :: t -&gt; MockChainState era -&gt; Property
</span><a href="#local-6989586621680188271"><span class="hs-identifier hs-var hs-var">propf</span></a></span></span><span> </span><span id="local-6989586621680188270"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680188270"><span class="hs-identifier hs-var">firstSt</span></a></span></span><span> </span><span id="local-6989586621680188269"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188269"><span class="hs-identifier hs-var">lastSt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><span class="annottext">forall a prop. (Show a, Testable prop) =&gt; a -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">collect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {era}. MockChainState era -&gt; EpochNo
</span><a href="#local-6989586621680188284"><span class="hs-identifier hs-var">getEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188269"><span class="hs-identifier hs-var">lastSt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. TotalAda t =&gt; t -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#totalAda"><span class="hs-identifier hs-var">totalAda</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680188270"><span class="hs-identifier hs-var">firstSt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">forall t. TotalAda t =&gt; t -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#totalAda"><span class="hs-identifier hs-var">totalAda</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621680188269"><span class="hs-identifier hs-var">lastSt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. Testable a =&gt; String -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">testProperty</span></span><span>
</span><span id="line-594"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multi epoch. Ada is preserved. &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188290"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; era. Trace length = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188289"><span class="hs-identifier hs-var">numTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era prop.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era
-&gt; Int
-&gt; GenSize
-&gt; (MockChainState era -&gt; MockChainState era -&gt; prop)
-&gt; Gen prop
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#traceProp"><span class="hs-identifier hs-var">traceProp</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188290"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680188289"><span class="hs-identifier hs-var">numTx</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621680188287"><span class="hs-identifier hs-var">gensize</span></a></span><span> </span><span class="annot"><span class="annottext">forall {t} {era}.
(TotalAda t, Reflect era) =&gt;
t -&gt; MockChainState era -&gt; Property
</span><a href="#local-6989586621680188271"><span class="hs-identifier hs-var">propf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">-- ===========================================================</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- Debugging tools for replaying failures. We store the trace in</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- the IORef TT, and then we can use 'main3' to display what we</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- need to see from the trace.</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#main"><span class="hs-identifier hs-type">main</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span id="main"><span class="annot"><span class="annottext">main :: IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#main"><span class="hs-identifier hs-var hs-var">main</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestTree -&gt; IO ()
</span><span class="hs-identifier hs-var">defaultMain</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var">multiEpochTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (ShelleyEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="hs-keyword">data</span><span> </span><span id="TT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-var">TT</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-606"></span><span>  </span><span id="local-6989586621680188266"><span id="TT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-var">TT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680188266"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-strict-containers-0.1.2.1-04677b72c234c90b452d7440414220f82e2719df93ca12456c6361cefd202576/share/doc/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680188266"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-type">TT</span></a></span></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#theVector"><span class="hs-identifier hs-type">theVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-type">TT</span></a></span><span>
</span><span id="line-609"></span><span id="theVector"><span class="annot"><span class="annottext">theVector :: IORef TT
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#theVector"><span class="hs-identifier hs-var hs-var">theVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. IO a -&gt; a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; IO (IORef a)
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">newIORef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Proof c -&gt; [(StrictSeq (Tx c), SlotNo)] -&gt; TT
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-var">TT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#showVector"><span class="hs-identifier hs-type">showVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680192534"><span class="annot"><a href="#local-6989586621680192534"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192534"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680192534"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span id="showVector"><span class="annot"><span class="annottext">showVector :: (forall era. Proof era -&gt; [Tx era] -&gt; SlotNo -&gt; PDoc) -&gt; IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#showVector"><span class="hs-identifier hs-var hs-var">showVector</span></a></span></span><span> </span><span id="local-6989586621680188264"><span class="annot"><span class="annottext">forall era. Proof era -&gt; [Tx era] -&gt; SlotNo -&gt; PDoc
</span><a href="#local-6989586621680188264"><span class="hs-identifier hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>  </span><span id="local-6989586621680188263"><span class="annot"><span class="annottext">TT
</span><a href="#local-6989586621680188263"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef TT
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#theVector"><span class="hs-identifier hs-var">theVector</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TT
</span><a href="#local-6989586621680188263"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-type">TT</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NONE&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#TT"><span class="hs-identifier hs-type">TT</span></a></span><span> </span><span id="local-6989586621680188254"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188254"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621680188253"><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680188253"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680188251"><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621680188251"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680188250"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680188250"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; [Tx era] -&gt; SlotNo -&gt; PDoc
</span><a href="#local-6989586621680188264"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188254"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Fold.toList</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621680188251"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680188250"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621680188253"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#main3"><span class="hs-identifier hs-type">main3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span id="main3"><span class="annot"><span class="annottext">main3 :: IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#main3"><span class="hs-identifier hs-var hs-var">main3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall era. Proof era -&gt; [Tx era] -&gt; SlotNo -&gt; PDoc) -&gt; IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#showVector"><span class="hs-identifier hs-var">showVector</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; [Tx era] -&gt; SlotNo -&gt; PDoc
</span><a href="#local-6989586621680188248"><span class="hs-identifier hs-var">pretty</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-621"></span><span>    </span><span id="local-6989586621680188247"><span class="annot"><a href="#local-6989586621680188248"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680188247"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-core-1.2.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680188247"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.7/cardano-slotting-0.1.1.0-addf22683afb278f48799b4f38e98579f046ab25ebd7c8e8820c81fbf33fc913/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PDoc</span></a></span></span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621680188248"><span class="annot"><span class="annottext">pretty :: forall era. Proof era -&gt; [Tx era] -&gt; SlotNo -&gt; PDoc
</span><a href="#local-6989586621680188248"><span class="hs-identifier hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680188239"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680188239"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680188238"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680188238"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-623"></span><span>      </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span>
</span><span id="line-624"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall ann. SlotNo -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680188238"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; [x] -&gt; Doc ann
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppList</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. DCert c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcDCert"><span class="hs-identifier hs-var">pcDCert</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Fold.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. BabbageTxBody era -&gt; StrictSeq (DCert (EraCrypto era))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-babbage-1.2.0.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-var">certs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. AlonzoTx era -&gt; TxBody era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-alonzo-1.2.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621680188239"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>    </span><span class="annot"><a href="#local-6989586621680188248"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span id="local-6989586621680188237"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188237"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;main3 does not work in era &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621680188237"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#main2"><span class="hs-identifier hs-type">main2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span id="main2"><span class="annot"><span class="annottext">main2 :: IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#main2"><span class="hs-identifier hs-var hs-var">main2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestTree -&gt; IO ()
</span><span class="hs-identifier hs-var">defaultMain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
(Reflect era, HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era)) =&gt;
Proof era -&gt; Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">-- | display information about stable fields if the only action is to 'initStableFields'</span><span>
</span><span id="line-633"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#displayStableInfo"><span class="hs-identifier hs-type">displayStableInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span id="displayStableInfo"><span class="annot"><span class="annottext">displayStableInfo :: IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#displayStableInfo"><span class="hs-identifier hs-var hs-var">displayStableInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-635"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680188233"><span class="annot"><span class="annottext">proof :: Proof (BabbageEra Mock)
</span><a href="#local-6989586621680188233"><span class="hs-identifier hs-var hs-var">proof</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680188232"><span class="annot"><span class="annottext">GenState (BabbageEra Mock)
</span><a href="#local-6989586621680188232"><span class="hs-identifier hs-var">gstate</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; IO a
</span><span class="hs-identifier hs-var">generate</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era a.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; GenRS era a -&gt; Gen (a, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-var">runGenRS</span></a></span><span> </span><span class="annot"><span class="annottext">Proof (BabbageEra Mock)
</span><a href="#local-6989586621680188233"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680188231"><span class="annot"><span class="annottext">mcst :: MockChainState (BabbageEra Mock)
</span><a href="#local-6989586621680188231"><span class="hs-identifier hs-var hs-var">mcst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var">initialMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof (BabbageEra Mock)
</span><a href="#local-6989586621680188233"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenState (BabbageEra Mock)
</span><a href="#local-6989586621680188232"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680188230"><span class="annot"><span class="annottext">del :: Map
  (KeyHash 'StakePool (EraCrypto (BabbageEra Mock)))
  (PoolParams (EraCrypto (BabbageEra Mock)))
</span><a href="#local-6989586621680188230"><span class="hs-identifier hs-var hs-var">del</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenState (BabbageEra Mock)
</span><a href="#local-6989586621680188232"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; MockChainState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#ppMockChainState"><span class="hs-identifier hs-var">ppMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState (BabbageEra Mock)
</span><a href="#local-6989586621680188231"><span class="hs-identifier hs-var">mcst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/7wd7lm23cjb3mrp5rh6ag573znf82xlz-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.7/cardano-ledger-pretty-1.1.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (discriminator :: KeyRole) c.
KeyHash discriminator c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier hs-var">pcKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. PoolParams era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcPoolParams"><span class="hs-identifier hs-var">pcPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto (BabbageEra Mock)))
  (PoolParams (EraCrypto (BabbageEra Mock)))
</span><a href="#local-6989586621680188230"><span class="hs-identifier hs-var">del</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span></pre></body></html>